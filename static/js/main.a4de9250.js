/*! For license information please see main.a4de9250.js.LICENSE.txt */
(()=>{var e={213:(e,t,i)=>{"use strict";const n=i(330);class r extends Error{constructor(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];let o;super(...i),Error.captureStackTrace&&Error.captureStackTrace(this,r),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e);Object.defineProperty(this,"responseBody",{get:()=>(o||(o=this.arrayBuffer()),o)}),this.headers={};for(const[r,s]of e.headers.entries())this.headers[r.toLowerCase()]=s}}e.exports=n(((e,t,i,n,o)=>async function(s,a){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s=o+(s||"");let l=new URL(s);if(n||(n={}),l.username&&(n.Authorization="Basic "+btoa(l.username+":"+l.password),l=new URL(l.protocol+"//"+l.host+l.pathname+l.search)),"https:"!==l.protocol&&"http:"!==l.protocol)throw new Error("Unknown protocol, ".concat(l.protocol));if(a)if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||"string"===typeof a);else{if("object"!==typeof a)throw new Error("Unknown body type.");a=JSON.stringify(a),n["Content-Type"]="application/json"}c=new Headers({...n||{},...c});const u=await fetch(l,{method:t,headers:c,body:a});if(u.statusCode=u.status,!e.has(u.status))throw new r(u);return"json"===i?u.json():"buffer"===i?u.arrayBuffer():"string"===i?u.text():u}))},330:e=>{"use strict";const t=new Set(["json","buffer","string"]);e.exports=e=>function(){const i=new Set;let n,r,o,s="";for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return c.forEach((e=>{if("string"===typeof e)if(e.toUpperCase()===e){if(n){const t="Can't set method to ".concat(e,", already set to ").concat(n,".");throw new Error(t)}n=e}else if(e.startsWith("http:")||e.startsWith("https:"))s=e;else{if(!t.has(e))throw new Error("Unknown encoding, ".concat(e));r=e}else if("number"===typeof e)i.add(e);else{if("object"!==typeof e)throw new Error("Unknown type: ".concat(typeof e));if(Array.isArray(e)||e instanceof Set)e.forEach((e=>i.add(e)));else{if(o)throw new Error("Cannot set headers twice.");o=e}}})),n||(n="GET"),0===i.size&&i.add(200),e(i,n,r,o,s)}},463:(e,t,i)=>{"use strict";var n=i(791),r=i(296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),p=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},v={};function f(e,t,i,n,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function S(e,t,i,n){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!p.call(v,e)||!p.call(h,e)&&(d.test(e)?v[e]=!0:(h[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var C=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),R=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var z=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var M,L=Object.assign;function B(e){if(void 0===M)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var q=!1;function U(e,t){if(!e||q)return"";q=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),o=n.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var c="\n"+r[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{q=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?B(e):""}function F(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case b:return"Fragment";case R:return"Portal";case I:return"Profiler";case P:return"StrictMode";case A:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return W(e(t))}catch(i){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function j(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=V(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var i=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function $(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=j(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&S(e,"checked",t,!1)}function X(e,t){Y(e,t);var i=j(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,j(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&G(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+j(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(o(92));if(te(i)){if(1<i.length)throw Error(o(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:j(i)}}function oe(e,t){var i=j(t.value),n=j(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,pe=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ve=["Webkit","ms","Moz","O"];function fe(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ge(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=fe(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(he).forEach((function(e){ve.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var me=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function Se(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ce=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Re=null,be=null,Pe=null;function Ie(e){if(e=Sr(e)){if("function"!==typeof Re)throw Error(o(280));var t=e.stateNode;t&&(t=wr(t),Re(e.stateNode,e.type,t))}}function Ee(e){be?Pe?Pe.push(e):Pe=[e]:be=e}function Te(){if(be){var e=be,t=Pe;if(Pe=be=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function ke(e,t){return e(t)}function Ae(){}var Oe=!1;function xe(e,t,i){if(Oe)return e(t,i);Oe=!0;try{return ke(e,t,i)}finally{Oe=!1,(null!==be||null!==Pe)&&(Ae(),Te())}}function De(e,t){var i=e.stateNode;if(null===i)return null;var n=wr(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(o(231,t,typeof i));return i}var ze=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){ze=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){ze=!1}function _e(e,t,i,n,r,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(i,l)}catch(u){this.onError(u)}}var Me=!1,Le=null,Be=!1,qe=null,Ue={onError:function(e){Me=!0,Le=e}};function Fe(e,t,i,n,r,o,s,a,c){Me=!1,Le=null,_e.apply(Ue,arguments)}function We(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function je(e){if(We(e)!==e)throw Error(o(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(o(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return je(r),e;if(s===n)return je(r),t;s=s.sibling}throw Error(o(188))}if(i.return!==n.return)i=r,n=s;else{for(var a=!1,c=r.child;c;){if(c===i){a=!0,i=r,n=s;break}if(c===n){a=!0,n=r,i=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===i){a=!0,i=s,n=r;break}if(c===n){a=!0,n=s,i=r;break}c=c.sibling}if(!a)throw Error(o(189))}}if(i.alternate!==n)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Je=r.unstable_scheduleCallback,Ge=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,$e=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,it=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function pt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,o=e.pingedLanes,s=268435455&i;if(0!==s){var a=s&~r;0!==a?n=pt(a):0!==(o&=s)&&(n=pt(o))}else 0!==(s=i&~r)?n=pt(s):0!==o&&(n=pt(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(o=t&-t)||16===r&&0!==(4194240&o)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-st(t)),n|=e[i],t&=~r;return n}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function vt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function mt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=i}function yt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-st(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var St=0;function Ct(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Rt,bt,Pt,It,Et=!1,Tt=[],kt=null,At=null,Ot=null,xt=new Map,Dt=new Map,zt=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _t(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,i,n,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=Sr(t))&&Rt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=yr(e.target);if(null!==t){var i=We(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=He(i)))return e.blockedOn=t,void It(e.priority,(function(){bt(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=Sr(i))&&Rt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);Ce=n,i.target.dispatchEvent(n),Ce=null,t.shift()}return!0}function qt(e,t,i){Bt(e)&&i.delete(t)}function Ut(){Et=!1,null!==kt&&Bt(kt)&&(kt=null),null!==At&&Bt(At)&&(At=null),null!==Ot&&Bt(Ot)&&(Ot=null),xt.forEach(qt),Dt.forEach(qt)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Wt(e){function t(t){return Ft(t,e)}if(0<Tt.length){Ft(Tt[0],e);for(var i=1;i<Tt.length;i++){var n=Tt[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==kt&&Ft(kt,e),null!==At&&Ft(At,e),null!==Ot&&Ft(Ot,e),xt.forEach(t),Dt.forEach(t),i=0;i<zt.length;i++)(n=zt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<zt.length&&null===(i=zt[0]).blockedOn;)Lt(i),null===i.blockedOn&&zt.shift()}var Ht=C.ReactCurrentBatchConfig,jt=!0;function Vt(e,t,i,n){var r=St,o=Ht.transition;Ht.transition=null;try{St=1,Jt(e,t,i,n)}finally{St=r,Ht.transition=o}}function Kt(e,t,i,n){var r=St,o=Ht.transition;Ht.transition=null;try{St=4,Jt(e,t,i,n)}finally{St=r,Ht.transition=o}}function Jt(e,t,i,n){if(jt){var r=Qt(e,t,i,n);if(null===r)jn(e,t,n,Gt,i),_t(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return kt=Mt(kt,e,t,i,n,r),!0;case"dragenter":return At=Mt(At,e,t,i,n,r),!0;case"mouseover":return Ot=Mt(Ot,e,t,i,n,r),!0;case"pointerover":var o=r.pointerId;return xt.set(o,Mt(xt.get(o)||null,e,t,i,n,r)),!0;case"gotpointercapture":return o=r.pointerId,Dt.set(o,Mt(Dt.get(o)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(_t(e,n),4&t&&-1<Nt.indexOf(e)){for(;null!==r;){var o=Sr(r);if(null!==o&&wt(o),null===(o=Qt(e,t,i,n))&&jn(e,t,n,Gt,i),o===r)break;r=o}null!==r&&n.stopPropagation()}else jn(e,t,n,null,i)}}var Gt=null;function Qt(e,t,i,n){if(Gt=null,null!==(e=yr(e=we(n))))if(null===(t=We(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function ei(){if(Zt)return Zt;var e,t,i=Xt,n=i.length,r="value"in Yt?Yt.value:Yt.textContent,o=r.length;for(e=0;e<n&&i[e]===r[e];e++);var s=n-e;for(t=1;t<=s&&i[n-t]===r[o-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ri(e){function t(t,i,n,r,o){for(var s in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var oi,si,ai,ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},li=ri(ci),ui=L({},ci,{view:0,detail:0}),pi=ri(ui),di=L({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ai&&(ai&&"mousemove"===e.type?(oi=e.screenX-ai.screenX,si=e.screenY-ai.screenY):si=oi=0,ai=e),oi)},movementY:function(e){return"movementY"in e?e.movementY:si}}),hi=ri(di),vi=ri(L({},di,{dataTransfer:0})),fi=ri(L({},ui,{relatedTarget:0})),gi=ri(L({},ci,{animationName:0,elapsedTime:0,pseudoElement:0})),mi=L({},ci,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yi=ri(mi),Si=ri(L({},ci,{data:0})),Ci={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ri={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ri[e])&&!!t[e]}function Pi(){return bi}var Ii=L({},ui,{key:function(e){if(e.key){var t=Ci[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pi,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ei=ri(Ii),Ti=ri(L({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ki=ri(L({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pi})),Ai=ri(L({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0})),Oi=L({},di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xi=ri(Oi),Di=[9,13,27,32],zi=u&&"CompositionEvent"in window,Ni=null;u&&"documentMode"in document&&(Ni=document.documentMode);var _i=u&&"TextEvent"in window&&!Ni,Mi=u&&(!zi||Ni&&8<Ni&&11>=Ni),Li=String.fromCharCode(32),Bi=!1;function qi(e,t){switch(e){case"keyup":return-1!==Di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ui(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fi=!1;var Wi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wi[e.type]:"textarea"===t}function ji(e,t,i,n){Ee(n),0<(t=Kn(t,"onChange")).length&&(i=new li("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Vi=null,Ki=null;function Ji(e){Bn(e,0)}function Gi(e){if(J(Cr(e)))return e}function Qi(e,t){if("change"===e)return t}var $i=!1;if(u){var Yi;if(u){var Xi="oninput"in document;if(!Xi){var Zi=document.createElement("div");Zi.setAttribute("oninput","return;"),Xi="function"===typeof Zi.oninput}Yi=Xi}else Yi=!1;$i=Yi&&(!document.documentMode||9<document.documentMode)}function en(){Vi&&(Vi.detachEvent("onpropertychange",tn),Ki=Vi=null)}function tn(e){if("value"===e.propertyName&&Gi(Ki)){var t=[];ji(t,Ki,e,we(e)),xe(Ji,t)}}function nn(e,t,i){"focusin"===e?(en(),Ki=i,(Vi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gi(Ki)}function on(e,t){if("click"===e)return Gi(t)}function sn(e,t){if("input"===e||"change"===e)return Gi(t)}var an="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(an(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!p.call(t,r)||!an(e[r],t[r]))return!1}return!0}function ln(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var i,n=ln(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ln(n)}}function pn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=G((e=t.contentWindow).document)}return t}function hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function vn(e){var t=dn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&pn(i.ownerDocument.documentElement,i)){if(null!==n&&hn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,o=Math.min(n.start,r);n=void 0===n.end?o:Math.min(n.end,r),!e.extend&&o>n&&(r=n,n=o,o=r),r=un(i,o);var s=un(i,n);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,mn=null,yn=null,Sn=!1;function Cn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;Sn||null==gn||gn!==G(n)||("selectionStart"in(n=gn)&&hn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&cn(yn,n)||(yn=n,0<(n=Kn(mn,"onSelect")).length&&(t=new li("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Rn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},bn={},Pn={};function In(e){if(bn[e])return bn[e];if(!Rn[e])return e;var t,i=Rn[e];for(t in i)if(i.hasOwnProperty(t)&&t in Pn)return bn[e]=i[t];return e}u&&(Pn=document.createElement("div").style,"AnimationEvent"in window||(delete Rn.animationend.animation,delete Rn.animationiteration.animation,delete Rn.animationstart.animation),"TransitionEvent"in window||delete Rn.transitionend.transition);var En=In("animationend"),Tn=In("animationiteration"),kn=In("animationstart"),An=In("transitionend"),On=new Map,xn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dn(e,t){On.set(e,t),c(t,[e])}for(var zn=0;zn<xn.length;zn++){var Nn=xn[zn];Dn(Nn.toLowerCase(),"on"+(Nn[0].toUpperCase()+Nn.slice(1)))}Dn(En,"onAnimationEnd"),Dn(Tn,"onAnimationIteration"),Dn(kn,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(An,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _n="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mn=new Set("cancel close invalid load scroll toggle".split(" ").concat(_n));function Ln(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,s,a,c,l){if(Fe.apply(this,arguments),Me){if(!Me)throw Error(o(198));var u=Le;Me=!1,Le=null,Be||(Be=!0,qe=u)}}(n,t,void 0,e),e.currentTarget=null}function Bn(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&r.isPropagationStopped())break e;Ln(r,a,l),o=c}else for(s=0;s<n.length;s++){if(c=(a=n[s]).instance,l=a.currentTarget,a=a.listener,c!==o&&r.isPropagationStopped())break e;Ln(r,a,l),o=c}}}if(Be)throw e=qe,Be=!1,qe=null,e}function qn(e,t){var i=t[fr];void 0===i&&(i=t[fr]=new Set);var n=e+"__bubble";i.has(n)||(Hn(t,e,2,!1),i.add(n))}function Un(e,t,i){var n=0;t&&(n|=4),Hn(i,e,n,t)}var Fn="_reactListening"+Math.random().toString(36).slice(2);function Wn(e){if(!e[Fn]){e[Fn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Mn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fn]||(t[Fn]=!0,Un("selectionchange",!1,t))}}function Hn(e,t,i,n){switch($t(t)){case 1:var r=Vt;break;case 4:r=Kt;break;default:r=Jt}i=r.bind(null,t,i,e),r=void 0,!ze||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function jn(e,t,i,n,r){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var a=n.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=n.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===r||8===c.nodeType&&c.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=yr(a)))return;if(5===(c=s.tag)||6===c){n=o=s;continue e}a=a.parentNode}}n=n.return}xe((function(){var n=o,r=we(i),s=[];e:{var a=On.get(e);if(void 0!==a){var c=li,l=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":c=Ei;break;case"focusin":l="focus",c=fi;break;case"focusout":l="blur",c=fi;break;case"beforeblur":case"afterblur":c=fi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=hi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=vi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=ki;break;case En:case Tn:case kn:c=gi;break;case An:c=Ai;break;case"scroll":c=pi;break;case"wheel":c=xi;break;case"copy":case"cut":case"paste":c=yi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Ti}var u=0!==(4&t),p=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var h,v=n;null!==v;){var f=(h=v).stateNode;if(5===h.tag&&null!==f&&(h=f,null!==d&&(null!=(f=De(v,d))&&u.push(Vn(v,f,h)))),p)break;v=v.return}0<u.length&&(a=new c(a,l,null,i,r),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||i===Ce||!(l=i.relatedTarget||i.fromElement)||!yr(l)&&!l[vr])&&(c||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=n,null!==(l=(l=i.relatedTarget||i.toElement)?yr(l):null)&&(l!==(p=We(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=n),c!==l)){if(u=hi,f="onMouseLeave",d="onMouseEnter",v="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ti,f="onPointerLeave",d="onPointerEnter",v="pointer"),p=null==c?a:Cr(c),h=null==l?a:Cr(l),(a=new u(f,v+"leave",c,i,r)).target=p,a.relatedTarget=h,f=null,yr(r)===n&&((u=new u(d,v+"enter",l,i,r)).target=h,u.relatedTarget=p,f=u),p=f,c&&l)e:{for(d=l,v=0,h=u=c;h;h=Jn(h))v++;for(h=0,f=d;f;f=Jn(f))h++;for(;0<v-h;)u=Jn(u),v--;for(;0<h-v;)d=Jn(d),h--;for(;v--;){if(u===d||null!==d&&u===d.alternate)break e;u=Jn(u),d=Jn(d)}u=null}else u=null;null!==c&&Gn(s,a,c,u,!1),null!==l&&null!==p&&Gn(s,p,l,u,!0)}if("select"===(c=(a=n?Cr(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var g=Qi;else if(Hi(a))if($i)g=sn;else{g=rn;var m=nn}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=on);switch(g&&(g=g(e,n))?ji(s,g,i,r):(m&&m(e,a,n),"focusout"===e&&(m=a._wrapperState)&&m.controlled&&"number"===a.type&&ee(a,"number",a.value)),m=n?Cr(n):window,e){case"focusin":(Hi(m)||"true"===m.contentEditable)&&(gn=m,mn=n,yn=null);break;case"focusout":yn=mn=gn=null;break;case"mousedown":Sn=!0;break;case"contextmenu":case"mouseup":case"dragend":Sn=!1,Cn(s,i,r);break;case"selectionchange":if(fn)break;case"keydown":case"keyup":Cn(s,i,r)}var y;if(zi)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Fi?qi(e,i)&&(S="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(S="onCompositionStart");S&&(Mi&&"ko"!==i.locale&&(Fi||"onCompositionStart"!==S?"onCompositionEnd"===S&&Fi&&(y=ei()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,Fi=!0)),0<(m=Kn(n,S)).length&&(S=new Si(S,e,null,i,r),s.push({event:S,listeners:m}),y?S.data=y:null!==(y=Ui(i))&&(S.data=y))),(y=_i?function(e,t){switch(e){case"compositionend":return Ui(t);case"keypress":return 32!==t.which?null:(Bi=!0,Li);case"textInput":return(e=t.data)===Li&&Bi?null:e;default:return null}}(e,i):function(e,t){if(Fi)return"compositionend"===e||!zi&&qi(e,t)?(e=ei(),Zt=Xt=Yt=null,Fi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Kn(n,"onBeforeInput")).length&&(r=new Si("onBeforeInput","beforeinput",null,i,r),s.push({event:r,listeners:n}),r.data=y))}Bn(s,t)}))}function Vn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Kn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=De(e,i))&&n.unshift(Vn(e,o,r)),null!=(o=De(e,t))&&n.push(Vn(e,o,r))),e=e.return}return n}function Jn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gn(e,t,i,n,r){for(var o=t._reactName,s=[];null!==i&&i!==n;){var a=i,c=a.alternate,l=a.stateNode;if(null!==c&&c===n)break;5===a.tag&&null!==l&&(a=l,r?null!=(c=De(i,o))&&s.unshift(Vn(i,c,a)):r||null!=(c=De(i,o))&&s.push(Vn(i,c,a))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var Qn=/\r\n?/g,$n=/\u0000|\uFFFD/g;function Yn(e){return("string"===typeof e?e:""+e).replace(Qn,"\n").replace($n,"")}function Xn(e,t,i){if(t=Yn(t),Yn(e)!==t&&i)throw Error(o(425))}function Zn(){}var er=null,tr=null;function ir(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(e){return or.resolve(null).then(e).catch(ar)}:nr;function ar(e){setTimeout((function(){throw e}))}function cr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Wt(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Wt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var pr=Math.random().toString(36).slice(2),dr="__reactFiber$"+pr,hr="__reactProps$"+pr,vr="__reactContainer$"+pr,fr="__reactEvents$"+pr,gr="__reactListeners$"+pr,mr="__reactHandles$"+pr;function yr(e){var t=e[dr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[vr]||i[dr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=ur(e);null!==e;){if(i=e[dr])return i;e=ur(e)}return t}i=(e=i).parentNode}return null}function Sr(e){return!(e=e[dr]||e[vr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Cr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wr(e){return e[hr]||null}var Rr=[],br=-1;function Pr(e){return{current:e}}function Ir(e){0>br||(e.current=Rr[br],Rr[br]=null,br--)}function Er(e,t){br++,Rr[br]=e.current,e.current=t}var Tr={},kr=Pr(Tr),Ar=Pr(!1),Or=Tr;function xr(e,t){var i=e.type.contextTypes;if(!i)return Tr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in i)o[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function zr(){Ir(Ar),Ir(kr)}function Nr(e,t,i){if(kr.current!==Tr)throw Error(o(168));Er(kr,t),Er(Ar,i)}function _r(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(o(108,H(e)||"Unknown",r));return L({},i,n)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tr,Or=kr.current,Er(kr,e),Er(Ar,Ar.current),!0}function Lr(e,t,i){var n=e.stateNode;if(!n)throw Error(o(169));i?(e=_r(e,t,Or),n.__reactInternalMemoizedMergedChildContext=e,Ir(Ar),Ir(kr),Er(kr,e)):Ir(Ar),Er(Ar,i)}var Br=null,qr=!1,Ur=!1;function Fr(e){null===Br?Br=[e]:Br.push(e)}function Wr(){if(!Ur&&null!==Br){Ur=!0;var e=0,t=St;try{var i=Br;for(St=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Br=null,qr=!1}catch(r){throw null!==Br&&(Br=Br.slice(e+1)),Je(Ze,Wr),r}finally{St=t,Ur=!1}}return null}var Hr=[],jr=0,Vr=null,Kr=0,Jr=[],Gr=0,Qr=null,$r=1,Yr="";function Xr(e,t){Hr[jr++]=Kr,Hr[jr++]=Vr,Vr=e,Kr=t}function Zr(e,t,i){Jr[Gr++]=$r,Jr[Gr++]=Yr,Jr[Gr++]=Qr,Qr=e;var n=$r;e=Yr;var r=32-st(n)-1;n&=~(1<<r),i+=1;var o=32-st(t)+r;if(30<o){var s=r-r%5;o=(n&(1<<s)-1).toString(32),n>>=s,r-=s,$r=1<<32-st(t)+r|i<<r|n,Yr=o+e}else $r=1<<o|i<<r|n,Yr=e}function eo(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function to(e){for(;e===Vr;)Vr=Hr[--jr],Hr[jr]=null,Kr=Hr[--jr],Hr[jr]=null;for(;e===Qr;)Qr=Jr[--Gr],Jr[Gr]=null,Yr=Jr[--Gr],Jr[Gr]=null,$r=Jr[--Gr],Jr[Gr]=null}var io=null,no=null,ro=!1,oo=null;function so(e,t){var i=Dl(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function ao(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,io=e,no=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,io=e,no=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Qr?{id:$r,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Dl(18,null,null,0)).stateNode=t,i.return=e,e.child=i,io=e,no=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(ro){var t=no;if(t){var i=t;if(!ao(e,t)){if(co(e))throw Error(o(418));t=lr(i.nextSibling);var n=io;t&&ao(e,t)?so(n,i):(e.flags=-4097&e.flags|2,ro=!1,io=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,ro=!1,io=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;io=e}function po(e){if(e!==io)return!1;if(!ro)return uo(e),ro=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ir(e.type,e.memoizedProps)),t&&(t=no)){if(co(e))throw ho(),Error(o(418));for(;t;)so(e,t),t=lr(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){no=lr(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}no=null}}else no=io?lr(e.stateNode.nextSibling):null;return!0}function ho(){for(var e=no;e;)e=lr(e.nextSibling)}function vo(){no=io=null,ro=!1}function fo(e){null===oo?oo=[e]:oo.push(e)}var go=C.ReactCurrentBatchConfig;function mo(e,t){if(e&&e.defaultProps){for(var i in t=L({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var yo=Pr(null),So=null,Co=null,wo=null;function Ro(){wo=Co=So=null}function bo(e){var t=yo.current;Ir(yo),e._currentValue=t}function Po(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Io(e,t){So=e,wo=Co=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ca=!0),e.firstContext=null)}function Eo(e){var t=e._currentValue;if(wo!==e)if(e={context:e,memoizedValue:t,next:null},null===Co){if(null===So)throw Error(o(308));Co=e,So.dependencies={lanes:0,firstContext:e}}else Co=Co.next=e;return t}var To=null;function ko(e){null===To?To=[e]:To.push(e)}function Ao(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,ko(t)):(i.next=r.next,r.next=i),t.interleaved=i,Oo(e,n)}function Oo(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var xo=!1;function Do(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function No(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _o(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Ac)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Oo(e,i)}return null===(r=n.interleaved)?(t.next=t,ko(n)):(t.next=r.next,r.next=t),n.interleaved=t,Oo(e,i)}function Mo(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,yt(e,i)}}function Lo(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===o?r=o=s:o=o.next=s,i=i.next}while(null!==i);null===o?r=o=t:o=o.next=t}else r=o=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Bo(e,t,i,n){var r=e.updateQueue;xo=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==o){var p=r.baseState;for(s=0,u=l=c=null,a=o;;){var d=a.lane,h=a.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=e,f=a;switch(d=t,h=i,f.tag){case 1:if("function"===typeof(v=f.payload)){p=v.call(h,p,d);break e}p=v;break e;case 3:v.flags=-65537&v.flags|128;case 0:if(null===(d="function"===typeof(v=f.payload)?v.call(h,p,d):v)||void 0===d)break e;p=L({},p,d);break e;case 2:xo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=h,c=p):u=u.next=h,s|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(c=p),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);Lc|=s,e.lanes=s,e.memoizedState=p}}function qo(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(o(191,r));r.call(n)}}}var Uo=(new n.Component).refs;function Fo(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:L({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var Wo={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=tl(),r=il(e),o=No(n,r);o.payload=t,void 0!==i&&null!==i&&(o.callback=i),null!==(t=_o(e,o,r))&&(nl(t,e,r,n),Mo(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=tl(),r=il(e),o=No(n,r);o.tag=1,o.payload=t,void 0!==i&&null!==i&&(o.callback=i),null!==(t=_o(e,o,r))&&(nl(t,e,r,n),Mo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=tl(),n=il(e),r=No(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=_o(e,r,n))&&(nl(t,e,n,i),Mo(t,e,n))}};function Ho(e,t,i,n,r,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!cn(i,n)||!cn(r,o))}function jo(e,t,i){var n=!1,r=Tr,o=t.contextType;return"object"===typeof o&&null!==o?o=Eo(o):(r=Dr(t)?Or:kr.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?xr(e,r):Tr),t=new t(i,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Wo,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function Vo(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Wo.enqueueReplaceState(t,t.state,null)}function Ko(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=Uo,Do(e);var o=t.contextType;"object"===typeof o&&null!==o?r.context=Eo(o):(o=Dr(t)?Or:kr.current,r.context=xr(e,o)),r.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Fo(e,t,o,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Wo.enqueueReplaceState(r,r.state,null),Bo(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Jo(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(o(309));var n=i.stateNode}if(!n)throw Error(o(147,e));var r=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===Uo&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!i._owner)throw Error(o(290,e))}return e}function Go(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qo(e){return(0,e._init)(e._payload)}function $o(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Nl(e,t)).index=0,e.sibling=null,e}function s(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,i,n){return null===t||6!==t.tag?((t=Bl(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function l(e,t,i,n){var o=i.type;return o===b?p(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===D&&Qo(o)===t.type)?((n=r(t,i.props)).ref=Jo(e,t,i),n.return=e,n):((n=_l(i.type,i.key,i.props,null,e.mode,n)).ref=Jo(e,t,i),n.return=e,n)}function u(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=ql(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function p(e,t,i,n,o){return null===t||7!==t.tag?((t=Ml(i,e.mode,n,o)).return=e,t):((t=r(t,i)).return=e,t)}function d(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bl(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(i=_l(t.type,t.key,t.props,null,e.mode,i)).ref=Jo(e,null,t),i.return=e,i;case R:return(t=ql(t,e.mode,i)).return=e,t;case D:return d(e,(0,t._init)(t._payload),i)}if(te(t)||_(t))return(t=Ml(t,e.mode,i,null)).return=e,t;Go(e,t)}return null}function h(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:c(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return i.key===r?l(e,t,i,n):null;case R:return i.key===r?u(e,t,i,n):null;case D:return h(e,t,(r=i._init)(i._payload),n)}if(te(i)||_(i))return null!==r?null:p(e,t,i,n,null);Go(e,i)}return null}function v(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return l(t,e=e.get(null===n.key?i:n.key)||null,n,r);case R:return u(t,e=e.get(null===n.key?i:n.key)||null,n,r);case D:return v(e,t,i,(0,n._init)(n._payload),r)}if(te(n)||_(n))return p(t,e=e.get(i)||null,n,r,null);Go(t,n)}return null}function f(r,o,a,c){for(var l=null,u=null,p=o,f=o=0,g=null;null!==p&&f<a.length;f++){p.index>f?(g=p,p=null):g=p.sibling;var m=h(r,p,a[f],c);if(null===m){null===p&&(p=g);break}e&&p&&null===m.alternate&&t(r,p),o=s(m,o,f),null===u?l=m:u.sibling=m,u=m,p=g}if(f===a.length)return i(r,p),ro&&Xr(r,f),l;if(null===p){for(;f<a.length;f++)null!==(p=d(r,a[f],c))&&(o=s(p,o,f),null===u?l=p:u.sibling=p,u=p);return ro&&Xr(r,f),l}for(p=n(r,p);f<a.length;f++)null!==(g=v(p,r,f,a[f],c))&&(e&&null!==g.alternate&&p.delete(null===g.key?f:g.key),o=s(g,o,f),null===u?l=g:u.sibling=g,u=g);return e&&p.forEach((function(e){return t(r,e)})),ro&&Xr(r,f),l}function g(r,a,c,l){var u=_(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var p=u=null,f=a,g=a=0,m=null,y=c.next();null!==f&&!y.done;g++,y=c.next()){f.index>g?(m=f,f=null):m=f.sibling;var S=h(r,f,y.value,l);if(null===S){null===f&&(f=m);break}e&&f&&null===S.alternate&&t(r,f),a=s(S,a,g),null===p?u=S:p.sibling=S,p=S,f=m}if(y.done)return i(r,f),ro&&Xr(r,g),u;if(null===f){for(;!y.done;g++,y=c.next())null!==(y=d(r,y.value,l))&&(a=s(y,a,g),null===p?u=y:p.sibling=y,p=y);return ro&&Xr(r,g),u}for(f=n(r,f);!y.done;g++,y=c.next())null!==(y=v(f,r,g,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),a=s(y,a,g),null===p?u=y:p.sibling=y,p=y);return e&&f.forEach((function(e){return t(r,e)})),ro&&Xr(r,g),u}return function e(n,o,s,c){if("object"===typeof s&&null!==s&&s.type===b&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var l=s.key,u=o;null!==u;){if(u.key===l){if((l=s.type)===b){if(7===u.tag){i(n,u.sibling),(o=r(u,s.props.children)).return=n,n=o;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===D&&Qo(l)===u.type){i(n,u.sibling),(o=r(u,s.props)).ref=Jo(n,u,s),o.return=n,n=o;break e}i(n,u);break}t(n,u),u=u.sibling}s.type===b?((o=Ml(s.props.children,n.mode,c,s.key)).return=n,n=o):((c=_l(s.type,s.key,s.props,null,n.mode,c)).ref=Jo(n,o,s),c.return=n,n=c)}return a(n);case R:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){i(n,o.sibling),(o=r(o,s.children||[])).return=n,n=o;break e}i(n,o);break}t(n,o),o=o.sibling}(o=ql(s,n.mode,c)).return=n,n=o}return a(n);case D:return e(n,o,(u=s._init)(s._payload),c)}if(te(s))return f(n,o,s,c);if(_(s))return g(n,o,s,c);Go(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(i(n,o.sibling),(o=r(o,s)).return=n,n=o):(i(n,o),(o=Bl(s,n.mode,c)).return=n,n=o),a(n)):i(n,o)}}var Yo=$o(!0),Xo=$o(!1),Zo={},es=Pr(Zo),ts=Pr(Zo),is=Pr(Zo);function ns(e){if(e===Zo)throw Error(o(174));return e}function rs(e,t){switch(Er(is,t),Er(ts,e),Er(es,Zo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ir(es),Er(es,t)}function os(){Ir(es),Ir(ts),Ir(is)}function ss(e){ns(is.current);var t=ns(es.current),i=ce(t,e.type);t!==i&&(Er(ts,e),Er(es,i))}function as(e){ts.current===e&&(Ir(es),Ir(ts))}var cs=Pr(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function ps(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var ds=C.ReactCurrentDispatcher,hs=C.ReactCurrentBatchConfig,vs=0,fs=null,gs=null,ms=null,ys=!1,Ss=!1,Cs=0,ws=0;function Rs(){throw Error(o(321))}function bs(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!an(e[i],t[i]))return!1;return!0}function Ps(e,t,i,n,r,s){if(vs=s,fs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ds.current=null===e||null===e.memoizedState?aa:ca,e=i(n,r),Ss){s=0;do{if(Ss=!1,Cs=0,25<=s)throw Error(o(301));s+=1,ms=gs=null,t.updateQueue=null,ds.current=la,e=i(n,r)}while(Ss)}if(ds.current=sa,t=null!==gs&&null!==gs.next,vs=0,ms=gs=fs=null,ys=!1,t)throw Error(o(300));return e}function Is(){var e=0!==Cs;return Cs=0,e}function Es(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ms?fs.memoizedState=ms=e:ms=ms.next=e,ms}function Ts(){if(null===gs){var e=fs.alternate;e=null!==e?e.memoizedState:null}else e=gs.next;var t=null===ms?fs.memoizedState:ms.next;if(null!==t)ms=t,gs=e;else{if(null===e)throw Error(o(310));e={memoizedState:(gs=e).memoizedState,baseState:gs.baseState,baseQueue:gs.baseQueue,queue:gs.queue,next:null},null===ms?fs.memoizedState=ms=e:ms=ms.next=e}return ms}function ks(e,t){return"function"===typeof t?t(e):t}function As(e){var t=Ts(),i=t.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=e;var n=gs,r=n.baseQueue,s=i.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}n.baseQueue=r=s,i.pending=null}if(null!==r){s=r.next,n=n.baseState;var c=a=null,l=null,u=s;do{var p=u.lane;if((vs&p)===p)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:p,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,a=n):l=l.next=d,fs.lanes|=p,Lc|=p}u=u.next}while(null!==u&&u!==s);null===l?a=n:l.next=c,an(n,t.memoizedState)||(Ca=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{s=r.lane,fs.lanes|=s,Lc|=s,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Os(e){var t=Ts(),i=t.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(null!==r){i.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);an(s,t.memoizedState)||(Ca=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function xs(){}function Ds(e,t){var i=fs,n=Ts(),r=t(),s=!an(n.memoizedState,r);if(s&&(n.memoizedState=r,Ca=!0),n=n.queue,js(_s.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||null!==ms&&1&ms.memoizedState.tag){if(i.flags|=2048,qs(9,Ns.bind(null,i,n,r,t),void 0,null),null===Oc)throw Error(o(349));0!==(30&vs)||zs(i,t,r)}return r}function zs(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=fs.updateQueue)?(t={lastEffect:null,stores:null},fs.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Ns(e,t,i,n){t.value=i,t.getSnapshot=n,Ms(t)&&Ls(e)}function _s(e,t,i){return i((function(){Ms(t)&&Ls(e)}))}function Ms(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!an(e,i)}catch(n){return!0}}function Ls(e){var t=Oo(e,1);null!==t&&nl(t,e,1,-1)}function Bs(e){var t=Es();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:e},t.queue=e,e=e.dispatch=ia.bind(null,fs,e),[t.memoizedState,e]}function qs(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=fs.updateQueue)?(t={lastEffect:null,stores:null},fs.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Us(){return Ts().memoizedState}function Fs(e,t,i,n){var r=Es();fs.flags|=e,r.memoizedState=qs(1|t,i,void 0,void 0===n?null:n)}function Ws(e,t,i,n){var r=Ts();n=void 0===n?null:n;var o=void 0;if(null!==gs){var s=gs.memoizedState;if(o=s.destroy,null!==n&&bs(n,s.deps))return void(r.memoizedState=qs(t,i,o,n))}fs.flags|=e,r.memoizedState=qs(1|t,i,o,n)}function Hs(e,t){return Fs(8390656,8,e,t)}function js(e,t){return Ws(2048,8,e,t)}function Vs(e,t){return Ws(4,2,e,t)}function Ks(e,t){return Ws(4,4,e,t)}function Js(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Gs(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Ws(4,4,Js.bind(null,t,e),i)}function Qs(){}function $s(e,t){var i=Ts();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&bs(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Ys(e,t){var i=Ts();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&bs(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Xs(e,t,i){return 0===(21&vs)?(e.baseState&&(e.baseState=!1,Ca=!0),e.memoizedState=i):(an(i,t)||(i=ft(),fs.lanes|=i,Lc|=i,e.baseState=!0),t)}function Zs(e,t){var i=St;St=0!==i&&4>i?i:4,e(!0);var n=hs.transition;hs.transition={};try{e(!1),t()}finally{St=i,hs.transition=n}}function ea(){return Ts().memoizedState}function ta(e,t,i){var n=il(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},na(e))ra(t,i);else if(null!==(i=Ao(e,t,i,n))){nl(i,e,n,tl()),oa(i,t,n)}}function ia(e,t,i){var n=il(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(na(e))ra(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,i);if(r.hasEagerState=!0,r.eagerState=a,an(a,s)){var c=t.interleaved;return null===c?(r.next=r,ko(t)):(r.next=c.next,c.next=r),void(t.interleaved=r)}}catch(l){}null!==(i=Ao(e,t,r,n))&&(nl(i,e,n,r=tl()),oa(i,t,n))}}function na(e){var t=e.alternate;return e===fs||null!==t&&t===fs}function ra(e,t){Ss=ys=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function oa(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,yt(e,i)}}var sa={readContext:Eo,useCallback:Rs,useContext:Rs,useEffect:Rs,useImperativeHandle:Rs,useInsertionEffect:Rs,useLayoutEffect:Rs,useMemo:Rs,useReducer:Rs,useRef:Rs,useState:Rs,useDebugValue:Rs,useDeferredValue:Rs,useTransition:Rs,useMutableSource:Rs,useSyncExternalStore:Rs,useId:Rs,unstable_isNewReconciler:!1},aa={readContext:Eo,useCallback:function(e,t){return Es().memoizedState=[e,void 0===t?null:t],e},useContext:Eo,useEffect:Hs,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Fs(4194308,4,Js.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Fs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fs(4,2,e,t)},useMemo:function(e,t){var i=Es();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Es();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ta.bind(null,fs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Es().memoizedState=e},useState:Bs,useDebugValue:Qs,useDeferredValue:function(e){return Es().memoizedState=e},useTransition:function(){var e=Bs(!1),t=e[0];return e=Zs.bind(null,e[1]),Es().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=fs,r=Es();if(ro){if(void 0===i)throw Error(o(407));i=i()}else{if(i=t(),null===Oc)throw Error(o(349));0!==(30&vs)||zs(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,Hs(_s.bind(null,n,s,e),[e]),n.flags|=2048,qs(9,Ns.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=Es(),t=Oc.identifierPrefix;if(ro){var i=Yr;t=":"+t+"R"+(i=($r&~(1<<32-st($r)-1)).toString(32)+i),0<(i=Cs++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=ws++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:Eo,useCallback:$s,useContext:Eo,useEffect:js,useImperativeHandle:Gs,useInsertionEffect:Vs,useLayoutEffect:Ks,useMemo:Ys,useReducer:As,useRef:Us,useState:function(){return As(ks)},useDebugValue:Qs,useDeferredValue:function(e){return Xs(Ts(),gs.memoizedState,e)},useTransition:function(){return[As(ks)[0],Ts().memoizedState]},useMutableSource:xs,useSyncExternalStore:Ds,useId:ea,unstable_isNewReconciler:!1},la={readContext:Eo,useCallback:$s,useContext:Eo,useEffect:js,useImperativeHandle:Gs,useInsertionEffect:Vs,useLayoutEffect:Ks,useMemo:Ys,useReducer:Os,useRef:Us,useState:function(){return Os(ks)},useDebugValue:Qs,useDeferredValue:function(e){var t=Ts();return null===gs?t.memoizedState=e:Xs(t,gs.memoizedState,e)},useTransition:function(){return[Os(ks)[0],Ts().memoizedState]},useMutableSource:xs,useSyncExternalStore:Ds,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var i="",n=t;do{i+=F(n),n=n.return}while(n);var r=i}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:r,digest:null}}function pa(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var ha="function"===typeof WeakMap?WeakMap:Map;function va(e,t,i){(i=No(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Vc||(Vc=!0,Kc=n),da(0,t)},i}function fa(e,t,i){(i=No(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){da(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(i.callback=function(){da(0,t),"function"!==typeof n&&(null===Jc?Jc=new Set([this]):Jc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function ga(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new ha;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=El.bind(null,e,t,i),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,i,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=No(-1,1)).tag=2,_o(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var Sa=C.ReactCurrentOwner,Ca=!1;function wa(e,t,i,n){t.child=null===e?Xo(t,null,i,n):Yo(t,e.child,i,n)}function Ra(e,t,i,n,r){i=i.render;var o=t.ref;return Io(t,r),n=Ps(e,t,i,n,o,r),i=Is(),null===e||Ca?(ro&&i&&eo(t),t.flags|=1,wa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Va(e,t,r))}function ba(e,t,i,n,r){if(null===e){var o=i.type;return"function"!==typeof o||zl(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=_l(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Pa(e,t,o,n,r))}if(o=e.child,0===(e.lanes&r)){var s=o.memoizedProps;if((i=null!==(i=i.compare)?i:cn)(s,n)&&e.ref===t.ref)return Va(e,t,r)}return t.flags|=1,(e=Nl(o,n)).ref=t.ref,e.return=t,t.child=e}function Pa(e,t,i,n,r){if(null!==e){var o=e.memoizedProps;if(cn(o,n)&&e.ref===t.ref){if(Ca=!1,t.pendingProps=n=o,0===(e.lanes&r))return t.lanes=e.lanes,Va(e,t,r);0!==(131072&e.flags)&&(Ca=!0)}}return Ta(e,t,i,n,r)}function Ia(e,t,i){var n=t.pendingProps,r=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Nc,zc),zc|=i;else{if(0===(1073741824&i))return e=null!==o?o.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Nc,zc),zc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:i,Er(Nc,zc),zc|=n}else null!==o?(n=o.baseLanes|i,t.memoizedState=null):n=i,Er(Nc,zc),zc|=n;return wa(e,t,r,i),t.child}function Ea(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Ta(e,t,i,n,r){var o=Dr(i)?Or:kr.current;return o=xr(t,o),Io(t,r),i=Ps(e,t,i,n,o,r),n=Is(),null===e||Ca?(ro&&n&&eo(t),t.flags|=1,wa(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Va(e,t,r))}function ka(e,t,i,n,r){if(Dr(i)){var o=!0;Mr(t)}else o=!1;if(Io(t,r),null===t.stateNode)ja(e,t),jo(t,i,n),Ko(t,i,n,r),n=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=i.contextType;"object"===typeof l&&null!==l?l=Eo(l):l=xr(t,l=Dr(i)?Or:kr.current);var u=i.getDerivedStateFromProps,p="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;p||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==n||c!==l)&&Vo(t,s,n,l),xo=!1;var d=t.memoizedState;s.state=d,Bo(t,n,s,r),c=t.memoizedState,a!==n||d!==c||Ar.current||xo?("function"===typeof u&&(Fo(t,i,u,n),c=t.memoizedState),(a=xo||Ho(t,i,a,n,d,c,l))?(p||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=l,n=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,zo(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:mo(t.type,a),s.props=l,p=t.pendingProps,d=s.context,"object"===typeof(c=i.contextType)&&null!==c?c=Eo(c):c=xr(t,c=Dr(i)?Or:kr.current);var h=i.getDerivedStateFromProps;(u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==p||d!==c)&&Vo(t,s,n,c),xo=!1,d=t.memoizedState,s.state=d,Bo(t,n,s,r);var v=t.memoizedState;a!==p||d!==v||Ar.current||xo?("function"===typeof h&&(Fo(t,i,h,n),v=t.memoizedState),(l=xo||Ho(t,i,l,n,d,v,c)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,v,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,v,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=c,n=l):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Aa(e,t,i,n,o,r)}function Aa(e,t,i,n,r,o){Ea(e,t);var s=0!==(128&t.flags);if(!n&&!s)return r&&Lr(t,i,!1),Va(e,t,o);n=t.stateNode,Sa.current=t;var a=s&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Yo(t,e.child,null,o),t.child=Yo(t,null,a,o)):wa(e,t,a,o),t.memoizedState=n.state,r&&Lr(t,i,!0),t.child}function Oa(e){var t=e.stateNode;t.pendingContext?Nr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Nr(0,t.context,!1),rs(e,t.containerInfo)}function xa(e,t,i,n,r){return vo(),fo(r),t.flags|=256,wa(e,t,i,n),t.child}var Da,za,Na,_a,Ma={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,i){var n,r=t.pendingProps,s=cs.current,a=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Er(cs,1&s),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,a?(r=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ll(c,r,0,null),e=Ml(e,r,i,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=La(i),t.memoizedState=Ma,e):qa(t,c));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,i,n,r,s,a){if(i)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,n=pa(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,r=t.mode,n=Ll({mode:"visible",children:n.children},r,0,null),(s=Ml(s,r,a,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&Yo(t,e.child,null,a),t.child.memoizedState=La(a),t.memoizedState=Ma,s);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var c=n.dgst;return n=c,Ua(e,t,a,n=pa(s=Error(o(419)),n,void 0))}if(c=0!==(a&e.childLanes),Ca||c){if(null!==(n=Oc)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Oo(e,r),nl(n,e,r,-1))}return gl(),Ua(e,t,a,n=pa(Error(o(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=kl.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,no=lr(r.nextSibling),io=t,ro=!0,oo=null,null!==e&&(Jr[Gr++]=$r,Jr[Gr++]=Yr,Jr[Gr++]=Qr,$r=e.id,Yr=e.overflow,Qr=t),t=qa(t,n.children),t.flags|=4096,t)}(e,t,c,r,n,s,i);if(a){a=r.fallback,c=t.mode,n=(s=e.child).sibling;var l={mode:"hidden",children:r.children};return 0===(1&c)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=l,t.deletions=null):(r=Nl(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==n?a=Nl(n,a):(a=Ml(a,c,i,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,c=null===(c=e.child.memoizedState)?La(i):{baseLanes:c.baseLanes|i,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~i,t.memoizedState=Ma,r}return e=(a=e.child).sibling,r=Nl(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function qa(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,i,n){return null!==n&&fo(n),Yo(t,e.child,null,i),(e=qa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fa(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Po(e.return,t,i)}function Wa(e,t,i,n,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=r)}function Ha(e,t,i){var n=t.pendingProps,r=n.revealOrder,o=n.tail;if(wa(e,t,n.children,i),0!==(2&(n=cs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fa(e,i,t);else if(19===e.tag)Fa(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Er(cs,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===ls(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),Wa(t,!1,r,i,o);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ls(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}Wa(t,!0,i,null,o);break;case"together":Wa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ja(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Va(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(i=Nl(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Nl(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ka(e,t){if(!ro)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ja(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function Ga(e,t,i){var n=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ja(t),null;case 1:case 17:return Dr(t.type)&&zr(),Ja(t),null;case 3:return n=t.stateNode,os(),Ir(Ar),Ir(kr),ps(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(po(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(al(oo),oo=null))),za(e,t),Ja(t),null;case 5:as(t);var r=ns(is.current);if(i=t.type,null!==e&&null!=t.stateNode)Na(e,t,i,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(o(166));return Ja(t),null}if(e=ns(es.current),po(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[dr]=t,n[hr]=s,e=0!==(1&t.mode),i){case"dialog":qn("cancel",n),qn("close",n);break;case"iframe":case"object":case"embed":qn("load",n);break;case"video":case"audio":for(r=0;r<_n.length;r++)qn(_n[r],n);break;case"source":qn("error",n);break;case"img":case"image":case"link":qn("error",n),qn("load",n);break;case"details":qn("toggle",n);break;case"input":$(n,s),qn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},qn("invalid",n);break;case"textarea":re(n,s),qn("invalid",n)}for(var c in ye(i,s),r=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"===typeof l?n.textContent!==l&&(!0!==s.suppressHydrationWarning&&Xn(n.textContent,l,e),r=["children",l]):"number"===typeof l&&n.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Xn(n.textContent,l,e),r=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&qn("scroll",n)}switch(i){case"input":K(n),Z(n,s,!0);break;case"textarea":K(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=Zn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(i,{is:n.is}):(e=c.createElement(i),"select"===i&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,i),e[dr]=t,e[hr]=n,Da(e,t,!1,!1),t.stateNode=e;e:{switch(c=Se(i,n),i){case"dialog":qn("cancel",e),qn("close",e),r=n;break;case"iframe":case"object":case"embed":qn("load",e),r=n;break;case"video":case"audio":for(r=0;r<_n.length;r++)qn(_n[r],e);r=n;break;case"source":qn("error",e),r=n;break;case"img":case"image":case"link":qn("error",e),qn("load",e),r=n;break;case"details":qn("toggle",e),r=n;break;case"input":$(e,n),r=Q(e,n),qn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=L({},n,{value:void 0}),qn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),qn("invalid",e)}for(s in ye(i,r),l=r)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&pe(e,u):"children"===s?"string"===typeof u?("textarea"!==i||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&qn("scroll",e):null!=u&&S(e,s,u,c))}switch(i){case"input":K(e),Z(e,n,!1);break;case"textarea":K(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+j(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?ie(e,!!n.multiple,s,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ja(t),null;case 6:if(e&&null!=t.stateNode)_a(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(i=ns(is.current),ns(es.current),po(t)){if(n=t.stateNode,i=t.memoizedProps,n[dr]=t,(s=n.nodeValue!==i)&&null!==(e=io))switch(e.tag){case 3:Xn(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,i,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[dr]=t,t.stateNode=n}return Ja(t),null;case 13:if(Ir(cs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ro&&null!==no&&0!==(1&t.mode)&&0===(128&t.flags))ho(),vo(),t.flags|=98560,s=!1;else if(s=po(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[dr]=t}else vo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ja(t),s=!1}else null!==oo&&(al(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&cs.current)?0===_c&&(_c=3):gl())),null!==t.updateQueue&&(t.flags|=4),Ja(t),null);case 4:return os(),za(e,t),null===e&&Wn(t.stateNode.containerInfo),Ja(t),null;case 10:return bo(t.type._context),Ja(t),null;case 19:if(Ir(cs),null===(s=t.memoizedState))return Ja(t),null;if(n=0!==(128&t.flags),null===(c=s.rendering))if(n)Ka(s,!1);else{if(0!==_c||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ls(e))){for(t.flags|=128,Ka(s,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Er(cs,1&cs.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>Hc&&(t.flags|=128,n=!0,Ka(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ls(c))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Ka(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!ro)return Ja(t),null}else 2*Ye()-s.renderingStartTime>Hc&&1073741824!==i&&(t.flags|=128,n=!0,Ka(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(i=s.last)?i.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,i=cs.current,Er(cs,n?1&i|2:1&i),t):(Ja(t),null);case 22:case 23:return dl(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&zc)&&(Ja(t),6&t.subtreeFlags&&(t.flags|=8192)):Ja(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Qa(e,t){switch(to(t),t.tag){case 1:return Dr(t.type)&&zr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return os(),Ir(Ar),Ir(kr),ps(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Ir(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));vo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ir(cs),null;case 4:return os(),null;case 10:return bo(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}Da=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},za=function(){},Na=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,ns(es.current);var o,s=null;switch(i){case"input":r=Q(e,r),n=Q(e,n),s=[];break;case"select":r=L({},r,{value:void 0}),n=L({},n,{value:void 0}),s=[];break;case"textarea":r=ne(e,r),n=ne(e,n),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(u in ye(i,n),i=null,r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var c=r[u];for(o in c)c.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(c=null!=r?r[u]:void 0,n.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(i||(i={}),i[o]=l[o])}else i||(s||(s=[]),s.push(u,i)),i=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&qn("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}i&&(s=s||[]).push("style",i);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},_a=function(e,t,i,n){i!==n&&(t.flags|=4)};var $a=!1,Ya=!1,Xa="function"===typeof WeakSet?WeakSet:Set,Za=null;function ec(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Il(e,t,n)}else i.current=null}function tc(e,t,i){try{i()}catch(n){Il(e,t,n)}}var ic=!1;function nc(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&tc(t,i,o)}r=r.next}while(r!==n)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function oc(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[hr],delete t[fr],delete t[gr],delete t[mr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(lc(e,t,i),e=e.sibling;null!==e;)lc(e,t,i),e=e.sibling}function uc(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(uc(e,t,i),e=e.sibling;null!==e;)uc(e,t,i),e=e.sibling}var pc=null,dc=!1;function hc(e,t,i){for(i=i.child;null!==i;)vc(e,t,i),i=i.sibling}function vc(e,t,i){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,i)}catch(a){}switch(i.tag){case 5:Ya||ec(i,t);case 6:var n=pc,r=dc;pc=null,hc(e,t,i),dc=r,null!==(pc=n)&&(dc?(e=pc,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):pc.removeChild(i.stateNode));break;case 18:null!==pc&&(dc?(e=pc,i=i.stateNode,8===e.nodeType?cr(e.parentNode,i):1===e.nodeType&&cr(e,i),Wt(e)):cr(pc,i.stateNode));break;case 4:n=pc,r=dc,pc=i.stateNode.containerInfo,dc=!0,hc(e,t,i),pc=n,dc=r;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&tc(i,t,s),r=r.next}while(r!==n)}hc(e,t,i);break;case 1:if(!Ya&&(ec(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){Il(i,t,a)}hc(e,t,i);break;case 21:hc(e,t,i);break;case 22:1&i.mode?(Ya=(n=Ya)||null!==i.memoizedState,hc(e,t,i),Ya=n):hc(e,t,i);break;default:hc(e,t,i)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Xa),t.forEach((function(t){var n=Al.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function gc(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var s=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:pc=c.stateNode,dc=!1;break e;case 3:case 4:pc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===pc)throw Error(o(160));vc(s,a,r),pc=null,dc=!1;var l=r.alternate;null!==l&&(l.return=null),r.return=null}catch(u){Il(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),yc(e),4&n){try{nc(3,e,e.return),rc(3,e)}catch(g){Il(e,e.return,g)}try{nc(5,e,e.return)}catch(g){Il(e,e.return,g)}}break;case 1:gc(t,e),yc(e),512&n&&null!==i&&ec(i,i.return);break;case 5:if(gc(t,e),yc(e),512&n&&null!==i&&ec(i,i.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Il(e,e.return,g)}}if(4&n&&null!=(r=e.stateNode)){var s=e.memoizedProps,a=null!==i?i.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&Y(r,s),Se(c,a);var u=Se(c,s);for(a=0;a<l.length;a+=2){var p=l[a],d=l[a+1];"style"===p?ge(r,d):"dangerouslySetInnerHTML"===p?pe(r,d):"children"===p?de(r,d):S(r,p,d,u)}switch(c){case"input":X(r,s);break;case"textarea":oe(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;null!=v?ie(r,!!s.multiple,v,!1):h!==!!s.multiple&&(null!=s.defaultValue?ie(r,!!s.multiple,s.defaultValue,!0):ie(r,!!s.multiple,s.multiple?[]:"",!1))}r[hr]=s}catch(g){Il(e,e.return,g)}}break;case 6:if(gc(t,e),yc(e),4&n){if(null===e.stateNode)throw Error(o(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(g){Il(e,e.return,g)}}break;case 3:if(gc(t,e),yc(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Il(e,e.return,g)}break;case 4:default:gc(t,e),yc(e);break;case 13:gc(t,e),yc(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Wc=Ye())),4&n&&fc(e);break;case 22:if(p=null!==i&&null!==i.memoizedState,1&e.mode?(Ya=(u=Ya)||p,gc(t,e),Ya=u):gc(t,e),yc(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!p&&0!==(1&e.mode))for(Za=e,p=e.child;null!==p;){for(d=Za=p;null!==Za;){switch(v=(h=Za).child,h.tag){case 0:case 11:case 14:case 15:nc(4,h,h.return);break;case 1:ec(h,h.return);var f=h.stateNode;if("function"===typeof f.componentWillUnmount){n=h,i=h.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Il(n,i,g)}}break;case 5:ec(h,h.return);break;case 22:if(null!==h.memoizedState){Rc(d);continue}}null!==v?(v.return=h,Za=v):Rc(d)}p=p.sibling}e:for(p=null,d=e;;){if(5===d.tag){if(null===p){p=d;try{r=d.stateNode,u?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=d.stateNode,a=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=fe("display",a))}catch(g){Il(e,e.return,g)}}}else if(6===d.tag){if(null===p)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Il(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;p===d&&(p=null),d=d.return}p===d&&(p=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gc(t,e),yc(e),4&n&&fc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(ac(i)){var n=i;break e}i=i.return}throw Error(o(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(de(r,""),n.flags&=-33),uc(e,cc(e),r);break;case 3:case 4:var s=n.stateNode.containerInfo;lc(e,cc(e),s);break;default:throw Error(o(161))}}catch(a){Il(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Sc(e,t,i){Za=e,Cc(e,t,i)}function Cc(e,t,i){for(var n=0!==(1&e.mode);null!==Za;){var r=Za,o=r.child;if(22===r.tag&&n){var s=null!==r.memoizedState||$a;if(!s){var a=r.alternate,c=null!==a&&null!==a.memoizedState||Ya;a=$a;var l=Ya;if($a=s,(Ya=c)&&!l)for(Za=r;null!==Za;)c=(s=Za).child,22===s.tag&&null!==s.memoizedState?bc(r):null!==c?(c.return=s,Za=c):bc(r);for(;null!==o;)Za=o,Cc(o,t,i),o=o.sibling;Za=r,$a=a,Ya=l}wc(e)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Za=o):wc(e)}}function wc(e){for(;null!==Za;){var t=Za;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||rc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ya)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:mo(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&qo(t,s,n);break;case 3:var a=t.updateQueue;if(null!==a){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}qo(t,a,i)}break;case 5:var c=t.stateNode;if(null===i&&4&t.flags){i=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var p=u.memoizedState;if(null!==p){var d=p.dehydrated;null!==d&&Wt(d)}}}break;default:throw Error(o(163))}Ya||512&t.flags&&oc(t)}catch(h){Il(t,t.return,h)}}if(t===e){Za=null;break}if(null!==(i=t.sibling)){i.return=t.return,Za=i;break}Za=t.return}}function Rc(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Za=i;break}Za=t.return}}function bc(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{rc(4,t)}catch(c){Il(t,i,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(c){Il(t,r,c)}}var o=t.return;try{oc(t)}catch(c){Il(t,o,c)}break;case 5:var s=t.return;try{oc(t)}catch(c){Il(t,s,c)}}}catch(c){Il(t,t.return,c)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var Pc,Ic=Math.ceil,Ec=C.ReactCurrentDispatcher,Tc=C.ReactCurrentOwner,kc=C.ReactCurrentBatchConfig,Ac=0,Oc=null,xc=null,Dc=0,zc=0,Nc=Pr(0),_c=0,Mc=null,Lc=0,Bc=0,qc=0,Uc=null,Fc=null,Wc=0,Hc=1/0,jc=null,Vc=!1,Kc=null,Jc=null,Gc=!1,Qc=null,$c=0,Yc=0,Xc=null,Zc=-1,el=0;function tl(){return 0!==(6&Ac)?Ye():-1!==Zc?Zc:Zc=Ye()}function il(e){return 0===(1&e.mode)?1:0!==(2&Ac)&&0!==Dc?Dc&-Dc:null!==go.transition?(0===el&&(el=ft()),el):0!==(e=St)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nl(e,t,i,n){if(50<Yc)throw Yc=0,Xc=null,Error(o(185));mt(e,i,n),0!==(2&Ac)&&e===Oc||(e===Oc&&(0===(2&Ac)&&(Bc|=i),4===_c&&cl(e,Dc)),rl(e,n),1===i&&0===Ac&&0===(1&t.mode)&&(Hc=Ye()+500,qr&&Wr()))}function rl(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,c=r[s];-1===c?0!==(a&i)&&0===(a&n)||(r[s]=ht(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var n=dt(e,e===Oc?Dc:0);if(0===n)null!==i&&Ge(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&Ge(i),1===t)0===e.tag?function(e){qr=!0,Fr(e)}(ll.bind(null,e)):Fr(ll.bind(null,e)),sr((function(){0===(6&Ac)&&Wr()})),i=null;else{switch(Ct(n)){case 1:i=Ze;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=Ol(i,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function ol(e,t){if(Zc=-1,el=0,0!==(6&Ac))throw Error(o(327));var i=e.callbackNode;if(bl()&&e.callbackNode!==i)return null;var n=dt(e,e===Oc?Dc:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=ml(e,n);else{t=n;var r=Ac;Ac|=2;var s=fl();for(Oc===e&&Dc===t||(jc=null,Hc=Ye()+500,hl(e,t));;)try{Sl();break}catch(c){vl(e,c)}Ro(),Ec.current=s,Ac=r,null!==xc?t=0:(Oc=null,Dc=0,t=_c)}if(0!==t){if(2===t&&(0!==(r=vt(e))&&(n=r,t=sl(e,r))),1===t)throw i=Mc,hl(e,0),cl(e,n),rl(e,Ye()),i;if(6===t)cl(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],o=r.getSnapshot;r=r.value;try{if(!an(o(),r))return!1}catch(a){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=ml(e,n))&&(0!==(s=vt(e))&&(n=s,t=sl(e,s))),1===t))throw i=Mc,hl(e,0),cl(e,n),rl(e,Ye()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(o(345));case 2:case 5:Rl(e,Fc,jc);break;case 3:if(cl(e,n),(130023424&n)===n&&10<(t=Wc+500-Ye())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){tl(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(Rl.bind(null,e,Fc,jc),t);break}Rl(e,Fc,jc);break;case 4:if(cl(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var a=31-st(n);s=1<<a,(a=t[a])>r&&(r=a),n&=~s}if(n=r,10<(n=(120>(n=Ye()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ic(n/1960))-n)){e.timeoutHandle=nr(Rl.bind(null,e,Fc,jc),n);break}Rl(e,Fc,jc);break;default:throw Error(o(329))}}}return rl(e,Ye()),e.callbackNode===i?ol.bind(null,e):null}function sl(e,t){var i=Uc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Fc,Fc=i,null!==t&&al(t)),e}function al(e){null===Fc?Fc=e:Fc.push.apply(Fc,e)}function cl(e,t){for(t&=~qc,t&=~Bc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-st(t),n=1<<i;e[i]=-1,t&=~n}}function ll(e){if(0!==(6&Ac))throw Error(o(327));bl();var t=dt(e,0);if(0===(1&t))return rl(e,Ye()),null;var i=ml(e,t);if(0!==e.tag&&2===i){var n=vt(e);0!==n&&(t=n,i=sl(e,n))}if(1===i)throw i=Mc,hl(e,0),cl(e,t),rl(e,Ye()),i;if(6===i)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Rl(e,Fc,jc),rl(e,Ye()),null}function ul(e,t){var i=Ac;Ac|=1;try{return e(t)}finally{0===(Ac=i)&&(Hc=Ye()+500,qr&&Wr())}}function pl(e){null!==Qc&&0===Qc.tag&&0===(6&Ac)&&bl();var t=Ac;Ac|=1;var i=kc.transition,n=St;try{if(kc.transition=null,St=1,e)return e()}finally{St=n,kc.transition=i,0===(6&(Ac=t))&&Wr()}}function dl(){zc=Nc.current,Ir(Nc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,rr(i)),null!==xc)for(i=xc.return;null!==i;){var n=i;switch(to(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&zr();break;case 3:os(),Ir(Ar),Ir(kr),ps();break;case 5:as(n);break;case 4:os();break;case 13:case 19:Ir(cs);break;case 10:bo(n.type._context);break;case 22:case 23:dl()}i=i.return}if(Oc=e,xc=e=Nl(e.current,null),Dc=zc=t,_c=0,Mc=null,qc=Bc=Lc=0,Fc=Uc=null,null!==To){for(t=0;t<To.length;t++)if(null!==(n=(i=To[t]).interleaved)){i.interleaved=null;var r=n.next,o=i.pending;if(null!==o){var s=o.next;o.next=r,n.next=s}i.pending=n}To=null}return e}function vl(e,t){for(;;){var i=xc;try{if(Ro(),ds.current=sa,ys){for(var n=fs.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}ys=!1}if(vs=0,ms=gs=fs=null,Ss=!1,Cs=0,Tc.current=null,null===i||null===i.return){_c=1,Mc=t,xc=null;break}e:{var s=e,a=i.return,c=i,l=t;if(t=Dc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,p=c,d=p.tag;if(0===(1&p.mode)&&(0===d||11===d||15===d)){var h=p.alternate;h?(p.updateQueue=h.updateQueue,p.memoizedState=h.memoizedState,p.lanes=h.lanes):(p.updateQueue=null,p.memoizedState=null)}var v=ma(a);if(null!==v){v.flags&=-257,ya(v,a,c,0,t),1&v.mode&&ga(s,u,t),l=u;var f=(t=v).updateQueue;if(null===f){var g=new Set;g.add(l),t.updateQueue=g}else f.add(l);break e}if(0===(1&t)){ga(s,u,t),gl();break e}l=Error(o(426))}else if(ro&&1&c.mode){var m=ma(a);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ya(m,a,c,0,t),fo(ua(l,c));break e}}s=l=ua(l,c),4!==_c&&(_c=2),null===Uc?Uc=[s]:Uc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Lo(s,va(0,l,t));break e;case 1:c=l;var y=s.type,S=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==S&&"function"===typeof S.componentDidCatch&&(null===Jc||!Jc.has(S)))){s.flags|=65536,t&=-t,s.lanes|=t,Lo(s,fa(s,c,t));break e}}s=s.return}while(null!==s)}wl(i)}catch(C){t=C,xc===i&&null!==i&&(xc=i=i.return);continue}break}}function fl(){var e=Ec.current;return Ec.current=sa,null===e?sa:e}function gl(){0!==_c&&3!==_c&&2!==_c||(_c=4),null===Oc||0===(268435455&Lc)&&0===(268435455&Bc)||cl(Oc,Dc)}function ml(e,t){var i=Ac;Ac|=2;var n=fl();for(Oc===e&&Dc===t||(jc=null,hl(e,t));;)try{yl();break}catch(r){vl(e,r)}if(Ro(),Ac=i,Ec.current=n,null!==xc)throw Error(o(261));return Oc=null,Dc=0,_c}function yl(){for(;null!==xc;)Cl(xc)}function Sl(){for(;null!==xc&&!Qe();)Cl(xc)}function Cl(e){var t=Pc(e.alternate,e,zc);e.memoizedProps=e.pendingProps,null===t?wl(e):xc=t,Tc.current=null}function wl(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=Ga(i,t,zc)))return void(xc=i)}else{if(null!==(i=Qa(i,t)))return i.flags&=32767,void(xc=i);if(null===e)return _c=6,void(xc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(xc=t);xc=t=e}while(null!==t);0===_c&&(_c=5)}function Rl(e,t,i){var n=St,r=kc.transition;try{kc.transition=null,St=1,function(e,t,i,n){do{bl()}while(null!==Qc);if(0!==(6&Ac))throw Error(o(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-st(i),o=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~o}}(e,s),e===Oc&&(xc=Oc=null,Dc=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Gc||(Gc=!0,Ol(tt,(function(){return bl(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=kc.transition,kc.transition=null;var a=St;St=1;var c=Ac;Ac|=4,Tc.current=null,function(e,t){if(er=jt,hn(e=dn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch(w){i=null;break e}var a=0,c=-1,l=-1,u=0,p=0,d=e,h=null;t:for(;;){for(var v;d!==i||0!==r&&3!==d.nodeType||(c=a+r),d!==s||0!==n&&3!==d.nodeType||(l=a+n),3===d.nodeType&&(a+=d.nodeValue.length),null!==(v=d.firstChild);)h=d,d=v;for(;;){if(d===e)break t;if(h===i&&++u===r&&(c=a),h===s&&++p===n&&(l=a),null!==(v=d.nextSibling))break;h=(d=h).parentNode}d=v}i=-1===c||-1===l?null:{start:c,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:e,selectionRange:i},jt=!1,Za=t;null!==Za;)if(e=(t=Za).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,m=f.memoizedState,y=t.stateNode,S=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:mo(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var C=t.stateNode.containerInfo;1===C.nodeType?C.textContent="":9===C.nodeType&&C.documentElement&&C.removeChild(C.documentElement);break;default:throw Error(o(163))}}catch(w){Il(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}f=ic,ic=!1}(e,i),mc(i,e),vn(tr),jt=!!er,tr=er=null,e.current=i,Sc(i,e,r),$e(),Ac=c,St=a,kc.transition=s}else e.current=i;if(Gc&&(Gc=!1,Qc=e,$c=r),s=e.pendingLanes,0===s&&(Jc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),rl(e,Ye()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)r=t[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(Vc)throw Vc=!1,e=Kc,Kc=null,e;0!==(1&$c)&&0!==e.tag&&bl(),s=e.pendingLanes,0!==(1&s)?e===Xc?Yc++:(Yc=0,Xc=e):Yc=0,Wr()}(e,t,i,n)}finally{kc.transition=r,St=n}return null}function bl(){if(null!==Qc){var e=Ct($c),t=kc.transition,i=St;try{if(kc.transition=null,St=16>e?16:e,null===Qc)var n=!1;else{if(e=Qc,Qc=null,$c=0,0!==(6&Ac))throw Error(o(331));var r=Ac;for(Ac|=4,Za=e.current;null!==Za;){var s=Za,a=s.child;if(0!==(16&Za.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Za=u;null!==Za;){var p=Za;switch(p.tag){case 0:case 11:case 15:nc(8,p,s)}var d=p.child;if(null!==d)d.return=p,Za=d;else for(;null!==Za;){var h=(p=Za).sibling,v=p.return;if(sc(p),p===u){Za=null;break}if(null!==h){h.return=v,Za=h;break}Za=v}}}var f=s.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Za=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Za=a;else e:for(;null!==Za;){if(0!==(2048&(s=Za).flags))switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Za=y;break e}Za=s.return}}var S=e.current;for(Za=S;null!==Za;){var C=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==C)C.return=a,Za=C;else e:for(a=S;null!==Za;){if(0!==(2048&(c=Za).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(R){Il(c,c.return,R)}if(c===a){Za=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Za=w;break e}Za=c.return}}if(Ac=r,Wr(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(R){}n=!0}return n}finally{St=i,kc.transition=t}}return!1}function Pl(e,t,i){e=_o(e,t=va(0,t=ua(i,t),1),1),t=tl(),null!==e&&(mt(e,1,t),rl(e,t))}function Il(e,t,i){if(3===e.tag)Pl(e,e,i);else for(;null!==t;){if(3===t.tag){Pl(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Jc||!Jc.has(n))){t=_o(t,e=fa(t,e=ua(i,e),1),1),e=tl(),null!==t&&(mt(t,1,e),rl(t,e));break}}t=t.return}}function El(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&i,Oc===e&&(Dc&i)===i&&(4===_c||3===_c&&(130023424&Dc)===Dc&&500>Ye()-Wc?hl(e,0):qc|=i),rl(e,t)}function Tl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var i=tl();null!==(e=Oo(e,t))&&(mt(e,t,i),rl(e,i))}function kl(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Tl(e,i)}function Al(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(t),Tl(e,i)}function Ol(e,t){return Je(e,t)}function xl(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dl(e,t,i,n){return new xl(e,t,i,n)}function zl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nl(e,t){var i=e.alternate;return null===i?((i=Dl(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function _l(e,t,i,n,r,s){var a=2;if(n=e,"function"===typeof e)zl(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case b:return Ml(i.children,r,s,t);case P:a=8,r|=8;break;case I:return(e=Dl(12,i,t,2|r)).elementType=I,e.lanes=s,e;case A:return(e=Dl(13,i,t,r)).elementType=A,e.lanes=s,e;case O:return(e=Dl(19,i,t,r)).elementType=O,e.lanes=s,e;case z:return Ll(i,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case T:a=9;break e;case k:a=11;break e;case x:a=14;break e;case D:a=16,n=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Dl(a,i,t,r)).elementType=e,t.type=n,t.lanes=s,t}function Ml(e,t,i,n){return(e=Dl(7,e,n,t)).lanes=i,e}function Ll(e,t,i,n){return(e=Dl(22,e,n,t)).elementType=z,e.lanes=i,e.stateNode={isHidden:!1},e}function Bl(e,t,i){return(e=Dl(6,e,null,t)).lanes=i,e}function ql(e,t,i){return(t=Dl(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ul(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fl(e,t,i,n,r,o,s,a,c){return e=new Ul(e,t,i,a,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Dl(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Do(o),e}function Wl(e){if(!e)return Tr;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var i=e.type;if(Dr(i))return _r(e,i,t)}return t}function Hl(e,t,i,n,r,o,s,a,c){return(e=Fl(i,n,!0,e,0,o,0,a,c)).context=Wl(null),i=e.current,(o=No(n=tl(),r=il(i))).callback=void 0!==t&&null!==t?t:null,_o(i,o,r),e.current.lanes=r,mt(e,r,n),rl(e,n),e}function jl(e,t,i,n){var r=t.current,o=tl(),s=il(r);return i=Wl(i),null===t.context?t.context=i:t.pendingContext=i,(t=No(o,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=_o(r,t,s))&&(nl(e,r,s,o),Mo(e,r,s)),s}function Vl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Jl(e,t){Kl(e,t),(e=e.alternate)&&Kl(e,t)}Pc=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ar.current)Ca=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return Ca=!1,function(e,t,i){switch(t.tag){case 3:Oa(t),vo();break;case 5:ss(t);break;case 1:Dr(t.type)&&Mr(t);break;case 4:rs(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Er(yo,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Er(cs,1&cs.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Ba(e,t,i):(Er(cs,1&cs.current),null!==(e=Va(e,t,i))?e.sibling:null);Er(cs,1&cs.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Ha(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er(cs,cs.current),n)break;return null;case 22:case 23:return t.lanes=0,Ia(e,t,i)}return Va(e,t,i)}(e,t,i);Ca=0!==(131072&e.flags)}else Ca=!1,ro&&0!==(1048576&t.flags)&&Zr(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ja(e,t),e=t.pendingProps;var r=xr(t,kr.current);Io(t,i),r=Ps(null,t,n,e,r,i);var s=Is();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(n)?(s=!0,Mr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Do(t),r.updater=Wo,t.stateNode=r,r._reactInternals=t,Ko(t,n,e,i),t=Aa(null,t,n,!0,s,i)):(t.tag=0,ro&&s&&eo(t),wa(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(ja(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return zl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===x)return 14}return 2}(n),e=mo(n,e),r){case 0:t=Ta(null,t,n,e,i);break e;case 1:t=ka(null,t,n,e,i);break e;case 11:t=Ra(null,t,n,e,i);break e;case 14:t=ba(null,t,n,mo(n.type,e),i);break e}throw Error(o(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Ta(e,t,n,r=t.elementType===n?r:mo(n,r),i);case 1:return n=t.type,r=t.pendingProps,ka(e,t,n,r=t.elementType===n?r:mo(n,r),i);case 3:e:{if(Oa(t),null===e)throw Error(o(387));n=t.pendingProps,r=(s=t.memoizedState).element,zo(e,t),Bo(t,n,null,i);var a=t.memoizedState;if(n=a.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=xa(e,t,n,i,r=ua(Error(o(423)),t));break e}if(n!==r){t=xa(e,t,n,i,r=ua(Error(o(424)),t));break e}for(no=lr(t.stateNode.containerInfo.firstChild),io=t,ro=!0,oo=null,i=Xo(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(vo(),n===r){t=Va(e,t,i);break e}wa(e,t,n,i)}t=t.child}return t;case 5:return ss(t),null===e&&lo(t),n=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,ir(n,r)?a=null:null!==s&&ir(n,s)&&(t.flags|=32),Ea(e,t),wa(e,t,a,i),t.child;case 6:return null===e&&lo(t),null;case 13:return Ba(e,t,i);case 4:return rs(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Yo(t,null,n,i):wa(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,Ra(e,t,n,r=t.elementType===n?r:mo(n,r),i);case 7:return wa(e,t,t.pendingProps,i),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,Er(yo,n._currentValue),n._currentValue=a,null!==s)if(an(s.value,a)){if(s.children===r.children&&!Ar.current){t=Va(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){a=s.child;for(var l=c.firstContext;null!==l;){if(l.context===n){if(1===s.tag){(l=No(-1,i&-i)).tag=2;var u=s.updateQueue;if(null!==u){var p=(u=u.shared).pending;null===p?l.next=l:(l.next=p.next,p.next=l),u.pending=l}}s.lanes|=i,null!==(l=s.alternate)&&(l.lanes|=i),Po(s.return,i,t),c.lanes|=i;break}l=l.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=i,null!==(c=a.alternate)&&(c.lanes|=i),Po(a,i,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}wa(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Io(t,i),n=n(r=Eo(r)),t.flags|=1,wa(e,t,n,i),t.child;case 14:return r=mo(n=t.type,t.pendingProps),ba(e,t,n,r=mo(n.type,r),i);case 15:return Pa(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:mo(n,r),ja(e,t),t.tag=1,Dr(n)?(e=!0,Mr(t)):e=!1,Io(t,i),jo(t,n,r),Ko(t,n,r,i),Aa(null,t,n,!0,e,i);case 19:return Ha(e,t,i);case 22:return Ia(e,t,i)}throw Error(o(156,t.tag))};var Gl="function"===typeof reportError?reportError:function(e){console.error(e)};function Ql(e){this._internalRoot=e}function $l(e){this._internalRoot=e}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function eu(e,t,i,n,r){var o=i._reactRootContainer;if(o){var s=o;if("function"===typeof r){var a=r;r=function(){var e=Vl(s);a.call(e)}}jl(t,s,e,r)}else s=function(e,t,i,n,r){if(r){if("function"===typeof n){var o=n;n=function(){var e=Vl(s);o.call(e)}}var s=Hl(t,n,e,0,null,!1,0,"",Zl);return e._reactRootContainer=s,e[vr]=s.current,Wn(8===e.nodeType?e.parentNode:e),pl(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var a=n;n=function(){var e=Vl(c);a.call(e)}}var c=Fl(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=c,e[vr]=c.current,Wn(8===e.nodeType?e.parentNode:e),pl((function(){jl(t,c,i,n)})),c}(i,t,e,r,n);return Vl(s)}$l.prototype.render=Ql.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));jl(e,t,null,null)},$l.prototype.unmount=Ql.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pl((function(){jl(null,e,null,null)})),t[vr]=null}},$l.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<zt.length&&0!==t&&t<zt[i].priority;i++);zt.splice(i,0,e),0===i&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=pt(t.pendingLanes);0!==i&&(yt(t,1|i),rl(t,Ye()),0===(6&Ac)&&(Hc=Ye()+500,Wr()))}break;case 13:pl((function(){var t=Oo(e,1);if(null!==t){var i=tl();nl(t,e,1,i)}})),Jl(e,1)}},Rt=function(e){if(13===e.tag){var t=Oo(e,134217728);if(null!==t)nl(t,e,134217728,tl());Jl(e,134217728)}},bt=function(e){if(13===e.tag){var t=il(e),i=Oo(e,t);if(null!==i)nl(i,e,t,tl());Jl(e,t)}},Pt=function(){return St},It=function(e,t){var i=St;try{return St=e,t()}finally{St=i}},Re=function(e,t,i){switch(t){case"input":if(X(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=wr(n);if(!r)throw Error(o(90));J(n),X(n,r)}}}break;case"textarea":oe(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},ke=ul,Ae=pl;var tu={usingClientEntryPoint:!1,Events:[Sr,Cr,wr,Ee,Te,ul]},iu={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nu={bundleType:iu.bundleType,version:iu.version,rendererPackageName:iu.rendererPackageName,rendererConfig:iu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:iu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yl(t))throw Error(o(200));return function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:R,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.createRoot=function(e,t){if(!Yl(e))throw Error(o(299));var i=!1,n="",r=Gl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Fl(e,1,!1,null,0,i,0,n,r),e[vr]=t.current,Wn(8===e.nodeType?e.parentNode:e),new Ql(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return pl(e)},t.hydrate=function(e,t,i){if(!Xl(t))throw Error(o(200));return eu(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Yl(e))throw Error(o(405));var n=null!=i&&i.hydratedSources||null,r=!1,s="",a=Gl;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),t=Hl(t,null,e,1,null!=i?i:null,r,0,s,a),e[vr]=t.current,Wn(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new $l(t)},t.render=function(e,t,i){if(!Xl(t))throw Error(o(200));return eu(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(o(40));return!!e._reactRootContainer&&(pl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[vr]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Xl(i))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return eu(e,t,i,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,i)=>{"use strict";var n=i(164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},164:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(463)},374:(e,t,i)=>{"use strict";var n=i(791),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,i){var n,o={},l=null,u=null;for(n in void 0!==i&&(l=""+i),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:r,type:e,key:l,ref:u,props:o,_owner:a.current}}t.jsx=l,t.jsxs=l},117:(e,t)=>{"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function m(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||v}function y(){}function S(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||v}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var C=S.prototype=new y;C.constructor=S,f(C,m.prototype),C.isPureReactComponent=!0;var w=Array.isArray,R=Object.prototype.hasOwnProperty,b={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,n){var r,o={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)R.call(t,r)&&!P.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:i,type:e,key:s,ref:a,props:o,_owner:b.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var T=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,r,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case i:case n:c=!0}}if(c)return s=s(c=e),e=""===o?"."+k(c,0):o,w(s)?(r="",null!=e&&(r=e.replace(T,"$&/")+"/"),A(s,t,r,"",(function(e){return e}))):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+e)),t.push(s)),1;if(c=0,o=""===o?".":o+":",w(e))for(var l=0;l<e.length;l++){var u=o+k(a=e[l],l);c+=A(a,t,r,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=A(a=a.value,t,r,u=o+k(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,i){if(null==e)return e;var n=[],r=0;return A(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function x(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},z={transition:null},N={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:z,ReactCurrentOwner:b};t.Children={map:O,forEach:function(e,t,i){O(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=r,t.Profiler=s,t.PureComponent=S,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=b.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)R.call(t,l)&&!P.hasOwnProperty(l)&&(r[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)r.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:i,type:e.type,key:o,ref:s,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:x}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=z.transition;z.transition={};try{e()}finally{z.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,i){return D.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,i){return D.current.useReducer(e,t,i)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return D.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return D.current.useTransition()},t.version="18.2.0"},791:(e,t,i)=>{"use strict";e.exports=i(117)},184:(e,t,i)=>{"use strict";e.exports=i(374)},813:(e,t)=>{"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<o(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,s=r>>>1;n<s;){var a=2*(n+1)-1,c=e[a],l=a+1,u=e[l];if(0>o(c,i))l<r&&0>o(u,c)?(e[n]=u,e[l]=i,n=l):(e[n]=c,e[a]=i,n=a);else{if(!(l<r&&0>o(u,i)))break e;e[n]=u,e[l]=i,n=l}}}return t}function o(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],p=1,d=null,h=3,v=!1,f=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,S="undefined"!==typeof setImmediate?setImmediate:null;function C(e){for(var t=n(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,i(l,t)}t=n(u)}}function w(e){if(g=!1,C(e),!f)if(null!==n(l))f=!0,z(R);else{var t=n(u);null!==t&&N(w,t.startTime-e)}}function R(e,i){f=!1,g&&(g=!1,y(E),E=-1),v=!0;var o=h;try{for(C(i),d=n(l);null!==d&&(!(d.expirationTime>i)||e&&!A());){var s=d.callback;if("function"===typeof s){d.callback=null,h=d.priorityLevel;var a=s(d.expirationTime<=i);i=t.unstable_now(),"function"===typeof a?d.callback=a:d===n(l)&&r(l),C(i)}else r(l);d=n(l)}if(null!==d)var c=!0;else{var p=n(u);null!==p&&N(w,p.startTime-i),c=!1}return c}finally{d=null,h=o,v=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var b,P=!1,I=null,E=-1,T=5,k=-1;function A(){return!(t.unstable_now()-k<T)}function O(){if(null!==I){var e=t.unstable_now();k=e;var i=!0;try{i=I(!0,e)}finally{i?b():(P=!1,I=null)}}else P=!1}if("function"===typeof S)b=function(){S(O)};else if("undefined"!==typeof MessageChannel){var x=new MessageChannel,D=x.port2;x.port1.onmessage=O,b=function(){D.postMessage(null)}}else b=function(){m(O,0)};function z(e){I=e,P||(P=!0,b())}function N(e,i){E=m((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||v||(f=!0,z(R))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var i=h;h=t;try{return e()}finally{h=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=h;h=e;try{return t()}finally{h=i}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:p++,callback:r,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,i(u,e),null===n(l)&&e===n(u)&&(g?(y(E),E=-1):g=!0,N(w,o-s))):(e.sortIndex=a,i(l,e),f||v||(f=!0,z(R))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=h;return function(){var i=h;h=t;try{return e.apply(this,arguments)}finally{h=i}}}},296:(e,t,i)=>{"use strict";e.exports=i(813)},648:(e,t,i)=>{"use strict";e.exports=i.p+"static/media/speech-processor.ce2b5f9ff72b7744205f.js"},916:()=>{},271:()=>{},104:()=>{},151:()=>{},270:()=>{},914:()=>{},88:()=>{},602:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ActivityReceivedEventArgs:()=>Rn,AudioConfig:()=>Te,AudioFormatTag:()=>j,AudioInputStream:()=>oe,AudioOutputStream:()=>he,AudioStreamFormat:()=>Q,AutoDetectSourceLanguageConfig:()=>sr,AutoDetectSourceLanguageResult:()=>ar,AvatarConfig:()=>ns,AvatarEventArgs:()=>rs,AvatarSynthesizer:()=>as,AvatarVideoFormat:()=>is,AvatarWebRTCConnectionResult:()=>cs,BaseAudioPlayer:()=>_n,BotFrameworkConfig:()=>mn,CancellationDetails:()=>hn,CancellationDetailsBase:()=>dn,CancellationErrorCode:()=>nt,CancellationReason:()=>Re,Connection:()=>sn,ConnectionEventArgs:()=>nn,ConnectionMessage:()=>en,ConnectionMessageEventArgs:()=>rn,Conversation:()=>so,ConversationExpirationEventArgs:()=>Nr,ConversationParticipantsChangedEventArgs:()=>to,ConversationTranscriber:()=>Ro,ConversationTranscriptionCanceledEventArgs:()=>yo,ConversationTranscriptionEventArgs:()=>Ue,ConversationTranscriptionResult:()=>mo,ConversationTranslationCanceledEventArgs:()=>zr,ConversationTranslationEventArgs:()=>io,ConversationTranslationResult:()=>_r,ConversationTranslator:()=>fo,Coordinate:()=>ts,CustomCommandsConfig:()=>yn,Diagnostics:()=>ps,DialogServiceConfig:()=>fn,DialogServiceConnector:()=>zn,IntentRecognitionCanceledEventArgs:()=>Ci,IntentRecognitionEventArgs:()=>ze,IntentRecognitionResult:()=>Me,IntentRecognizer:()=>Ei,KeywordRecognitionModel:()=>Oe,LanguageIdMode:()=>tr,LanguageUnderstandingModel:()=>Le,LogLevel:()=>E,Meeting:()=>Po,MeetingTranscriber:()=>zo,MeetingTranscriptionCanceledEventArgs:()=>Eo,MeetingTranscriptionEventArgs:()=>Fe,NoMatchDetails:()=>pn,NoMatchReason:()=>an,OutputFormat:()=>be,Participant:()=>ro,ParticipantChangedReason:()=>Yr,PhraseListGrammar:()=>vn,ProfanityOption:()=>et,PronunciationAssessmentConfig:()=>Xo,PronunciationAssessmentGradingSystem:()=>Jo,PronunciationAssessmentGranularity:()=>Go,PronunciationAssessmentResult:()=>es,PropertyCollection:()=>ot,PropertyId:()=>Ze,PullAudioInputStream:()=>ce,PullAudioInputStreamCallback:()=>ie,PullAudioOutputStream:()=>ve,PushAudioInputStream:()=>se,PushAudioOutputStream:()=>ge,PushAudioOutputStreamCallback:()=>we,RecognitionEventArgs:()=>De,RecognitionResult:()=>Ne,Recognizer:()=>Vt,ResultReason:()=>Pe,ServiceEventArgs:()=>on,ServicePropertyChannel:()=>xn,SessionEventArgs:()=>xe,SourceLanguageConfig:()=>cr,SpeakerAudioDestination:()=>Ce,SpeakerIdentificationModel:()=>rr,SpeakerRecognitionCancellationDetails:()=>Xn,SpeakerRecognitionResult:()=>Yn,SpeakerRecognitionResultType:()=>Gn,SpeakerRecognizer:()=>nr,SpeakerVerificationModel:()=>or,SpeechConfig:()=>st,SpeechConfigImpl:()=>at,SpeechRecognitionCanceledEventArgs:()=>He,SpeechRecognitionEventArgs:()=>qe,SpeechRecognitionResult:()=>_e,SpeechRecognizer:()=>mi,SpeechSynthesisBookmarkEventArgs:()=>Wi,SpeechSynthesisBoundaryType:()=>Ko,SpeechSynthesisEventArgs:()=>Fo,SpeechSynthesisOutputFormat:()=>ne,SpeechSynthesisResult:()=>Ui,SpeechSynthesisVisemeEventArgs:()=>Hi,SpeechSynthesisWordBoundaryEventArgs:()=>Fi,SpeechSynthesizer:()=>Yo,SpeechTranslationConfig:()=>ct,SpeechTranslationConfigImpl:()=>lt,SynthesisResult:()=>qi,SynthesisVoicesResult:()=>Vo,Synthesizer:()=>Bo,TranslationRecognitionCanceledEventArgs:()=>Ai,TranslationRecognitionEventArgs:()=>je,TranslationRecognitionResult:()=>Ke,TranslationRecognizer:()=>un,TranslationSynthesisEventArgs:()=>Ve,TranslationSynthesisResult:()=>Je,Translations:()=>Oi,TurnStatusReceivedEventArgs:()=>Pn,User:()=>no,VoiceInfo:()=>jo,VoiceProfile:()=>Mn,VoiceProfileCancellationDetails:()=>Un,VoiceProfileClient:()=>$n,VoiceProfileEnrollmentCancellationDetails:()=>Bn,VoiceProfileEnrollmentResult:()=>Ln,VoiceProfilePhraseResult:()=>Fn,VoiceProfileResult:()=>qn,VoiceProfileType:()=>bi});class n{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}class r{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){const t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;const i=2*t.length,n=new ArrayBuffer(i),r=new DataView(n);return this.floatTo16BitPCM(r,0,t),n}setString(e,t,i){for(let n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}floatTo16BitPCM(e,t,i){for(let n=0;n<i.length;n++,t+=2){const r=Math.max(-1,Math.min(1,i[n]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}downSampleAudioFrame(e,t,i){if(!e)return null;if(i===t||i>t)return e;const n=t/i,r=Math.round(e.length/n),o=new Float32Array(r);let s=0,a=0;for(;a<r;){const t=Math.round((a+1)*n);let i=0,r=0;for(;s<t&&s<e.length;)i+=e[s++],r++;o[a++]=i/r}return o}}class o{constructor(e){this.privStopInputOnRelease=e}record(e,t,n){const o=new r(e.sampleRate,16e3),s=e.createMediaStreamSource(t),a=()=>{const i=(()=>{let t=0;try{return e.createScriptProcessor(t,1,1)}catch(i){t=2048;let n=e.sampleRate;for(;t<16384&&n>=32e3;)t<<=1,n>>=1;return e.createScriptProcessor(t,1,1)}})();i.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(n&&!n.isClosed){const e=o.encode(t);e&&n.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:s,stream:t}},c=e=>{const i=new AudioWorkletNode(e,"speech-processor");i.port.onmessage=e=>{const t=e.data;if(n&&!n.isClosed){const e=o.encode(t);e&&n.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:s,stream:t}},l=!!this.privSpeechProcessorScript&&"ignore"===this.privSpeechProcessorScript.toLowerCase();if(e.audioWorklet&&!l)this.privSpeechProcessorScript=new URL(i(648),i.b).toString(),e.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{c(e)})).catch((()=>{const t=new Blob(["class SP extends AudioWorkletProcessor {\n                        constructor(options) {\n                        super(options);\n                        }\n                        process(inputs, outputs) {\n                        const input = inputs[0];\n                        const output = [];\n                        for (let channel = 0; channel < input.length; channel += 1) {\n                            output[channel] = input[channel];\n                        }\n                        this.port.postMessage(output[0]);\n                        return true;\n                        }\n                    }\n                    registerProcessor('speech-processor', SP);"],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(t),e.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{c(e)})).catch((()=>{a()}))}));else try{a()}catch(u){throw new Error("Unable to start audio worklet node for PCMRecorder: ".concat(u))}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach((e=>e.stop())),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}}class s{constructor(e){this.context=e}serialize(){return JSON.stringify(this,((e,t)=>{if(t&&"object"===typeof t&&!Array.isArray(t)){const e={};for(const i in t)Object.hasOwnProperty.call(t,i)&&(e[i&&i.charAt(0).toLowerCase()+i.substring(1)]=t[i]);return e}return t}))}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class a{constructor(e){this.system=new c,this.os=e}}class c{constructor(){this.name="SpeechSDK",this.version="1.33.1",this.build="JavaScript",this.lang="JavaScript"}}class l{constructor(e,t,i){this.platform=e,this.name=t,this.version=i}}var u,p;!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(u||(u={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(p||(p={}));const d={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let h;const v=new Uint8Array(16);function f(){if(!h&&(h="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(v)}const g=[];for(let ds=0;ds<256;++ds)g.push((ds+256).toString(16).slice(1));function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]}const y=function(e,t,i){if(d.randomUUID&&!t&&!e)return d.randomUUID();const n=(e=e||{}).random||(e.rng||f)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=n[e];return t}return m(n)},S=()=>y(),C=()=>S().replace(new RegExp("-","g"),"").toUpperCase();class w extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class R extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class b extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}class P{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new b("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){const t=C();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach((t=>e.onEvent(t)))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach((t=>e.onEvent(t))),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}var I,E;!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(I||(I={}));class T{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise(((e,t)=>{this.privResolve=e,this.privReject=t}))}get promise(){return this.privPromise}}function k(e,t,i){e.then((e=>{try{t&&t(e)}catch(n){if(i)try{if(n instanceof Error){const e=n;i(e.name+": "+e.message)}else i(n)}catch(n){}}}),(e=>{if(i)try{if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}catch(e){}}))}!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.None=4]="None"}(E||(E={}));class A{constructor(e,t){this.privName=e,this.privEventId=C(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}class O extends A{constructor(e,t){super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.Info),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class x extends O{constructor(e){super("AudioSourceInitializingEvent",e)}}class D extends O{constructor(e){super("AudioSourceReadyEvent",e)}}class z extends O{constructor(e){super("AudioSourceOffEvent",e)}}class N extends O{constructor(e,t){super("AudioSourceErrorEvent",e,E.Error),this.privError=t}get error(){return this.privError}}class _ extends O{constructor(e,t,i){super(e,t),this.privAudioNodeId=i}get audioNodeId(){return this.privAudioNodeId}}class M extends _{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class L extends _{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class B extends _{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class q extends _{constructor(e,t,i){super("AudioStreamNodeErrorEvent",e,t),this.privError=i}get error(){return this.privError}}class U{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(const t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();const i=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),i}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){const e=Array();return this.privList.forEach((t=>{e.push(t)})),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();const t=[];for(let i=0;i<this.privList.length;i++)t.push(e(this.privList[i],i));return new U(t)}where(e){this.throwIfDisposed();const t=new U;for(let i=0;i<this.privList.length;i++)e(this.privList[i],i)&&t.add(this.privList[i]);return t}orderBy(e){this.throwIfDisposed();const t=this.toArray().sort(e);return new U(t)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy(((t,i)=>e(i,t)))}clone(){return this.throwIfDisposed(),new U(this.toArray())}concat(e){return this.throwIfDisposed(),new U(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new U(this.privList.concat(e))}isDisposed(){return null==this.privList}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new b("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(const t in e)t&&e[t]()}}var F,W=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(F||(F={}));class H{constructor(e){this.privPromiseStore=new U,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new U,this.privDetachables=[],this.privSubscribers=new U,this.privDetachables.push(this.privList.onAdded((()=>this.drain())))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise((t=>t(e))))}enqueueFromPromise(e){this.throwIfDispose(),e.then((e=>{this.privList.add(e)}),(()=>{}))}dequeue(){this.throwIfDispose();const e=new T;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:F.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();const e=new T;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:F.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return null==this.privSubscribers}drainAndDispose(e,t){return W(this,void 0,void 0,(function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const i=this.privSubscribers;if(i){for(;i.length()>0;){i.removeFirst().deferral.resolve(void 0)}this.privSubscribers===i&&(this.privSubscribers=i)}for(const e of this.privDetachables)yield e.detach();if(this.privPromiseStore.length()>0&&e){const t=[];return this.privPromiseStore.toArray().forEach((e=>{t.push(e)})),Promise.all(t).finally((()=>{this.privSubscribers=null,this.privList.forEach((t=>{e(t)})),this.privList=null})).then()}this.privSubscribers=null,this.privList=null}}))}dispose(e){return W(this,void 0,void 0,(function*(){yield this.drainAndDispose(null,e)}))}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const i=e.removeFirst();if(i.type===F.Peek)i.deferral.resolve(t.first());else{const e=t.removeFirst();i.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed()){if(this.privDisposeReason)throw new R(this.privDisposeReason);throw new b("Queue")}if(this.privIsDisposing)throw new R("Queue disposing")}}var j,V=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class K{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||C(),this.privReaderQueue=new H}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(t){}}read(){if(this.privIsReadEnded)throw new R("Stream read has already finished");return this.privReaderQueue.dequeue().then((e=>V(this,void 0,void 0,(function*(){return(void 0===e||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e}))))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new H)}throwIfClosed(){if(this.privIsWriteEnded)throw new R("Stream closed")}}class J extends K{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const i=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),r=new Uint8Array(e.buffer.slice(t,i+t));n.set(r,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=i,t+=i,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}class G{static setEventSource(e){if(!e)throw new w("eventSource");G.privInstance=e}static get instance(){return G.privInstance}}G.privInstance=new P,function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.OGG_OPUS=6]="OGG_OPUS",e[e.WEBM_OPUS=7]="WEBM_OPUS",e[e.ALaw=8]="ALaw",e[e.FLAC=9]="FLAC",e[e.OPUS=10]="OPUS"}(j||(j={}));class Q{static getDefaultInputFormat(){return $.getDefaultInputFormat()}static getWaveFormat(e,t,i,n){return new $(e,t,i,n)}static getWaveFormatPCM(e,t,i){return new $(e,t,i)}}class $ extends Q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j.PCM;super();let r=!0;switch(n){case j.PCM:this.formatTag=1;break;case j.ALaw:this.formatTag=6;break;case j.MuLaw:this.formatTag=7;break;default:r=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=i,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),r){this.privHeader=new ArrayBuffer(44);const e=new DataView(this.privHeader);this.setString(e,0,"RIFF"),e.setUint32(4,0,!0),this.setString(e,8,"WAVEfmt "),e.setUint32(16,16,!0),e.setUint16(20,this.formatTag,!0),e.setUint16(22,this.channels,!0),e.setUint32(24,this.samplesPerSec,!0),e.setUint32(28,this.avgBytesPerSec,!0),e.setUint16(32,this.channels*(this.bitsPerSample/8),!0),e.setUint16(34,this.bitsPerSample,!0),this.setString(e,36,"data"),e.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new $}static getAudioContext(e){const t=window.AudioContext||window.webkitAudioContext||!1;if(t)return void 0!==e&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,i){for(let n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}}var Y=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class X{constructor(e,t,i,n){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=X.AUDIOFORMAT.avgBytesPerSec/10,this.privId=i||C(),this.privEvents=new P,this.privMediaStream=n||null,this.privIsClosing=!1}get format(){return Promise.resolve(X.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new T;try{this.createAudioContext()}catch(i){if(i instanceof Error){const e=i;this.privInitializeDeferral.reject(e.name+": "+e.message)}else this.privInitializeDeferral.reject(i);return this.privInitializeDeferral.promise}const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,i,n)=>{e.mediaDevices.getUserMedia(t).then(i).catch(n)}),t){const e=()=>{this.onEvent(new x(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new D(this.privId)),this.privInitializeDeferral.resolve()):t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},(e=>{this.privMediaStream=e,this.onEvent(new D(this.privId)),this.privInitializeDeferral.resolve()}),(e=>{const t="Error occurred during microphone initialization: ".concat(e);this.privInitializeDeferral.reject(t),this.onEvent(new N(this.privId,t))}))};"suspended"===this.privContext.state?this.privContext.resume().then(e).catch((e=>{this.privInitializeDeferral.reject("Failed to initialize audio context: ".concat(e))})):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new N(e,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new M(this.privId,e)),this.listen(e).then((t=>(this.onEvent(new L(this.privId,e)),{detach:()=>Y(this,void 0,void 0,(function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new B(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()})))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new B(this.privId,e)))}turnOff(){return Y(this,void 0,void 0,(function*(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}this.onEvent(new z(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()}))}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then((e=>({bitspersample:X.AUDIOFORMAT.bitsPerSample,channelcount:X.AUDIOFORMAT.channels,connectivity:u.Unknown,manufacturer:"Speech SDK",model:e,samplerate:X.AUDIOFORMAT.samplesPerSec,type:p.Microphones})))}setProperty(e,t){if("MICROPHONE-WorkletSourceUrl"!==e)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){const e="microphone";if(void 0!==this.privMicrophoneLabel)return Promise.resolve(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;const t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return Promise.resolve(this.privMicrophoneLabel);const i=new T;return navigator.mediaDevices.enumerateDevices().then((e=>{for(const i of e)if(i.deviceId===t){this.privMicrophoneLabel=i.label;break}i.resolve(this.privMicrophoneLabel)}),(()=>i.resolve(this.privMicrophoneLabel))),i.promise}listen(e){return Y(this,void 0,void 0,(function*(){yield this.turnOn();const t=new J(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(i){throw this.onEvent(new q(this.privId,e,i)),i}return t}))}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=$.getAudioContext(X.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return Y(this,void 0,void 0,(function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):null!==this.privContext&&"running"===this.privContext.state&&(yield this.privContext.suspend())}))}}X.AUDIOFORMAT=Q.getDefaultInputFormat();var Z=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class ee{constructor(e,t,i){this.privStreams={},this.privHeaderEnd=44,this.privId=i||C(),this.privEvents=new P,this.privSource=e,"undefined"!==typeof window&&"undefined"!==typeof Blob&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new N(e,"")),Promise.reject(e)}this.onEvent(new x(this.privId)),this.onEvent(new D(this.privId))}id(){return this.privId}attach(e){return Z(this,void 0,void 0,(function*(){this.onEvent(new M(this.privId,e));const t=yield this.upload(e);return this.onEvent(new L(this.privId,e)),Promise.resolve({detach:()=>Z(this,void 0,void 0,(function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new B(this.privId,e)),yield this.turnOff()})),id:()=>e,read:()=>t.read()})}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new B(this.privId,e)))}turnOff(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new z(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then((e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:u.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:p.File})))}readHeader(){const e=this.privSource.slice(0,4296),t=new T,i=e=>{const i=new DataView(e),n=e=>String.fromCharCode(i.getUint8(e),i.getUint8(e+1),i.getUint8(e+2),i.getUint8(e+3));if("RIFF"!==n(0))return void t.reject("Invalid WAV header in file, RIFF was not found");if("WAVE"!==n(8)||"fmt "!==n(12))return void t.reject("Invalid WAV header in file, WAVEfmt was not found");const r=i.getInt32(16,!0),o=i.getUint16(22,!0),s=i.getUint32(24,!0),a=i.getUint16(34,!0);let c=36+Math.max(r-16,0);for(;"data"!==n(c);c+=2)if(c>4288)return void t.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=c+8,t.resolve(Q.getWaveFormatPCM(s,a,o))};if("undefined"!==typeof window&&"undefined"!==typeof Blob&&e instanceof Blob){const t=new FileReader;t.onload=e=>{const t=e.target.result;i(t)},t.readAsArrayBuffer(e)}else{const t=e;i(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength))}return t.promise}upload(e){return Z(this,void 0,void 0,(function*(){const t=t=>{const i="Error occurred while processing '".concat(this.privFilename,"'. ").concat(t);throw this.onEvent(new q(this.privId,e,i)),new Error(i)};try{yield this.turnOn();const i=yield this.privAudioFormatPromise,n=new J(i.avgBytesPerSec/10,e);this.privStreams[e]=n;const r=this.privSource.slice(this.privHeaderEnd),o=e=>{n.isClosed||(n.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),n.close())};if("undefined"!==typeof window&&"undefined"!==typeof Blob&&r instanceof Blob){const e=new FileReader;e.onerror=e=>t(e.toString()),e.onload=e=>{const t=e.target.result;o(t)},e.readAsArrayBuffer(r)}else{const e=r;o(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}return n}catch(i){t(i)}}))}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}}class te{static throwIfNullOrUndefined(e,t){if(void 0===e||null===e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(te.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,i){if(te.throwIfNullOrUndefined(e,t),(""+e).length>i)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(e,t,i){if(te.throwIfNullOrUndefined(e,t),(""+e).length<i)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+i.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(te.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const i of e)te.throwIfNullOrWhitespace(i,t)}static throwIfFileDoesNotExist(e,t){te.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)}}class ie{}var ne,re=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class oe{constructor(){}static createPushStream(e){return se.create(e)}static createPullStream(e,t){return ce.create(e,t)}}class se extends oe{static create(e){return new ae(e)}}class ae extends se{constructor(e){super(),this.privFormat=void 0===e?$.getDefaultInputFormat():e,this.privEvents=new P,this.privId=C(),this.privStream=new J(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new x(this.privId)),this.onEvent(new D(this.privId))}attach(e){return re(this,void 0,void 0,(function*(){this.onEvent(new M(this.privId,e)),yield this.turnOn();const t=this.privStream;return this.onEvent(new L(this.privId,e)),{detach:()=>re(this,void 0,void 0,(function*(){return this.onEvent(new B(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()}}))}detach(e){this.onEvent(new B(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:u.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:p.Stream})}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}toBuffer(e){const t=Buffer.alloc(e.byteLength),i=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=i[n];return t}}class ce extends oe{constructor(){super()}static create(e,t){return new le(e,t)}}class le extends ce{constructor(e,t){super(),this.privFormat=void 0===t?Q.getDefaultInputFormat():t,this.privEvents=new P,this.privId=C(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new x(this.privId)),this.onEvent(new D(this.privId))}attach(e){return re(this,void 0,void 0,(function*(){return this.onEvent(new M(this.privId,e)),yield this.turnOn(),this.onEvent(new L(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new B(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let e,t=0;for(;t<this.privBufferSize;){const i=new ArrayBuffer(this.privBufferSize-t),n=this.privCallback.read(i);if(void 0===e)e=i;else{new Int8Array(e).set(new Int8Array(i),t)}if(0===n)break;t+=n}return Promise.resolve({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}}))}detach(e){this.onEvent(new B(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:u.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:p.Stream})}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}}class ue extends A{constructor(e){super("BackgroundEvent",E.Error),this.privError=e}get error(){return this.privError}}!function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"}(ne||(ne={}));class pe extends ${constructor(e,t,i,n,r,o,s,a,c){super(i,o,t,e),this.formatTag=e,this.avgBytesPerSec=n,this.blockAlign=r,this.priAudioFormatString=s,this.priRequestAudioFormatString=a,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return void 0===e?pe.getDefaultOutputFormat():pe.fromSpeechSynthesisOutputFormatString(pe.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new pe(j.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new pe(j.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new pe(j.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new pe(j.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new pe(j.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new pe(j.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new pe(j.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new pe(j.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new pe(j.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new pe(j.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new pe(j.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new pe(j.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new pe(j.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new pe(j.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new pe(j.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new pe(j.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new pe(j.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new pe(j.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new pe(j.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new pe(j.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new pe(j.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new pe(j.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new pe(j.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new pe(j.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new pe(j.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new pe(j.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new pe(j.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new pe(j.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new pe(j.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new pe(j.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new pe(j.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new pe(j.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new pe(j.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new pe(j.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new pe(j.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new pe(j.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new pe(j.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new pe(j.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);default:return new pe(j.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return pe.fromSpeechSynthesisOutputFormatString("undefined"!==typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){const t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(e){if(!this.hasHeader)return e;this.updateHeader(e.byteLength);const t=new Uint8Array(e.byteLength+this.header.byteLength);return t.set(new Uint8Array(this.header),0),t.set(new Uint8Array(e),this.header.byteLength),t.buffer}}pe.SpeechSynthesisOutputFormatToString={[ne.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[ne.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[ne.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[ne.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[ne.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[ne.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[ne.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[ne.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[ne.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[ne.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[ne.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[ne.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[ne.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[ne.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[ne.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[ne.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[ne.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[ne.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[ne.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[ne.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[ne.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[ne.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[ne.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[ne.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[ne.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[ne.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[ne.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[ne.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[ne.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[ne.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[ne.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[ne.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[ne.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[ne.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[ne.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[ne.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[ne.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"};var de=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class he{constructor(){}static createPullStream(){return ve.create()}}class ve extends he{static create(){return new fe}}class fe extends ve{constructor(){super(),this.privId=C(),this.privStream=new K}set format(e){void 0!==e&&null!==e||(this.privFormat=pe.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return de(this,void 0,void 0,(function*(){const t=new Int8Array(e);let i=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),i=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;i<e.byteLength&&!this.privStream.isReadEnded;){const n=yield this.privStream.read();if(void 0===n||n.isEnd)this.privStream.readEnded();else{let r;n.buffer.byteLength>e.byteLength-i?(r=n.buffer.slice(0,e.byteLength-i),this.privLastChunkView=new Int8Array(n.buffer.slice(e.byteLength-i))):r=n.buffer,t.set(new Int8Array(r),i),i+=r.byteLength}}return i}))}write(e){te.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class ge extends he{constructor(){super()}static create(e){return new me(e)}}class me extends ge{constructor(e){super(),this.privId=C(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}var ye=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};const Se={[j.PCM]:"audio/wav",[j.MuLaw]:"audio/x-wav",[j.MP3]:"audio/mpeg",[j.OGG_OPUS]:"audio/ogg",[j.WEBM_OPUS]:"audio/webm; codecs=opus",[j.ALaw]:"audio/x-wav",[j.FLAC]:"audio/flac"};class Ce{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||C(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,i){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then((()=>{t&&t()}),(e=>{i&&i(e)}))):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd().then((()=>{e&&e()}),(e=>{t&&t(e)}));else if(void 0!==this.privAudioOutputStream&&"undefined"!==typeof window)if(this.privFormat.formatTag!==j.PCM&&this.privFormat.formatTag!==j.MuLaw&&this.privFormat.formatTag!==j.ALaw||!1!==this.privFormat.hasHeader){let i=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(i).then((()=>{i=this.privFormat.addHeader(i);const n=new Blob([i],{type:Se[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then((()=>{e&&e()}),(e=>{t&&t(e)}))}),(e=>{t&&t(e)}))}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if("undefined"!==typeof AudioContext||"undefined"!==typeof window&&"undefined"!==typeof window.webkitAudioContext){this.privFormat=e;const t=Se[this.privFormat.formatTag];void 0===t?console.warn("Unknown mimeType for format ".concat(j[this.privFormat.formatTag],"; playback is not supported.")):"undefined"!==typeof MediaSource&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch((e=>{G.instance.onEvent(new ue(e))}))},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch((e=>{G.instance.onEvent(new ue(e))}))},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch((e=>{G.instance.onEvent(new ue(e))}))):(console.warn("Format ".concat(j[this.privFormat.formatTag]," could not be played by MSE, streaming playback is not enabled.")),this.privAudioOutputStream=new fe,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var e,t;return null!==(t=null===(e=this.privAudio)||void 0===e?void 0:e.volume)&&void 0!==t?t:-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return ye(this,void 0,void 0,(function*(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const t=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(t)}catch(e){return this.privAudioBuffer.unshift(t),void console.log("buffer filled, pausing addition of binaries until space is made")}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())}))}handleSourceBufferUpdateEnd(){return ye(this,void 0,void 0,(function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())}))}notifyPlayback(){return ye(this,void 0,void 0,(function*(){this.privPlaybackStarted||void 0===this.privAudio||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))}))}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}class we{}var Re,be,Pe,Ie=i(88);class Ee{constructor(e){te.throwIfNullOrUndefined(Ie.openSync,"\nFile System access not available, please use Push or PullAudioOutputStream"),this.privFd=Ie.openSync(e,"w")}set format(e){te.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=Ie.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){te.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",(()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),Ie.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),Ie.closeSync(this.privFd),this.privFd=void 0})),this.privWriteStream.end())}id(){return this.privId}}class Te{static fromDefaultMicrophoneInput(){const e=new o(!0);return new ke(new X(e))}static fromMicrophoneInput(e){const t=new o(!0);return new ke(new X(t,e))}static fromWavFileInput(e){return new ke(new ee(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamedBuffer.wav"))}static fromStreamInput(e){if(e instanceof ie)return new ke(new le(e));if(e instanceof oe)return new ke(e);if("undefined"!==typeof MediaStream&&e instanceof MediaStream){const t=new o(!1);return new ke(new X(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new Ae(new Ce)}static fromSpeakerOutput(e){if(void 0===e)return Te.fromDefaultSpeakerOutput();if(e instanceof Ce)return new Ae(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new Ae(new Ee(e))}static fromStreamOutput(e){if(e instanceof we)return new Ae(new me(e));if(e instanceof ge)return new Ae(e);if(e instanceof ve)return new Ae(e);throw new Error("Not Supported Type")}}class ke extends Te{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then((()=>{e&&e()}),(e=>{t&&t(e)}))}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(te.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class Ae extends Te{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}!function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(Re||(Re={}));class Oe{constructor(){this.privDisposed=!1}static fromFile(e){throw te.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw te.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}class xe{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}class De extends xe{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}!function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(be||(be={}));class ze extends De{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class Ne{constructor(e,t,i,n,r,o,s,a,c,l){this.privResultId=e,this.privReason=t,this.privText=i,this.privDuration=n,this.privOffset=r,this.privLanguage=o,this.privLanguageDetectionConfidence=s,this.privErrorDetails=a,this.privJson=c,this.privProperties=l}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}class _e extends Ne{constructor(e,t,i,n,r,o,s,a,c,l,u){super(e,t,i,n,r,o,s,c,l,u),this.privSpeakerId=a}get speakerId(){return this.privSpeakerId}}class Me extends _e{constructor(e,t,i,n,r,o,s,a,c,l,u){super(t,i,n,r,o,s,a,void 0,c,l,u),this.privIntentId=e}get intentId(){return this.privIntentId}}class Le{constructor(){}static fromEndpoint(e){te.throwIfNull(e,"uri"),te.throwIfNullOrWhitespace(e.hostname,"uri");const t=new Be,i=e.host.indexOf(".");if(-1===i)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,i);const n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){te.throwIfNullOrWhitespace(e,"appId");const t=new Be;return t.appId=e,t}static fromSubscription(e,t,i){te.throwIfNullOrWhitespace(e,"subscriptionKey"),te.throwIfNullOrWhitespace(t,"appId"),te.throwIfNullOrWhitespace(i,"region");const n=new Be;return n.appId=t,n.region=i,n.subscriptionKey=e,n}}class Be extends Le{}class qe extends De{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class Ue extends De{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class Fe extends qe{}class We extends De{constructor(e,t,i,n,r){super(n,r),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class He extends We{}class je extends De{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class Ve extends xe{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}}class Ke extends _e{constructor(e,t,i,n,r,o,s,a,c,l,u){super(t,i,n,r,o,s,a,void 0,c,l,u),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new Ke(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}}class Je{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}}!function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile",e[e.VoicesListRetrieved=18]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=21]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(Pe||(Pe={}));const Ge="OutputFormat",Qe="CancellationErrorCode",$e="ServiceProperties",Ye="ForceDictation",Xe="OpenRange";var Ze,et,tt,it,nt,rt;!function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",e[e.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",e[e.Conversation_ApplicationId=46]="Conversation_ApplicationId",e[e.Conversation_DialogType=47]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=49]="Conversation_From_Id",e[e.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=56]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=57]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=59]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",e[e.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version",e[e.WebWorkerLoadType=67]="WebWorkerLoadType",e[e.TalkingAvatarService_WebRTC_SDP=68]="TalkingAvatarService_WebRTC_SDP"}(Ze||(Ze={}));class ot{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let i;i="string"===typeof e?e:Ze[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===i)return this.privValues[n];if(void 0!==t)return String(t)}setProperty(e,t){let i;i="string"===typeof e?e:Ze[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===i)return void(this.privValues[n]=t);this.privKeys.push(i),this.privValues.push(t)}clone(){const e=new ot;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach((t=>{if(void 0===e.getProperty(t,void 0)){const i=this.getProperty(t);e.setProperty(t,i)}}))}get keys(){return this.privKeys}}!function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(et||(et={}));class st{constructor(){}static fromSubscription(e,t){te.throwIfNullOrWhitespace(e,"subscriptionKey"),te.throwIfNullOrWhitespace(t,"region");const i=new at;return i.setProperty(Ze.SpeechServiceConnection_Region,t),i.setProperty(Ze.SpeechServiceConnection_IntentRegion,t),i.setProperty(Ze.SpeechServiceConnection_Key,e),i}static fromEndpoint(e,t){te.throwIfNull(e,"endpoint");const i=new at;return i.setProperty(Ze.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&i.setProperty(Ze.SpeechServiceConnection_Key,t),i}static fromHost(e,t){te.throwIfNull(e,"hostName");const i=new at;return i.setProperty(Ze.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&i.setProperty(Ze.SpeechServiceConnection_Key,t),i}static fromAuthorizationToken(e,t){te.throwIfNull(e,"authorizationToken"),te.throwIfNullOrWhitespace(t,"region");const i=new at;return i.setProperty(Ze.SpeechServiceConnection_Region,t),i.setProperty(Ze.SpeechServiceConnection_IntentRegion,t),i.authorizationToken=e,i}close(){}}class at extends st{constructor(){super(),this.privProperties=new ot,this.speechRecognitionLanguage="en-US",this.outputFormat=be.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(Ze.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return be[this.privProperties.getProperty(Ge,void 0)]}set outputFormat(e){this.privProperties.setProperty(Ge,be[e])}get endpointId(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){te.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,i,n){this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyPort],t),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyUserName],i),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t){const i=JSON.parse(this.privProperties.getProperty($e,"{}"));i[e]=t,this.privProperties.setProperty($e,JSON.stringify(i))}setProfanity(e){this.privProperties.setProperty(Ze.SpeechServiceResponse_ProfanityOption,et[e])}enableAudioLogging(){this.privProperties.setProperty(Ze.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(Ze.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(Ye,"true")}clone(){const e=new at;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(Ze.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return ne[this.privProperties.getProperty(Ze.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(Ze.SpeechServiceConnection_SynthOutputFormat,ne[e])}}class ct extends st{constructor(){super()}static fromSubscription(e,t){te.throwIfNullOrWhitespace(e,"subscriptionKey"),te.throwIfNullOrWhitespace(t,"region");const i=new lt;return i.properties.setProperty(Ze.SpeechServiceConnection_Key,e),i.properties.setProperty(Ze.SpeechServiceConnection_Region,t),i}static fromAuthorizationToken(e,t){te.throwIfNullOrWhitespace(e,"authorizationToken"),te.throwIfNullOrWhitespace(t,"region");const i=new lt;return i.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e),i.properties.setProperty(Ze.SpeechServiceConnection_Region,t),i}static fromHost(e,t){te.throwIfNull(e,"hostName");const i=new lt;return i.setProperty(Ze.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&i.setProperty(Ze.SpeechServiceConnection_Key,t),i}static fromEndpoint(e,t){te.throwIfNull(e,"endpoint"),te.throwIfNull(t,"subscriptionKey");const i=new lt;return i.properties.setProperty(Ze.SpeechServiceConnection_Endpoint,e.href),i.properties.setProperty(Ze.SpeechServiceConnection_Key,t),i}}class lt extends ct{constructor(){super(),this.privSpeechProperties=new ot,this.outputFormat=be.Simple}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){te.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(Ze[Ze.SpeechServiceConnection_Key])}get outputFormat(){return be[this.privSpeechProperties.getProperty(Ge,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(Ge,be[e])}get endpointId(){return this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){te.throwIfNullOrWhitespace(e,"value");const t=this.targetLanguages;t.includes(e)||(t.push(e),this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_TranslationToLanguages,t.join(",")))}get targetLanguages(){return void 0!==this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(Ze[Ze.SpeechServiceConnection_TranslationVoice])}set voiceName(e){te.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_Region)}setProxy(e,t,i,n){this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyPort],t),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyUserName],i),this.setProperty(Ze[Ze.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){const i=JSON.parse(this.privSpeechProperties.getProperty($e,"{}"));i[e]=t,this.privSpeechProperties.setProperty($e,JSON.stringify(i))}setProfanity(e){this.privSpeechProperties.setProperty(Ze.SpeechServiceResponse_ProfanityOption,et[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(Ze.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(Ye,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return ne[this.privSpeechProperties.getProperty(Ze.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(Ze.SpeechServiceConnection_SynthOutputFormat,ne[e])}}class ut{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privBytesPerSecond*1e-7);0!==t%2&&t++;let i=0;for(;i<this.privBuffers.length&&t>=this.privBuffers[i].chunk.buffer.byteLength;)t-=this.privBuffers[i++].chunk.buffer.byteLength;if(i<this.privBuffers.length){const e=this.privBuffers[i].chunk.buffer.slice(t);return this.privReplayOffset+=e.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:e,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}}return this.privAudioNode.read().then((e=>(e&&e.buffer&&(this.privBuffers.push(new pt(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e)))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(void 0===this.privBuffers||0===this.privBuffers.length)return;this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let i=Math.round(t*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&i>=this.privBuffers[n].chunk.buffer.byteLength;)i-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-i/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const t of this.privBuffers){const i=t.byteOffset/this.privBytesPerSecond*1e7,n=i+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=i&&e<=n)return t.chunk.timeReceived}return 0}}class pt{constructor(e,t,i){this.chunk=e,this.serial=t,this.byteOffset=i}}class dt{static load(){const e=new Map([[0,()=>{}]]),t=new Map,i="data:text/javascript;base64,"+btoa('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'),n=new Worker(i);n.addEventListener("message",(i=>{let{data:n}=i;if(dt.isCallNotification(n)){const{params:{timerId:i}}=n,r=e.get(i);if("number"===typeof r){const e=t.get(r);if(void 0===e||e!==i)throw new Error("The timer is in an undefined state.")}else{if("undefined"===typeof r)throw new Error("The timer is in an undefined state.");r(),e.delete(i)}}else{if(!dt.isClearResponse(n)){const{error:{message:e}}=n;throw new Error(e)}{const{id:i}=n,r=t.get(i);if(void 0===r)throw new Error("The timer is in an undefined state.");t.delete(i),e.delete(r)}}}));return{clearTimeout:i=>{const r=Math.random();t.set(r,i),e.set(i,r),n.postMessage({id:r,method:"clear",params:{timerId:i}})},setTimeout:(t,i)=>{const r=Math.random();return e.set(r,t),n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:r}}),r}}}static loadWorkerTimers(){return()=>(null!==dt.workerTimers||(dt.workerTimers=dt.load()),dt.workerTimers)}static isCallNotification(e){return void 0!==e.method&&"call"===e.method}static isClearResponse(e){return null===e.error&&"number"===typeof e.id}}dt.workerTimers=null,dt.clearTimeout=e=>dt.timers().clearTimeout(e),dt.setTimeout=(e,t)=>dt.timers().setTimeout(e,t),dt.timers=dt.loadWorkerTimers(),function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(tt||(tt={}));class ht{constructor(e,t,i,n){if(this.privBody=null,e===tt.Text&&t&&"string"!==typeof t)throw new R("Payload must be a string");if(e===tt.Binary&&t&&!(t instanceof ArrayBuffer))throw new R("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=i||{},this.privId=n||C(),this.messageType){case tt.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case tt.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===tt.Binary)throw new R("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===tt.Text)throw new R("Not supported for text message");return this.privBody}get id(){return this.privId}}class vt extends A{constructor(e,t){super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.Info),this.privJsonResult=t}get jsonString(){return this.privJsonResult}}class ft extends A{constructor(e,t){super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.Info),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class gt extends ft{constructor(e,t,i){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=i}get uri(){return this.privUri}get headers(){return this.privHeaders}}class mt extends ft{constructor(e){super("ConnectionEstablishedEvent",e)}}class yt extends ft{constructor(e,t,i){super("ConnectionClosedEvent",e,E.Debug),this.privReason=i,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class St extends ft{constructor(e,t,i){super("ConnectionErrorEvent",e,E.Debug),this.privMessage=t,this.privType=i}get message(){return this.privMessage}get type(){return this.privType}}class Ct extends ft{constructor(e,t,i){super("ConnectionEstablishErrorEvent",e,E.Error),this.privStatusCode=t,this.privReason=i}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class wt extends ft{constructor(e,t,i){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=i}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class Rt extends ft{constructor(e,t,i){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=i}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}!function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(it||(it={})),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"}(nt||(nt={}));class bt extends A{constructor(e,t,i){super(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:E.Info),this.privRequestId=t,this.privSessionId=i}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class Pt extends bt{constructor(e,t,i,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class It extends bt{constructor(e,t,i,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class Et extends bt{constructor(e,t,i){super("ConnectingToServiceEvent",e,i),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class Tt extends bt{constructor(e,t,i,n,r){super("RecognitionStartedEvent",e,r),this.privAudioSourceId=t,this.privAudioNodeId=i,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(rt||(rt={}));class kt{constructor(e,t,i){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=i,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){if(!this.privIsDisposed&&(e instanceof Pt&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof M&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof L&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof N&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof q&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof B&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof Et&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof gt&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof mt&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof Ct&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof wt&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path)){this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array);const t=50;this.privReceivedMessages[e.message.headers.path].length<t&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)}}getTelemetry(){const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},i=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],i}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}}var At,Ot,xt=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Dt{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=C(),this.privAudioNodeId=C(),this.privTurnDeferral=new T,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new kt(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new Pt(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return xt(this,void 0,void 0,(function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new It(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}))}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new Et(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return xt(this,void 0,void 0,(function*(){e&&(yield this.onComplete())}))}onConnectionEstablishCompleted(e,t){return xt(this,void 0,void 0,(function*(){if(200===e)return this.onEvent(new Tt(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&(yield this.onComplete())}))}onServiceTurnEndResponse(e){return xt(this,void 0,void 0,(function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}))}onSpeechContext(){this.privRequestId=C()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new T}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e,this.privRecognitionBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return xt(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}))}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return xt(this,void 0,void 0,(function*(){yield this.onComplete()}))}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),G.instance.onEvent(e)}onComplete(){return xt(this,void 0,void 0,(function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())}))}detachAudioNode(){return xt(this,void 0,void 0,(function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))}))}}class zt{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e=>{t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}}class Nt{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];void 0===this.privContext.phraseDetection&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),void 0===this.privContext.phraseDetection.enrichment&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),i&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),-1===this.privContext.phraseOutput.detailed.options.indexOf("SNR")&&this.privContext.phraseOutput.detailed.options.push("SNR"),t&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:t},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",-1===this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(e){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=e}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();this.setSection("dgi",e);return JSON.stringify(this.privContext)}}!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(At||(At={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(Ot||(Ot={}));class _t{constructor(e,t){this.privSpeechServiceConfig=e||new s(new a(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(Ze.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===At.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=At[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==At.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(Ze.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const e=[];let t=!1;if(void 0!==this.autoDetectSourceLanguages)for(const i of this.autoDetectSourceLanguages.split(",")){const n=i+Ze.SpeechServiceConnection_EndpointId.toString(),r=this.parameters.getProperty(n,void 0);void 0!==r?(e.push({language:i,endpoint:r}),t=!0):e.push({language:i,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(e){this.privEnableSpeakerId=e}}class Mt{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new Mt(e)}get Offset(){return this.privSpeechStartDetected.Offset}}class Lt{}Lt.AuthKey="Ocp-Apim-Subscription-Key",Lt.Authorization="Authorization",Lt.SpIDAuthKey="Apim-Subscription-Id",Lt.ConnectionId="X-ConnectionId",Lt.ContentType="Content-Type",Lt.CustomCommandsAppId="X-CommandsAppId",Lt.Path="Path",Lt.RequestId="X-RequestId",Lt.RequestStreamId="X-StreamId",Lt.RequestTimestamp="X-Timestamp";class Bt extends ht{constructor(e,t,i,n,r,o,s,a){if(!t)throw new w("path");if(!i)throw new w("requestId");const c={};if(c[Lt.Path]=t,c[Lt.RequestId]=i,c[Lt.RequestTimestamp]=(new Date).toISOString(),n&&(c[Lt.ContentType]=n),o&&(c[Lt.RequestStreamId]=o),s)for(const l in s)l&&(c[l]=s[l]);a?super(e,r,c,a):super(e,r,c),this.privPath=t,this.privRequestId=i,this.privContentType=n,this.privStreamId=o,this.privAdditionalHeaders=s}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,i=null,n=null,r=null;const o={};if(e.headers)for(const s in e.headers)s&&(s.toLowerCase()===Lt.Path.toLowerCase()?t=e.headers[s]:s.toLowerCase()===Lt.RequestId.toLowerCase()?i=e.headers[s]:s.toLowerCase()===Lt.ContentType.toLowerCase()?n=e.headers[s]:s.toLowerCase()===Lt.RequestStreamId.toLowerCase()?r=e.headers[s]:o[s]=e.headers[s]);return new Bt(e.messageType,t,i,n,e.body,r,o,e.id)}}var qt=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Ut{constructor(e,t,i,r,o){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new w("authentication");if(!t)throw new w("connectionFactory");if(!i)throw new w("audioSource");if(!r)throw new w("recognizerConfig");this.privEnableSpeakerId=r.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=i,this.privRecognizerConfig=r,this.privIsDisposed=!1,this.privRecognizer=o,this.privRequestSession=new Dt(this.privAudioSource.id()),this.privConnectionEvents=new P,this.privServiceEvents=new P,this.privDynamicGrammar=new zt,this.privSpeechContext=new Nt(this.privDynamicGrammar),this.privAgentConfig=new n;"on"===this.privRecognizerConfig.parameters.getProperty(Ze.WebWorkerLoadType,"on").toLowerCase()&&"undefined"!==typeof Blob&&"undefined"!==typeof Worker?this.privSetTimeout=dt.setTimeout:"undefined"!==typeof window&&(this.privSetTimeout=window.setTimeout.bind(window)),this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;(1003===t.statusCode||1007===t.statusCode||1002===t.statusCode||4e3===t.statusCode||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(Re.Error,1007===t.statusCode?nt.BadRequestParameters:nt.ConnectionFailure,"".concat(t.reason," websocket error code: ").concat(t.statusCode))}})),this.privEnableSpeakerId&&(this.privDiarizationSessionId=C()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){const e=this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages,void 0);if(void 0!==e){const t=e.split(","),i=this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_TranslationVoice,void 0),n=void 0!==i?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:n},output:{interimResults:{mode:"Always"}},targetLanguages:t}),void 0!==i){const e={};for(const n of t)e[n]=i;this.privSpeechContext.setSection("synthesis",{defaultVoices:e})}}}setSpeechSegmentationTimeoutJson(){const e=this.privRecognizerConfig.parameters.getProperty(Ze.Speech_SegmentationSilenceTimeoutMs,void 0);if(void 0!==e){const t=this.recognitionMode===At.Conversation?"CONVERSATION":this.recognitionMode===At.Dictation?"DICTATION":"INTERACTIVE",i=parseInt(e,10),n=this.privSpeechContext.getSection("phraseDetection");n.mode=t,n[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:i}},this.privSpeechContext.setSection("phraseDetection",n)}}setLanguageIdJson(){const e=this.privSpeechContext.getSection("phraseDetection");if(void 0!==this.privRecognizerConfig.autoDetectSourceLanguages){const t=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");let i;i="Continuous"===this.privRecognizerConfig.languageIdMode?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:t,mode:i,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const n=this.privRecognizerConfig.sourceLanguageModels;void 0!==n&&(e.customModels=n,e.onInterim={action:"None"},e.onSuccess={action:"None"})}void 0!==this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages,void 0)&&(e.onInterim={action:"Translate"},e.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",e)}setOutputDetailLevelJson(){if(this.privEnableSpeakerId){if("true"===this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase())this.privSpeechContext.setWordLevelTimings();else{this.privRecognizerConfig.parameters.getProperty(Ge,be[be.Simple]).toLowerCase()===be[be.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat()}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(Ze.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(Ze.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=e}isDisposed(){return this.privIsDisposed}dispose(e){return qt(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privConnectionConfigurationPromise)try{const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}catch(t){return}}))}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,i){return qt(this,void 0,void 0,(function*(){if(void 0!==this.recognizeOverride)return void(yield this.recognizeOverride(e,t,i));this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const n=this.connectImpl();let r;try{const e=yield this.audioSource.attach(this.privRequestSession.audioNodeId),t=yield this.audioSource.format,i=yield this.audioSource.deviceInfo;this.privIsLiveAudio=i.type&&i.type===p.Microphones,r=new ut(e,t.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(r,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:i}}catch(s){throw yield this.privRequestSession.onStopRecognizing(),s}try{yield n}catch(s){return void(yield this.cancelRecognitionLocal(Re.Error,nt.ConnectionFailure,s))}const o=new xe(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,o),this.receiveMessage();this.sendAudio(r).catch((e=>qt(this,void 0,void 0,(function*(){yield this.cancelRecognitionLocal(Re.Error,nt.RuntimeError,e)}))))}))}stopRecognizing(){return qt(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}}))}connect(){return qt(this,void 0,void 0,(function*(){return yield this.connectImpl(),Promise.resolve()}))}connectAsync(e,t){this.connectImpl().then((()=>{try{e&&e()}catch(i){t&&t(i)}}),(e=>{try{t&&t(e)}catch(i){}}))}disconnect(){return qt(this,void 0,void 0,(function*(){if(yield this.cancelRecognitionLocal(Re.Error,nt.NoError,"Disconnecting"),void 0!==this.disconnectOverride&&(yield this.disconnectOverride()),void 0!==this.privConnectionPromise)try{yield(yield this.privConnectionPromise).dispose()}catch(e){}this.privConnectionPromise=void 0}))}sendMessage(e){}sendNetworkMessage(e,t){return qt(this,void 0,void 0,(function*(){const i="string"===typeof t?tt.Text:tt.Binary,n="string"===typeof t?"application/json":"";return(yield this.fetchConnection()).send(new Bt(i,e,this.privRequestSession.requestId,n,t))}))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return qt(this,void 0,void 0,(function*(){const e=this.privRequestSession.getTelemetry();if(!0!==Ut.telemetryDataEnabled||this.privIsDisposed||null===e)return;if(Ut.telemetryData)try{Ut.telemetryData(e)}catch(i){}const t=yield this.fetchConnection();yield t.send(new Bt(tt.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}))}cancelRecognitionLocal(e,t,i){return qt(this,void 0,void 0,(function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,i))}))}receiveMessage(){return qt(this,void 0,void 0,(function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection();const t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(!t)return this.receiveMessage();this.privServiceHasSentMessage=!0;const i=Bt.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const t=Mt.fromJSON(i.textBody),n=new De(t.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,n);break;case"speech.enddetected":let r;r=i.textBody.length>0?i.textBody:"{ Offset: 0 }";const o=Mt.fromJSON(r),s=new De(o.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,s);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(Re.EndOfStream,nt.NoError,void 0));const a=new xe(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,a));e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(i))||this.privServiceEvents&&this.serviceEvents.onEvent(new vt(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch(e){return null}}))}updateSpeakerDiarizationAudioOffset(){const e=this.privRequestSession.recognitionBytesSent/this.privAverageBytesPerMs;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(e)}sendSpeechContext(e,t){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const i=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),i)return e.send(new Bt(tt.Text,"speech.context",this.privRequestSession.requestId,"application/json",i))}noOp(){}sendPrePayloadJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return qt(this,void 0,void 0,(function*(){if(void 0!==this.sendPrePayloadJSONOverride)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)}))}sendWaveHeader(e){return qt(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;return e.send(new Bt(tt.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))}))}connectImpl(){return void 0!==this.privConnectionPromise?this.privConnectionPromise.then((e=>e.state()===it.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()))):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch((()=>{})),void 0!==this.postConnectImplOverride?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,i){if(t.onSpeechContext(),!0!==Ut.telemetryDataEnabled){const e={context:{system:JSON.parse(i).context.system}};i=JSON.stringify(e)}if("true"===this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()){const e=JSON.parse(i);e.context.DisableReferenceChannel="True",e.context.MicSpec="1_0_0",i=JSON.stringify(e)}if(i)return e.send(new Bt(tt.Text,"speech.config",t.requestId,"application/json",i))}fetchConnection(){return qt(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===it.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}sendAudio(e){return qt(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;this.privAverageBytesPerMs=t.avgBytesPerSec/1e3;let i=Date.now();const n=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),r=t.avgBytesPerSec/1e3*parseInt(n,10),o=this.privRequestSession.recogNumber,s=()=>qt(this,void 0,void 0,(function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){const n=yield this.fetchConnection(),a=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let c,l;if(!a||a.isEnd?(c=null,l=0):(c=a.buffer,this.privRequestSession.onAudioSent(c.byteLength),l=r>=this.privRequestSession.bytesSent?0:Math.max(0,i-Date.now())),0!==l&&(yield this.delay(l)),null!==c&&(i=Date.now()+1e3*c.byteLength/(2*t.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){if(n.send(new Bt(tt.Binary,"audio",this.privRequestSession.requestId,null,c)).catch((()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch((()=>{}))})),!(null===a||void 0===a?void 0:a.isEnd))return s();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}}));return s()}))}retryableConnect(){return qt(this,void 0,void 0,(function*(){let e=!1;this.privAuthFetchEventId=C();const t=this.privRequestSession.sessionId;this.privConnectionId=void 0!==t?t:C(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let i=0,n="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),r=yield t;yield this.privRequestSession.onAuthCompleted(!1);const o=this.privConnectionFactory.create(this.privRecognizerConfig,r,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(o.events),o.events.attach((e=>{this.connectionEvents.onEvent(e)}));const s=yield o.open();if(200===s.statusCode)return yield this.privRequestSession.onConnectionEstablishCompleted(s.statusCode),Promise.resolve(o);1006===s.statusCode&&(e=!0),i=s.statusCode,n=s.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(i,n),Promise.reject("Unable to contact server. StatusCode: ".concat(i,", ").concat(this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint)," Reason: ").concat(n))}))}delay(e){return new Promise((t=>this.privSetTimeout(t,e)))}writeBufferToConsole(e){let t="Buffer Size: ";if(null===e)t+="null";else{const i=new Uint8Array(e);t+="".concat(e.byteLength,"\r\n");for(let n=0;n<e.byteLength;n++)t+=i[n].toString(16).padStart(2,"0")+" ",(n+1)%16===0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return qt(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();yield e.send(new Bt(tt.Binary,"audio",this.privRequestSession.requestId,null,null))}))}configureConnection(){return qt(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)}))}}Ut.telemetryDataEnabled=!0;class Ft{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}class Wt{constructor(e){if(!e)throw new w("subscriptionKey");this.privAuthInfo=new Ft(Lt.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}}class Ht{constructor(e,t){if(!e)throw new w("fetchCallback");if(!t)throw new w("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then((e=>new Ft(Lt.Authorization,void 0===e?void 0:Ht.privTokenPrefix+e)))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then((e=>new Ft(Lt.Authorization,void 0===e?void 0:Ht.privTokenPrefix+e)))}}Ht.privTokenPrefix="Bearer ";var jt=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Vt{constructor(e,t,i){this.audioConfig=void 0!==e?e:Te.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=i,this.implCommonRecognizerSetup()}close(e,t){te.throwIfDisposed(this.privDisposed),k(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return jt(this,void 0,void 0,(function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))}))}static get telemetryEnabled(){return Ut.telemetryDataEnabled}static enableTelemetry(e){Ut.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!==typeof window?"Browser":"Node",t="unknown",i="unknown";"undefined"!==typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);const n=this.createRecognizerConfig(new s(new a(new l(e,t,i))));this.privReco=this.createServiceRecognizer(Vt.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,n)}recognizeOnceAsyncImpl(e){return jt(this,void 0,void 0,(function*(){te.throwIfDisposed(this.privDisposed);const t=new T;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);const i=yield t.promise;return yield this.implRecognizerStop(),i}))}startContinuousRecognitionAsyncImpl(e){return jt(this,void 0,void 0,(function*(){te.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)}))}stopContinuousRecognitionAsyncImpl(){return jt(this,void 0,void 0,(function*(){te.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()}))}implRecognizerStop(){return jt(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}static getAuthFromProperties(e){const t=e.getProperty(Ze.SpeechServiceConnection_Key,void 0);return t&&""!==t?new Wt(t):new Ht((()=>{const t=e.getProperty(Ze.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}),(()=>{const t=e.getProperty(Ze.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}))}}var Kt=i(151),Jt=i(270),Gt=i(916),Qt=i(104),$t=i(914);class Yt{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}class Xt{constructor(e,t,i){if(this.privPayload=null,!t)throw new w("payload");if(e===tt.Binary&&"ArrayBuffer"!==t.__proto__.constructor.name)throw new R("Payload must be ArrayBuffer");if(e===tt.Text&&"string"!==typeof t)throw new R("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=i||C()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===tt.Binary)throw new R("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===tt.Text)throw new R("Not supported for text message");return this.privPayload}get id(){return this.privId}}var Zt=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class ei{constructor(e,t,i,n,r,o){if(!e)throw new w("uri");if(!i)throw new w("messageFormatter");this.proxyInfo=n,this.privConnectionEvents=new P,this.privConnectionId=t,this.privMessageFormatter=i,this.privConnectionState=it.None,this.privUri=e,this.privHeaders=r,this.privEnableCompression=o,this.privHeaders[Lt.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===it.Disconnected)return Promise.reject("Cannot open a connection that is in ".concat(this.privConnectionState," state"));if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new T,this.privCertificateValidatedDeferral=new T,this.privConnectionState=it.Connecting;try{if("undefined"===typeof WebSocket||ei.forceNpmWebSocket){const e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let t=new URL(this.privUri).protocol;"wss:"===(null===t||void 0===t?void 0:t.toLocaleLowerCase())?t="https:":"ws:"===(null===t||void 0===t?void 0:t.toLocaleLowerCase())&&(t="http:"),e.agent.protocol=t,this.privWebsocketClient=new $t(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new H,this.privDisconnectDeferral=new T,this.privSendMessageQueue=new H,this.processSendQueue().catch((e=>{G.instance.onEvent(new ue(e))}))}catch(e){return this.privConnectionEstablishDeferral.resolve(new Yt(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new gt(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then((()=>{this.privConnectionState=it.Connected,this.onEvent(new mt(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new Yt(200,""))}),(e=>{this.privConnectionEstablishDeferral.reject(e)}))},this.privWebsocketClient.onerror=e=>{this.onEvent(new St(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===it.Connecting?(this.privConnectionState=it.Disconnected,this.privConnectionEstablishDeferral.resolve(new Yt(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=it.Disconnected,this.privWebsocketClient=null,this.onEvent(new yt(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch((e=>{G.instance.onEvent(new ue(e))}))},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===it.Connected){const i=new T;if(this.privReceivingMessageQueue.enqueueFromPromise(i.promise),e.data instanceof ArrayBuffer){const n=new Xt(tt.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).then((e=>{this.onEvent(new wt(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject("Invalid binary message format. Error: ".concat(e))}))}else{const n=new Xt(tt.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).then((e=>{this.onEvent(new wt(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject("Invalid text message format. Error: ".concat(e))}))}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==it.Connected)return Promise.reject("Cannot send on connection that is in ".concat(it[this.privConnectionState]," state"));const t=new T,i=new T;return this.privSendMessageQueue.enqueueFromPromise(i.promise),this.privMessageFormatter.fromConnectionMessage(e).then((n=>{i.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})}),(e=>{i.reject("Error formatting the message. ".concat(e))})),t.promise}read(){return this.privConnectionState!==it.Connected?Promise.reject("Cannot read on connection that is in ".concat(this.privConnectionState," state")):this.privReceivingMessageQueue.dequeue()}close(e){return this.privWebsocketClient?(this.privConnectionState!==it.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(e){try{return e?(this.onEvent(new Rt(this.privConnectionId,(new Date).toISOString(),e.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(e.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+(new Error).stack)):Promise.resolve()}catch(t){return Promise.reject("websocket send error: ".concat(t))}}onClose(e,t){return Zt(this,void 0,void 0,(function*(){const i="Connection closed. ".concat(e,": ").concat(t);this.privConnectionState=it.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose((()=>{}),i),yield this.privSendMessageQueue.drainAndDispose((e=>{e.sendStatusDeferral.reject(i)}),i)}))}processSendQueue(){return Zt(this,void 0,void 0,(function*(){for(;;){const t=this.privSendMessageQueue.dequeue(),i=yield t;if(!i)return;try{yield this.sendRawMessage(i),i.sendStatusDeferral.resolve()}catch(e){i.sendStatusDeferral.reject(e)}}}))}onEvent(e){this.privConnectionEvents.onEvent(e),G.instance.onEvent(e)}getAgent(){const e=new Gt.Agent(this.createConnection);return void 0!==this.proxyInfo&&void 0!==this.proxyInfo.HostName&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){const t={host:e.HostName,port:e.Port};e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer("".concat(e.UserName,":").concat(void 0===e.Password?"":e.Password)).toString("base64")}:t.headers={},t.headers.requestOCSP="true";return new Qt(t)}createConnection(e,t){let i;if(t=Object.assign(Object.assign({},t),{requestOCSP:!0,servername:t.host}),this.proxyInfo){const n=ei.GetProxyAgent(this.proxyInfo);i=new Promise(((i,r)=>{n.callback(e,t,((e,t)=>{e?r(e):i(t)}))}))}else i=t.secureEndpoint?Promise.resolve(Jt.connect(t)):Promise.resolve(Kt.connect(t));return i}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}ei.forceNpmWebSocket=!1;var ti=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class ii{constructor(e,t,i,n,r){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6?arguments[6]:void 0;if(this.privIsDisposed=!1,!e)throw new w("uri");if(!n)throw new w("messageFormatter");this.privMessageFormatter=n;let a="",c=0;if(t)for(const l in t)if(l){a+=0===c&&-1===e.indexOf("?")?"?":"&";a+=encodeURIComponent(l);let i=t[l];i&&(i=encodeURIComponent(i),a+="=".concat(i)),c++}if(i)for(const l in i)if(l){a+=0===c&&-1===e.indexOf("?")?"?":"&";const t=encodeURIComponent(i[l]);a+="".concat(l,"=").concat(t),c++}this.privUri=e+a,this.privId=s||C(),this.privConnectionMessageAdapter=new ei(this.privUri,this.id,this.privMessageFormatter,r,i,o)}dispose(){return ti(this,void 0,void 0,(function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())}))}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}class ni{constructor(e,t,i,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=i,this.privProxyPassword=n}static fromParameters(e){return new ni(e.getProperty(Ze.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(Ze.SpeechServiceConnection_ProxyPort),10),e.getProperty(Ze.SpeechServiceConnection_ProxyUserName),e.getProperty(Ze.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}class ri{}ri.BotId="botid",ri.CustomSpeechDeploymentId="cid",ri.CustomVoiceDeploymentId="deploymentId",ri.EnableAudioLogging="storeAudio",ri.EnableLanguageId="lidEnabled",ri.EnableWordLevelTimestamps="wordLevelTimestamps",ri.EndSilenceTimeoutMs="endSilenceTimeoutMs",ri.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",ri.Format="format",ri.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",ri.Language="language",ri.Profanity="profanity",ri.RequestBotStatusMessages="enableBotMessageStatus",ri.StableIntermediateThreshold="stableIntermediateThreshold",ri.StableTranslation="stableTranslation",ri.TestHooks="testhooks",ri.Postprocessing="postprocessing",ri.CtsMeetingId="meetingId",ri.CtsDeviceId="deviceId",ri.CtsIsParticipant="isParticipant",ri.EnableAvatar="enableTalkingAvatar";class oi{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,i){new Map([[Ze.Speech_SegmentationSilenceTimeoutMs,ri.SegmentationSilenceTimeoutMs],[Ze.SpeechServiceConnection_EnableAudioLogging,ri.EnableAudioLogging],[Ze.SpeechServiceConnection_EndSilenceTimeoutMs,ri.EndSilenceTimeoutMs],[Ze.SpeechServiceConnection_InitialSilenceTimeoutMs,ri.InitialSilenceTimeoutMs],[Ze.SpeechServiceResponse_PostProcessingOption,ri.Postprocessing],[Ze.SpeechServiceResponse_ProfanityOption,ri.Profanity],[Ze.SpeechServiceResponse_RequestWordLevelTimestamps,ri.EnableWordLevelTimestamps],[Ze.SpeechServiceResponse_StablePartialResultThreshold,ri.StableIntermediateThreshold]]).forEach(((n,r)=>{this.setUrlParameter(r,n,e,t,i)}));const n=JSON.parse(e.parameters.getProperty($e,"{}"));Object.keys(n).forEach((e=>{t[e]=n[e]}))}setUrlParameter(e,t,i,n,r){const o=i.parameters.getProperty(e,void 0);!o||r&&-1!==r.search(t)||(n[t]=o.toLocaleLowerCase())}}class si{toConnectionMessage(e){const t=new T;try{if(e.messageType===tt.Text){const i=e.textContent;let n={},r=null;if(i){const e=i.split("\r\n\r\n");e&&e.length>0&&(n=this.parseHeaders(e[0]),e.length>1&&(r=e[1]))}t.resolve(new ht(e.messageType,r,n,e.id))}else if(e.messageType===tt.Binary){const i=e.binaryContent;let n={},r=null;if(!i||i.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const o=new DataView(i),s=o.getInt16(0);if(i.byteLength<s+2)throw new Error("Invalid binary message format. Header content missing.");let a="";for(let e=0;e<s;e++)a+=String.fromCharCode(o.getInt8(e+2));n=this.parseHeaders(a),i.byteLength>s+2&&(r=i.slice(2+s)),t.resolve(new ht(e.messageType,r,n,e.id))}}catch(i){t.reject("Error formatting the message. Error: ".concat(i))}return t.promise}fromConnectionMessage(e){const t=new T;try{if(e.messageType===tt.Text){const i="".concat(this.makeHeaders(e)).concat("\r\n").concat(e.textBody?e.textBody:"");t.resolve(new Xt(tt.Text,i,e.id))}else if(e.messageType===tt.Binary){const i=this.makeHeaders(e),n=e.binaryBody,r=this.stringToArrayBuffer(i),o=new Int8Array(r),s=o.byteLength,a=new Int8Array(2+s+(n?n.byteLength:0));if(a[0]=s>>8&255,a[1]=255&s,a.set(o,2),n){const e=new Int8Array(n);a.set(e,2+s)}const c=a.buffer;t.resolve(new Xt(tt.Binary,c,e.id))}}catch(i){t.reject("Error formatting the message. ".concat(i))}return t.promise}makeHeaders(e){let t="";if(e.headers)for(const i in e.headers)i&&(t+="".concat(i,": ").concat(e.headers[i]).concat("\r\n"));return t}parseHeaders(e){const t={};if(e){const i=e.match(/[^\r\n]+/g);if(t)for(const e of i)if(e){const i=e.indexOf(":"),n=i>0?e.substr(0,i).trim().toLowerCase():e,r=i>0&&e.length>i+1?e.substr(i+1).trim():"";t[n]=r}}return t}stringToArrayBuffer(e){const t=new ArrayBuffer(e.length),i=new DataView(t);for(let n=0;n<e.length;n++)i.setUint8(n,e.charCodeAt(n));return t}}class ai extends oi{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,i){let n=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);const r=e.parameters.getProperty(Ze.SpeechServiceConnection_Region,void 0),o=oi.getHostSuffix(r),s=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://"+r+".stt.speech"+o),a={},c=e.parameters.getProperty(Ze.SpeechServiceConnection_EndpointId,void 0),l=e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,void 0);if(c?n&&-1!==n.search(ri.CustomSpeechDeploymentId)||(a[ri.CustomSpeechDeploymentId]=c):l&&(n&&-1!==n.search(ri.Language)||(a[ri.Language]=l)),n&&-1!==n.search(ri.Format)||(a[ri.Format]=e.parameters.getProperty(Ge,be[be.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(a[ri.EnableLanguageId]="true"),this.setCommonUrlParams(e,a,n),!n)switch(e.recognitionMode){case At.Conversation:n="true"===e.parameters.getProperty(Ye,"false")?s+this.dictationRelativeUri:void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?"".concat(s).concat(this.universalUri).concat(e.recognitionEndpointVersion):s+this.conversationRelativeUri;break;case At.Dictation:n=s+this.dictationRelativeUri;break;default:n=void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?"".concat(s).concat(this.universalUri).concat(e.recognitionEndpointVersion):s+this.interactiveRelativeUri}const u={};void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u[Lt.ConnectionId]=i;const p="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),d=new ii(n,a,u,new si,ni.fromRecognizerConfig(e),p,i),h=d.uri;return e.parameters.setProperty(Ze.SpeechServiceConnection_Url,h),d}}class ci{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new ci(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}var li,ui;!function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(li||(li={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"}(ui||(ui={}));class pi{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=ui[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new pi(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}class di{static implTranslateRecognitionResult(e){let t=Pe.Canceled;switch(e){case ui.Success:t=Pe.RecognizedSpeech;break;case ui.NoMatch:case ui.InitialSilenceTimeout:case ui.BabbleTimeout:case ui.EndOfDictation:t=Pe.NoMatch;break;case ui.Error:case ui.BadRequest:case ui.Forbidden:default:t=Pe.Canceled}return t}static implTranslateCancelResult(e){let t=Re.EndOfStream;switch(e){case ui.Success:case ui.EndOfDictation:case ui.NoMatch:t=Re.EndOfStream;break;case ui.InitialSilenceTimeout:case ui.BabbleTimeout:case ui.Error:case ui.BadRequest:case ui.Forbidden:default:t=Re.Error}return t}static implTranslateCancelErrorCode(e){let t=nt.NoError;switch(e){case ui.Error:t=nt.ServiceError;break;case ui.TooManyRequests:t=nt.TooManyRequests;break;case ui.BadRequest:t=nt.BadRequestParameters;break;case ui.Forbidden:t=nt.Forbidden;break;default:t=nt.NoError}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case nt.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case nt.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case nt.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return t}}class hi{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=ui[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new hi(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(const e of this.privDetailedSpeechPhrase.NBest)if(e.Words&&e.Words[0]){t=e.Words[0].Offset;break}if(t&&t<e){const i=e-t;for(const e of this.privDetailedSpeechPhrase.NBest){if(e.Words)for(const t of e.Words)t.Offset+=i;if(e.DisplayWords)for(const t of e.DisplayWords)t.Offset+=i}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}var vi=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class fi extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privSpeechRecognizer=r}processTypeSpecificMessages(e){return vi(this,void 0,void 0,(function*(){let t;const i=new ot;i.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const s=ci.fromJSON(e.textBody),a=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new _e(this.privRequestSession.requestId,Pe.RecognizingSpeech,s.Text,s.Duration,a,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(a);const c=new qe(t,s.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch(r){}n=!0;break;case"speech.phrase":const l=pi.fromJSON(e.textBody),u=di.implTranslateRecognitionResult(l.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+l.Offset+l.Duration),Pe.Canceled===u){const e=di.implTranslateCancelResult(l.RecognitionStatus),t=di.implTranslateCancelErrorCode(l.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,di.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||u!==Pe.NoMatch||l.RecognitionStatus===ui.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(Ge)===be[be.Simple])t=new _e(this.privRequestSession.requestId,u,l.DisplayText,l.Duration,l.Offset+this.privRequestSession.currentTurnAudioOffset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,e.textBody,i);else{const n=hi.fromJSON(e.textBody),r=n.Offset+this.privRequestSession.currentTurnAudioOffset,o=n.getJsonWithCorrectedOffsets(r);t=new _e(this.privRequestSession.requestId,u,n.RecognitionStatus===ui.Success?n.NBest[0].Display:void 0,n.Duration,r,n.Language,n.LanguageDetectionConfidence,void 0,void 0,o,i)}const n=new qe(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,n)}catch(r){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0}return n}))}cancelRecognition(e,t,i,n,r){const o=new ot;if(o.setProperty(Qe,nt[n]),this.privSpeechRecognizer.canceled){const t=new He(i,r,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(s){}}if(this.privSuccessCallback){const e=new _e(t,Pe.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,r,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(a){}}}}var gi=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class mi extends Vt{constructor(e,t){const i=e;te.throwIfNull(i,"speechConfig"),te.throwIfNullOrWhitespace(i.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage),Ze[Ze.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new ai),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){const n=e;t.properties.mergeTo(n.properties);return new mi(e,i)}get endpointId(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ge,be[be.Simple])===be[be.Simple]?be.Simple:be.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){k(this.recognizeOnceAsyncImpl(At.Interactive),e,t)}startContinuousRecognitionAsync(e,t){k(this.startContinuousRecognitionAsyncImpl(At.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){k(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){te.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){te.throwIfDisposed(this.privDisposedRecognizer),k(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return gi(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new fi(e,t,i,n,this)}}class yi extends oi{create(e,t,i){let n=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint);if(!n){const t=e.parameters.getProperty(Ze.SpeechServiceConnection_IntentRegion),i=oi.getHostSuffix(t);n=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://"+t+".sr.speech"+i)+"/speech/recognition/interactive/cognitiveservices/v1"}const r={format:"simple",language:e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,r,n);const o={};void 0!==t.token&&""!==t.token&&(o[t.headerName]=t.token),o[Lt.ConnectionId]=i,e.parameters.setProperty(Ze.SpeechServiceConnection_Url,n);const s="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(n,r,o,new si,ni.fromRecognizerConfig(e),s,i)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}}class Si{constructor(e,t){this.modelImpl=e,this.intentName=t}}class Ci extends ze{constructor(e,t,i,n,r,o){super(n,r,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class wi{constructor(e){this.privIntentResponse=""===e?{}:JSON.parse(e)}static fromJSON(e){return new wi(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}class Ri extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privIntentRecognizer=r,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,i,n=!1;const r=new ot;switch(e.messageType===tt.Text&&r.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":const o=ci.fromJSON(e.textBody);if(t=new Me(void 0,this.privRequestSession.requestId,Pe.RecognizingIntent,o.Text,o.Duration,o.Offset+this.privRequestSession.currentTurnAudioOffset,o.Language,o.LanguageDetectionConfidence,void 0,e.textBody,r),this.privRequestSession.onHypothesis(t.offset),i=new ze(t,o.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch(s){}n=!0;break;case"speech.phrase":const c=pi.fromJSON(e.textBody);t=new Me(void 0,this.privRequestSession.requestId,di.implTranslateRecognitionResult(c.RecognitionStatus),c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,e.textBody,r),i=new ze(t,t.offset,this.privRequestSession.sessionId);const l=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(s){}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};!1===this.privIntentDataSent||Pe.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),l()):this.privPendingIntentArgs=i,n=!0;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===i){if(""===e.textBody)return;i=new ze(new Me,0,this.privRequestSession.sessionId)}const u=wi.fromJSON(e.textBody);if(null!==u&&u.topScoringIntent&&u.topScoringIntent.intent){let t=this.privAddedLmIntents[u.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(t=this.privUmbrellaIntent),t){const n=void 0===t||void 0===t.intentName?u.topScoringIntent.intent:t.intentName;let r=i.result.reason;void 0!==n&&(r=Pe.RecognizedIntent);const o=void 0!==i.result.properties?i.result.properties:new ot;o.setProperty(Ze.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),i=new ze(new Me(n,i.result.resultId,r,i.result.text,i.result.duration,i.result.offset,void 0,void 0,i.result.errorDetails,i.result.json,o),i.offset,i.sessionId)}}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(s){}if(this.privSuccessCallback){try{this.privSuccessCallback(i.result)}catch(a){this.privErrorCallback&&this.privErrorCallback(a)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}n=!0}const o=new T;return o.resolve(n),o.promise}cancelRecognition(e,t,i,n,r){const o=new ot;if(o.setProperty(Qe,nt[n]),this.privIntentRecognizer.canceled){const t=new Ci(i,r,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,t)}catch(s){}}if(this.privSuccessCallback){const e=new Me(void 0,t,Pe.Canceled,void 0,void 0,void 0,void 0,void 0,r,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(a){}}}}var bi,Pi,Ii=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Ei extends Vt{constructor(e,t){te.throwIfNullOrUndefined(e,"speechConfig");const i=e;te.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new yi),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=i.properties,te.throwIfNullOrWhitespace(this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage),Ze[Ze.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(te.throwIfDisposed(this.privDisposedIntentRecognizer),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars);this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}k(this.recognizeOnceAsyncImpl(At.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars);this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}k(this.startContinuousRecognitionAsyncImpl(At.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){k(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){te.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(i){t&&t(i)}}addIntent(e,t){te.throwIfDisposed(this.privDisposedIntentRecognizer),te.throwIfNullOrWhitespace(t,"intentId"),te.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,i){te.throwIfDisposed(this.privDisposedIntentRecognizer),te.throwIfNullOrWhitespace(e,"intentId"),te.throwIfNull(t,"model");const n=t;te.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new Si(n,i)}addAllIntents(e,t){te.throwIfNull(e,"model");const i=e;te.throwIfNullOrWhitespace(i.appId,"model.appId"),this.privUmbrellaIntent=new Si(i,t)}close(e,t){te.throwIfDisposed(this.privDisposedIntentRecognizer),k(this.dispose(!0),e,t)}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new Ri(e,t,i,n,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Ii(this,void 0,void 0,(function*(){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,yield t.dispose.call(this,e))}))}buildSpeechContext(){let e,t,i;const n=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,i=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const r of Object.keys(this.privAddedLmIntents)){const o=this.privAddedLmIntents[r];if(void 0===e)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===i)i=o.modelImpl.subscriptionKey;else if(i!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const s="luis/"+e+"-PRODUCTION#"+r;n.push(s)}return{Intent:{id:e,key:void 0===i?this.privProperties.getProperty(Ze[Ze.SpeechServiceConnection_Key]):i,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?n:["luis/"+e+"-PRODUCTION"]}}}!function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(bi||(bi={}));class Ti{static formatString(e,t){if(!e)return"";if(!t)return e;let i="",n="";const r=e=>{i+=e},o=e=>{n+=e};let s=r;for(let a=0;a<e.length;a++){const c=e[a],l=a+1<e.length?e[a+1]:"";switch(c){case"{":"{"===l?(s("{"),a++):s=o;break;case"}":"}"===l?(s("}"),a++):(t.hasOwnProperty(n)&&(i+=t[n]),s=r,n="");break;default:s(c)}}return i}}class ki extends oi{create(e,t,i){const n=this.getEndpointUrl(e),r={};void 0!==e.autoDetectSourceLanguages&&(r[ri.EnableLanguageId]="true"),this.setQueryParams(r,e,n);const o={};void 0!==t.token&&""!==t.token&&(o[t.headerName]=t.token),o[Lt.ConnectionId]=i,e.parameters.setProperty(Ze.SpeechServiceConnection_Url,n);const s="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(n,r,o,new si,ni.fromRecognizerConfig(e),s,i)}getEndpointUrl(e,t){const i=e.parameters.getProperty(Ze.SpeechServiceConnection_Region),n=oi.getHostSuffix(i);let r=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);if(!r)if(void 0!==e.autoDetectSourceLanguages){r=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+n)+"/speech/universal/v2"}else{r=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+n)+"/speech/translation/cognitiveservices/v1"}return!0===t?r:Ti.formatString(r,{region:i})}setQueryParams(e,t,i){e.from=t.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages),e.scenario=t.recognitionMode===At.Interactive?"interactive":t.recognitionMode===At.Conversation?"conversation":"",this.setCommonUrlParams(t,e,i),this.setUrlParameter(Ze.SpeechServiceResponse_TranslationRequestStablePartialResult,ri.StableTranslation,t,e,i);const n=t.parameters.getProperty(Ze.SpeechServiceConnection_TranslationVoice,void 0);void 0!==n&&(e.voice=n,e.features="texttospeech")}}!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(Pi||(Pi={}));class Ai{constructor(e,t,i,n,r){this.privCancelReason=t,this.privErrorDetails=i,this.privResult=r,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class Oi{constructor(){this.privMap=new ot}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}}var xi=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Di extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.handleSpeechPhraseMessage=e=>xi(this,void 0,void 0,(function*(){return this.handleSpeechPhrase(e)})),this.handleSpeechHypothesisMessage=e=>this.handleSpeechHypothesis(e)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,i){}handleRecognizingCallback(e,t,i){}processSpeechMessages(e){return xi(this,void 0,void 0,(function*(){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&(yield this.handleSpeechPhraseMessage(e.textBody)),t=!0}return t}))}cancelRecognition(e,t,i,n,r){}handleSpeechPhrase(e){return xi(this,void 0,void 0,(function*(){const t=pi.fromJSON(e),i=di.implTranslateRecognitionResult(t.RecognitionStatus);let n;const r=new ot;r.setProperty(Ze.SpeechServiceResponse_JsonResult,e);const o=t.Offset+this.privRequestSession.currentTurnAudioOffset;let s=o;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),Pe.Canceled===i){const e=di.implTranslateCancelResult(t.RecognitionStatus),i=di.implTranslateCancelErrorCode(t.RecognitionStatus);yield this.cancelRecognitionLocal(e,i,di.implTranslateErrorDetails(i))}else if(!this.privRequestSession.isSpeechEnded||i!==Pe.NoMatch||t.RecognitionStatus===ui.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(Ge)===be[be.Simple])n=new _e(this.privRequestSession.requestId,i,t.DisplayText,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,r);else{const t=hi.fromJSON(e),o=t.Offset+this.privRequestSession.currentTurnAudioOffset,a=t.getJsonWithCorrectedOffsets(o);n=new _e(this.privRequestSession.requestId,i,t.Text,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,a,r),s=n.offset}this.handleRecognizedCallback(n,s,this.privRequestSession.sessionId)}}))}handleSpeechHypothesis(e){const t=ci.fromJSON(e),i=t.Offset+this.privRequestSession.currentTurnAudioOffset,n=new ot;n.setProperty(Ze.SpeechServiceResponse_JsonResult,e);const r=new _e(this.privRequestSession.requestId,Pe.RecognizingSpeech,t.Text,t.Duration,i,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,n);this.privRequestSession.onHypothesis(i),this.handleRecognizingCallback(r,t.Duration,this.privRequestSession.sessionId)}}class zi{constructor(e){this.privTranslationHypothesis=e,this.privTranslationHypothesis.Translation.TranslationStatus=Pi[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new zi(JSON.parse(e))}static fromTranslationResponse(e){te.throwIfNullOrUndefined(e,"translationHypothesis");const t=e.SpeechHypothesis;return e.SpeechHypothesis=void 0,t.Translation=e,new zi(t)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var e;return null===(e=this.privTranslationHypothesis.PrimaryLanguage)||void 0===e?void 0:e.Language}}class Ni{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=ui[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=Pi[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new Ni(JSON.parse(e))}static fromTranslationResponse(e){te.throwIfNullOrUndefined(e,"translationResponse");const t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new Ni(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Language}get Confidence(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Confidence}get Translation(){return this.privTranslationPhrase.Translation}}class _i{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=li[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=li[this.privSynthesisEnd.Status])}static fromJSON(e){return new _i(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}var Mi,Li=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Bi extends Di{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privTranslationRecognizer=r,this.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name&&this.privTranslationRecognizer.onConnection()}))}processTypeSpecificMessages(e){return Li(this,void 0,void 0,(function*(){const t=new ot;let i=yield this.processSpeechMessages(e);if(i)return!0;const n=n=>Li(this,void 0,void 0,(function*(){if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+n.Offset+n.Duration),n.RecognitionStatus===ui.Success){const e=this.fireEventForResult(n,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(r){}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const s=di.implTranslateRecognitionResult(n.RecognitionStatus),a=new Ke(void 0,this.privRequestSession.requestId,s,n.Text,n.Duration,this.privRequestSession.currentTurnAudioOffset+n.Offset,n.Language,n.Confidence,void 0,e.textBody,t);if(s===Pe.Canceled){const e=di.implTranslateCancelResult(n.RecognitionStatus),t=di.implTranslateCancelErrorCode(n.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,di.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||s!==Pe.NoMatch||n.RecognitionStatus===ui.InitialSilenceTimeout){const e=new je(a,a.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(r){}}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0}})),r=(e,t)=>{const n=this.fireEventForResult(e,t);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+n.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch(r){}i=!0};switch(e.messageType===tt.Text&&t.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":r(zi.fromJSON(e.textBody),t);break;case"translation.response":const s=JSON.parse(e.textBody);if(s.SpeechPhrase)yield n(Ni.fromTranslationResponse(s));else{const i=JSON.parse(e.textBody);i.SpeechHypothesis&&r(zi.fromTranslationResponse(i),t)}break;case"translation.phrase":yield n(Ni.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),i=!0;break;case"audio.end":case"translation.synthesis.end":const a=_i.fromJSON(e.textBody);switch(a.SynthesisStatus){case li.Error:if(this.privTranslationRecognizer.synthesizing){const e=new Je(Pe.Canceled,void 0),t=new Ve(e,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,t)}catch(o){}}if(this.privTranslationRecognizer.canceled){const e=new Ai(this.privRequestSession.sessionId,Re.Error,a.FailureReason,nt.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,e)}catch(o){}}break;case li.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}i=!0}return i}))}cancelRecognition(e,t,i,n,r){const o=new ot;if(o.setProperty(Qe,nt[n]),this.privTranslationRecognizer.canceled){const t=new Ai(e,i,r,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,t)}catch(s){}}if(this.privSuccessCallback){const e=new Ke(void 0,t,Pe.Canceled,void 0,void 0,void 0,void 0,void 0,r,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(a){}}}handleRecognizingCallback(e,t,i){try{const n=new je(Ke.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch(n){}}handleRecognizedCallback(e,t,i){try{const n=new je(Ke.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,n)}catch(n){}}fireEventForResult(e,t){let i,n,r;if(void 0!==e.Translation.Translations){i=new Oi;for(const t of e.Translation.Translations)i.set(t.Language,t.Text||t.DisplayText)}e instanceof Ni?(n=e.Translation&&e.Translation.TranslationStatus===Pi.Success?Pe.TranslatedSpeech:Pe.RecognizedSpeech,r=e.Confidence):n=Pe.TranslatingSpeech;const o=e.Language,s=e.Offset+this.privRequestSession.currentTurnAudioOffset,a=new Ke(i,this.privRequestSession.requestId,n,e.Text,e.Duration,s,o,r,e.Translation.FailureReason,JSON.stringify(e),t);return new je(a,s,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){const i=void 0===e?Pe.SynthesizingAudioCompleted:Pe.SynthesizingAudio,n=new Je(i,e),r=new Ve(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,r)}catch(o){}}}class qi{constructor(e,t,i,n){this.privResultId=e,this.privReason=t,this.privErrorDetails=i,this.privProperties=n}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}class Ui extends qi{constructor(e,t,i,n,r,o){super(e,t,n,r),this.privAudioData=i,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}class Fi{constructor(e,t,i,n,r,o){this.privAudioOffset=e,this.privDuration=t,this.privText=i,this.privWordLength=n,this.privTextOffset=r,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}class Wi{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}class Hi{constructor(e,t,i){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}!function(e){e.WordBoundary="WordBoundary",e.Bookmark="Bookmark",e.Viseme="Viseme",e.SentenceBoundary="SentenceBoundary",e.SessionEnd="SessionEnd",e.AvatarSignal="TalkingAvatarSignal"}(Mi||(Mi={}));class ji{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new ji(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}class Vi extends A{constructor(e,t){super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.Info),this.privRequestId=t}get requestId(){return this.privRequestId}}class Ki extends Vi{constructor(e,t,i){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=i}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class Ji extends Vi{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class Gi extends Vi{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}var Qi=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class $i{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=C(),this.privTurnDeferral=new T,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const e=new ot;return e.setProperty(Ze.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),e}}getAllReceivedAudio(){return Qi(this,void 0,void 0,(function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}))}getAllReceivedAudioWithHeader(){return Qi(this,void 0,void 0,(function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(e),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}))}startNewSynthesis(e,t,i,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=i,this.privAudioOutputStream=new fe,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",void 0!==n&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new Ki(this.requestId,void 0,void 0===n?void 0:n.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new Ji(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(200===e)return this.onEvent(new Gi(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===e&&this.onComplete()}onServiceResponseMessage(e){const t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(e){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new T;const t=JSON.parse(e);t.webrtc&&(this.privWebRTCSDP=t.webrtc.connectionString)}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){void 0!==e.Data.AnimationChunk&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}constructSynthesisResult(){return Qi(this,void 0,void 0,(function*(){const e=yield this.getAllReceivedAudioWithHeader();return new Ui(this.requestId,Pe.SynthesizingAudioCompleted,e,void 0,this.extraProperties,this.audioDuration)}))}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){G.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&"<"===e[0]&&">"===e[e.length-1]}updateTextOffset(e,t){t===Mi.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!$i.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!$i.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return Qi(this,void 0,void 0,(function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}}))}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}}class Yi{constructor(){this.privContext={}}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(e){const t=this.buildSynthesisContext(e);this.setSection("synthesis",t)}buildSynthesisContext(e){return{audio:{metadataOptions:{bookmarkEnabled:!!(null===e||void 0===e?void 0:e.bookmarkReached),punctuationBoundaryEnabled:null===e||void 0===e?void 0:e.properties.getProperty(Ze.SpeechServiceResponse_RequestPunctuationBoundary,!!(null===e||void 0===e?void 0:e.wordBoundary)),sentenceBoundaryEnabled:null===e||void 0===e?void 0:e.properties.getProperty(Ze.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(null===e||void 0===e?void 0:e.visemeReceived),wordBoundaryEnabled:null===e||void 0===e?void 0:e.properties.getProperty(Ze.SpeechServiceResponse_RequestWordBoundary,!!(null===e||void 0===e?void 0:e.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:null===e||void 0===e?void 0:e.autoDetectSourceLanguage}}}}var Xi=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Zi{constructor(e,t,i,r){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new w("authentication");if(!t)throw new w("connectionFactory");if(!i)throw new w("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=i,this.privIsDisposed=!1,this.privSessionAudioDestination=r,this.privSynthesisTurn=new $i,this.privConnectionEvents=new P,this.privServiceEvents=new P,this.privSynthesisContext=new Yi,this.privAgentConfig=new n,this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;1e3!==t.statusCode&&this.cancelSynthesisLocal(Re.Error,1007===t.statusCode?nt.BadRequestParameters:nt.ConnectionFailure,"".concat(t.reason," websocket error code: ").concat(t.statusCode))}}))}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)}isDisposed(){return this.privIsDisposed}dispose(e){return Xi(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),void 0!==this.privConnectionConfigurationPromise){const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}}))}connect(){return Xi(this,void 0,void 0,(function*(){yield this.connectImpl()}))}sendNetworkMessage(e,t){return Xi(this,void 0,void 0,(function*(){const i="string"===typeof t?tt.Text:tt.Binary,n="string"===typeof t?"application/json":"";return(yield this.fetchConnection()).send(new Bt(i,e,this.privSynthesisTurn.requestId,n,t))}))}Speak(e,t,i,n,r,o){return Xi(this,void 0,void 0,(function*(){let s;if(s=t?e:this.privSynthesizer.buildSsml(e),void 0!==this.speakOverride)return this.speakOverride(s,i,n,r);this.privSuccessCallback=n,this.privErrorCallback=r,this.privSynthesisTurn.startNewSynthesis(i,e,t,o);try{yield this.connectImpl();const e=yield this.fetchConnection();yield this.sendSynthesisContext(e),yield this.sendSsmlMessage(e,s,i),this.onSynthesisStarted(i),this.receiveMessage()}catch(a){return this.cancelSynthesisLocal(Re.Error,nt.ConnectionFailure,a),Promise.reject(a)}}))}stopSpeaking(){return Xi(this,void 0,void 0,(function*(){yield this.connectImpl();return(yield this.fetchConnection()).send(new Bt(tt.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}))}cancelSynthesis(e,t,i,n){const r=new ot;r.setProperty(Qe,nt[i]);const o=new Ui(e,Pe.Canceled,void 0,n,r);if(this.onSynthesisCancelled(o),this.privSuccessCallback)try{this.privSuccessCallback(o)}catch(s){}}cancelSynthesisLocal(e,t,i){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,i))}processTypeSpecificMessages(e){return!0}receiveMessage(){return Xi(this,void 0,void 0,(function*(){try{const t=yield this.fetchConnection(),i=yield t.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!i)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const n=Bt.fromConnectionMessage(i);if(n.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(n.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(n.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(n.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===n.streamId.toLowerCase()&&n.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(n.binaryBody),this.onSynthesizing(n.binaryBody),void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(n.binaryBody));break;case"audio.metadata":const t=ji.fromJSON(n.textBody).Metadata;for(const e of t)switch(e.Type){case Mi.WordBoundary:case Mi.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(e);const t=new Fi(e.Data.Offset,e.Data.Duration,e.Data.text.Text,e.Data.text.Length,e.Type===Mi.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,e.Data.text.BoundaryType);this.onWordBoundary(t);break;case Mi.Bookmark:const i=new Wi(e.Data.Offset,e.Data.Bookmark);this.onBookmarkReached(i);break;case Mi.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(e),e.Data.IsLastAnimation){const t=new Hi(e.Data.Offset,e.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(t)}break;case Mi.AvatarSignal:this.onAvatarEvent(e);break;case Mi.SessionEnd:this.privSynthesisTurn.onSessionEnd(e)}break;case"turn.end":let i;this.privSynthesisTurn.onServiceTurnEndResponse();try{i=yield this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(i)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.onSynthesisCompleted(i);break;default:this.processTypeSpecificMessages(n)||this.privServiceEvents&&this.serviceEvents.onEvent(new vt(n.path.toLowerCase(),n.textBody))}return this.receiveMessage()}catch(t){}}))}sendSynthesisContext(e){this.setSynthesisContextSynthesisSection();const t=this.synthesisContext.toJSON();if(t)return e.send(new Bt(tt.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}setSpeechConfigSynthesisSection(){}connectImpl(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!=this.privConnectionPromise)return this.privConnectionPromise.then((e=>e.state()===it.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl())));this.privAuthFetchEventId=C(),this.privConnectionId=C(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then((t=>Xi(this,void 0,void 0,(function*(){this.privSynthesisTurn.onAuthCompleted(!1);const i=this.privConnectionFactory.create(this.privSynthesizerConfig,t,this.privConnectionId);i.events.attach((e=>{this.connectionEvents.onEvent(e)}));const n=yield i.open();return 200===n.statusCode?(this.privSynthesisTurn.onConnectionEstablishCompleted(n.statusCode),Promise.resolve(i)):403!==n.statusCode||e?(this.privSynthesisTurn.onConnectionEstablishCompleted(n.statusCode),Promise.reject("Unable to contact server. StatusCode: ".concat(n.statusCode,", ").concat(this.privSynthesizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint)," Reason: ").concat(n.reason))):this.connectImpl(!0)}))),(e=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(e)})),this.privConnectionPromise.catch((()=>{})),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new Bt(tt.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,i){return e.send(new Bt(tt.Text,"ssml",i,"application/ssml+xml",t))}fetchConnection(){return Xi(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===it.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}configureConnection(){return Xi(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(this.setSpeechConfigSynthesisSection(),yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)}))}onAvatarEvent(e){}onSynthesisStarted(e){}onSynthesizing(e){}onSynthesisCancelled(e){}onSynthesisCompleted(e){}onWordBoundary(e){}onVisemeReceived(e){}onBookmarkReached(e){}}Zi.telemetryDataEnabled=!0;class en{}class tn{constructor(e){this.privConnectionMessage=e,this.privProperties=new ot,this.privConnectionMessage.headers[Lt.ConnectionId]&&this.privProperties.setProperty(Ze.Speech_SessionId,this.privConnectionMessage.headers[Lt.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach((e=>{this.privProperties.setProperty(e,this.privConnectionMessage.headers[e])}))}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((e=>e.toLowerCase()==="path".toLowerCase()))]}get isTextMessage(){return this.privConnectionMessage.messageType===tt.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===tt.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}class nn extends xe{}class rn{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}class on extends xe{constructor(e,t,i){super(i),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}class sn{static fromRecognizer(e){const t=e.internalData,i=new sn;return i.privInternalData=t,i.setupEvents(),i}static fromSynthesizer(e){const t=e.internalData,i=new sn;return i.privInternalData=t,i.setupEvents(),i}openConnection(e,t){k(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof Zi)throw new Error("Disconnecting a synthesizer's connection is currently not supported");k(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,i){if(te.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof Ut){if("speech.context"!==e.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,i)}else if(this.privInternalData instanceof Zi){if("synthesis.context"!==e.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,i)}}sendMessageAsync(e,t,i,n){k(this.privInternalData.sendNetworkMessage(e,t),i,n)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name?this.connected&&this.connected(new nn(e.connectionId)):"ConnectionClosedEvent"===e.name?this.disconnected&&this.disconnected(new nn(e.connectionId)):"ConnectionMessageSentEvent"===e.name?this.messageSent&&this.messageSent(new rn(new tn(e.message))):"ConnectionMessageReceivedEvent"===e.name&&this.messageReceived&&this.messageReceived(new rn(new tn(e.message)))})),this.privServiceEventListener=this.privInternalData.serviceEvents.attach((e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new on(e.jsonString,e.name))}))}}var an,cn,ln=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class un extends Vt{constructor(e,t,i){const n=e;te.throwIfNull(n,"speechConfig"),super(t,n.properties,i||new ki),this.privDisposedTranslationRecognizer=!1,void 0!==this.properties.getProperty(Ze.SpeechServiceConnection_TranslationVoice,void 0)&&te.throwIfNullOrWhitespace(this.properties.getProperty(Ze.SpeechServiceConnection_TranslationVoice),Ze[Ze.SpeechServiceConnection_TranslationVoice]),te.throwIfNullOrWhitespace(this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages),Ze[Ze.SpeechServiceConnection_TranslationToLanguages]),te.throwIfNullOrWhitespace(this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage),Ze[Ze.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,i){const n=e;return t.properties.mergeTo(n.properties),new un(e,i)}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return te.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return te.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){te.throwIfDisposed(this.privDisposedTranslationRecognizer),k(this.recognizeOnceAsyncImpl(At.Interactive),e,t)}startContinuousRecognitionAsync(e,t){k(this.startContinuousRecognitionAsyncImpl(At.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){k(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(te.throwIfNullOrUndefined(e,"language to be removed"),void 0!==this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages,void 0)){const t=this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages).split(","),i=t.indexOf(e);i>-1&&(t.splice(i,1),this.properties.setProperty(Ze.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){te.throwIfNullOrUndefined(e,"language to be added");let t=[];void 0!==this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages,void 0)?(t=this.properties.getProperty(Ze.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(Ze.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(Ze.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){te.throwIfDisposed(this.privDisposedTranslationRecognizer),k(this.dispose(!0),e,t)}onConnection(){}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return ln(this,void 0,void 0,(function*(){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(yield this.implRecognizerStop(),yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new Bi(e,t,i,n,this)}updateLanguages(e){const t=sn.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}}!function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(an||(an={}));class pn{constructor(e){this.privReason=e}static fromResult(e){const t=pi.fromJSON(e.json);let i=an.NotRecognized;switch(t.RecognitionStatus){case ui.BabbleTimeout:i=an.InitialBabbleTimeout;break;case ui.InitialSilenceTimeout:i=an.InitialSilenceTimeout;break;default:i=an.NotRecognized}return new pn(i)}get reason(){return this.privReason}}class dn{constructor(e,t,i){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}class hn extends dn{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=Re.Error,i=nt.NoError;if(e instanceof Ne&&e.json){const i=pi.fromJSON(e.json);t=di.implTranslateCancelResult(i.RecognitionStatus)}return e.properties&&(i=nt[e.properties.getProperty(Qe,nt[nt.NoError])]),new hn(t,e.errorDetails||di.implTranslateErrorDetails(i),i)}}class vn{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const t=e.internalData;return new vn(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}class fn{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}}class gn extends fn{constructor(){super(),this.privSpeechConfig=new at}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){te.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,i,n){this.setProperty(Ze.SpeechServiceConnection_ProxyHostName,e),this.setProperty(Ze.SpeechServiceConnection_ProxyPort,"".concat(t)),i&&this.setProperty(Ze.SpeechServiceConnection_ProxyUserName,i),n&&this.setProperty(Ze.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,i){this.privSpeechConfig.setServiceProperty(e,t)}close(){}}class mn extends gn{constructor(){super()}static fromSubscription(e,t,i){te.throwIfNullOrWhitespace(e,"subscription"),te.throwIfNullOrWhitespace(t,"region");const n=new gn;return n.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.BotFramework),n.setProperty(Ze.SpeechServiceConnection_Key,e),n.setProperty(Ze.SpeechServiceConnection_Region,t),i&&n.setProperty(Ze.Conversation_ApplicationId,i),n}static fromAuthorizationToken(e,t,i){te.throwIfNullOrWhitespace(e,"authorizationToken"),te.throwIfNullOrWhitespace(t,"region");const n=new gn;return n.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.BotFramework),n.setProperty(Ze.SpeechServiceAuthorization_Token,e),n.setProperty(Ze.SpeechServiceConnection_Region,t),i&&n.setProperty(Ze.Conversation_ApplicationId,i),n}static fromHost(e,t,i){te.throwIfNullOrUndefined(e,"host");const n=e instanceof URL?e:new URL("wss://".concat(e,".convai.speech.azure.us"));te.throwIfNullOrUndefined(n,"resolvedHost");const r=new gn;return r.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.BotFramework),r.setProperty(Ze.SpeechServiceConnection_Host,n.toString()),void 0!==t&&r.setProperty(Ze.SpeechServiceConnection_Key,t),r}static fromEndpoint(e,t){te.throwIfNull(e,"endpoint");const i=new gn;return i.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.BotFramework),i.setProperty(Ze.SpeechServiceConnection_Endpoint,e.toString()),void 0!==t&&i.setProperty(Ze.SpeechServiceConnection_Key,t),i}}class yn extends gn{constructor(){super()}static fromSubscription(e,t,i){te.throwIfNullOrWhitespace(e,"applicationId"),te.throwIfNullOrWhitespace(t,"subscription"),te.throwIfNullOrWhitespace(i,"region");const n=new gn;return n.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.CustomCommands),n.setProperty(Ze.Conversation_ApplicationId,e),n.setProperty(Ze.SpeechServiceConnection_Key,t),n.setProperty(Ze.SpeechServiceConnection_Region,i),n}static fromAuthorizationToken(e,t,i){te.throwIfNullOrWhitespace(e,"applicationId"),te.throwIfNullOrWhitespace(t,"authorizationToken"),te.throwIfNullOrWhitespace(i,"region");const n=new gn;return n.setProperty(Ze.Conversation_DialogType,fn.DialogTypes.CustomCommands),n.setProperty(Ze.Conversation_ApplicationId,e),n.setProperty(Ze.SpeechServiceAuthorization_Token,t),n.setProperty(Ze.SpeechServiceConnection_Region,i),n}set applicationId(e){te.throwIfNullOrWhitespace(e,"value"),this.setProperty(Ze.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(Ze.Conversation_ApplicationId)}}class Sn extends oi{create(e,t,i){const n=e.parameters.getProperty(Ze.Conversation_ApplicationId,""),r=e.parameters.getProperty(Ze.Conversation_DialogType),o=e.parameters.getProperty(Ze.SpeechServiceConnection_Region),s=e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,"en-US"),a=e.parameters.getProperty(Ze.Conversation_Request_Bot_Status_Messages,"true"),c={};c[Lt.ConnectionId]=i,c[ri.Format]=e.parameters.getProperty(Ge,be[be.Simple]).toLowerCase(),c[ri.Language]=s,c[ri.RequestBotStatusMessages]=a,n&&(c[ri.BotId]=n,r===fn.DialogTypes.CustomCommands&&(c[Lt.CustomCommandsAppId]=n));const l=r===fn.DialogTypes.CustomCommands?"commands/":"",u=r===fn.DialogTypes.CustomCommands?"v1":r===fn.DialogTypes.BotFramework?"v3":"v0",p={};null!=t.token&&""!==t.token&&(p[t.headerName]=t.token);let d=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,"");if(!d){const t=oi.getHostSuffix(o),i=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://".concat(o,".").concat(Sn.BaseUrl).concat(t)),n=i.endsWith("/")?i:i+"/";d="".concat(n).concat(l).concat(Sn.ApiKey,"/").concat(u)}this.setCommonUrlParams(e,c,d);const h="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(d,c,p,new si,ni.fromRecognizerConfig(e),h,i)}}Sn.ApiKey="api",Sn.BaseUrl="convai.speech";class Cn extends A{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.Info)}}class wn extends Cn{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}}class Rn{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}class bn{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new bn(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}class Pn{constructor(e){this.privTurnStatus=bn.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}}class In{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new In(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}!function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(cn||(cn={}));class En{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===cn.TextToSpeechAudio&&(this.privAudioStream=he.createPullStream(),this.privAudioStream.format=void 0!==t?t:pe.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout((()=>{this.privTurnManager.CompleteTurn(this.privRequestId)}),2e3)}}class Tn{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new R("Service error: There is already a turn with id:"+e);const t=new En(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new R("Service error: Received turn end for an unknown turn id:"+e);const t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}}class kn{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new kn(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}}var An=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class On extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privEvents=new P,this.privDialogServiceConnector=r,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new Tn,this.recognizeOverride=(e,t,i)=>this.listenOnce(e,t,i),this.postConnectImplOverride=e=>this.dialogConnectImpl(e),this.configConnectionOverride=e=>this.configConnection(e),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=i,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach((e=>{"ConnectionClosedEvent"===e.name&&(this.terminateMessageLoop=!0)}))}sendMessage(e){return An(this,void 0,void 0,(function*(){const t=S(),i=C(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},r=JSON.stringify(n),o=yield this.fetchConnection();yield o.send(new Bt(tt.Text,"agent",i,"application/json",r))}))}privDisconnect(){return An(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}))}processTypeSpecificMessages(e){const t=new ot;let i,n;switch(e.messageType===tt.Text&&t.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":const r=pi.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+r.Offset+r.Duration),r.RecognitionStatus!==ui.TooManyRequests&&r.RecognitionStatus!==ui.Error){const e=this.fireEventForResult(r,t);if(this.privLastResult=e.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,e)}catch(o){}}n=!0;break;case"speech.hypothesis":const s=ci.fromJSON(e.textBody),a=s.Offset+this.privRequestSession.currentTurnAudioOffset;i=new _e(this.privRequestSession.requestId,Pe.RecognizingSpeech,s.Text,s.Duration,a,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(a);const c=new qe(i,s.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,c)}catch(o){}n=!0;break;case"speech.keyword":const l=kn.fromJSON(e.textBody);i=new _e(this.privRequestSession.requestId,"Accepted"===l.Status?Pe.RecognizedKeyword:Pe.NoMatch,l.Text,l.Duration,l.Offset,void 0,void 0,void 0,void 0,e.textBody,t),"Accepted"!==l.Status&&(this.privLastResult=i);const u=new qe(i,i.duration,i.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,u)}catch(o){}n=!0;break;case"audio":{const t=e.requestId.toUpperCase(),i=this.privTurnStateManager.GetTurn(t);try{e.binaryBody?i.audioStream.write(e.binaryBody):i.endAudioStream()}catch(o){}}n=!0;break;case"response":this.handleResponseMessage(e),n=!0}const r=new T;return r.resolve(n),r.promise}cancelRecognition(e,t,i,n,r){return An(this,void 0,void 0,(function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){const s=new ot;s.setProperty(Qe,nt[n]);const a=new He(i,r,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,a)}catch(t){}if(this.privSuccessCallback){const e=new _e(void 0,Pe.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,r,void 0,s);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(o){}}}}))}listenOnce(e,t,i){return An(this,void 0,void 0,(function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Ze.Speech_SessionId,this.privRequestSession.sessionId);const n=this.connectImpl(),r=this.sendPreAudioMessages(),o=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),s=yield this.privDialogAudioSource.format,a=yield this.privDialogAudioSource.deviceInfo,c=new ut(o,s.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(c,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a};try{yield n,yield r}catch(u){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.ConnectionFailure,u),Promise.resolve()}const l=new xe(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,l);this.sendAudio(c).then((()=>{}),(e=>An(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.RuntimeError,e)}))))}))}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){const e=new T,t=()=>An(this,void 0,void 0,(function*(){try{const n=this.isDisposed(),r=!this.isDisposed()&&this.terminateMessageLoop;if(n||r)return void e.resolve(void 0);const o=yield this.fetchConnection(),s=yield o.read();if(!s)return t();const a=Bt.fromConnectionMessage(s);switch(a.path.toLowerCase()){case"turn.start":{const e=a.requestId.toUpperCase();e!==this.privRequestSession.requestId.toUpperCase()?this.privTurnStateManager.StartTurn(e):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const e=Mt.fromJSON(a.textBody),t=new De(e.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,t);break;case"speech.enddetected":let n;n=a.textBody.length>0?a.textBody:"{ Offset: 0 }";const r=Mt.fromJSON(n);this.privRequestSession.onServiceRecognized(r.Offset+this.privRequestSession.currentTurnAudioOffset);const o=new De(r.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,o);break;case"turn.end":{const e=a.requestId.toUpperCase();if(e!==this.privRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(e);else{const e=new xe(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),this.privRecognizerConfig.isContinuousRecognition&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing||this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,e),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(i){this.privErrorCallback&&this.privErrorCallback(i)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{(yield this.processTypeSpecificMessages(a))||this.serviceEvents&&this.serviceEvents.onEvent(new vt(a.path.toLowerCase(),a.textBody))}catch(i){}}return t()}catch(n){this.terminateMessageLoop=!0,e.resolve()}}));return t().catch((e=>{G.instance.onEvent(new ue(e))})),e.promise}startMessageLoop(){return An(this,void 0,void 0,(function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.RuntimeError,e)}return Promise.resolve()}))}configConnection(e){return An(this,void 0,void 0,(function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)}))}sendPreAudioMessages(){return An(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e,!0),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)}))}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(Ze.Conversation_DialogType)===fn.DialogTypes.CustomCommands){const e=this.agentConfig.get();e.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(e)}this.onEvent(new wn(this.agentConfig));const t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new Bt(tt.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){const t=S(),i=this.privDialogServiceConnector.properties.getProperty(Ze.Conversation_Speech_Activity_Template),n={channelData:"",context:{interactionId:t},messagePayload:void 0===typeof i?void 0:i,version:.5},r=JSON.stringify(n);return e.send(new Bt(tt.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",r))}fireEventForResult(e,t){const i=di.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privRequestSession.currentTurnAudioOffset,r=new _e(this.privRequestSession.requestId,i,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new qe(r,n,this.privRequestSession.sessionId)}handleResponseMessage(e){const t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":const n=e.requestId.toUpperCase(),r=In.fromJSON(e.textBody),o=this.privTurnStateManager.GetTurn(n);if(r.conversationId){const e=this.agentConfig.get();e.botInfo.conversationId=r.conversationId,this.agentConfig.set(e)}const s=o.processActivityPayload(r,pe.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(Ze.SpeechServiceConnection_SynthOutputFormat,void 0))),a=new Rn(r.messagePayload,s);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,a)}catch(i){}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new Pn(e.textBody))}catch(i){}break;default:G.instance.onEvent(new ue("Unexpected response of type ".concat(t.messageType,". Ignoring.")))}}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}addKeywordContextData(){const e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(void 0===e)return;const t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),i=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),n=e.split(";"),r=void 0===t?[]:t.split(";"),o=void 0===i?[]:i.split(";"),s=[];for(let a=0;a<n.length;a++){const e={};e.text=n[a],a<r.length&&(e.offset=Number(r[a])),a<o.length&&(e.duration=Number(o[a])),s.push(e)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:s,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}}var xn,Dn=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class zn extends Vt{constructor(e,t){const i=e;te.throwIfNull(e,"dialogConfig"),super(t,i.properties,new Sn),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=i.properties.clone();const n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(e,t){k(this.privReco.connect(),e,t)}disconnect(e,t){k(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(Ze.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(Ze.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){te.throwIfDisposed(this.privIsDisposed);const i=(()=>Dn(this,void 0,void 0,(function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;const e=new T;yield this.privReco.recognize(At.Conversation,e.resolve,e.reject);const t=yield e.promise;return yield this.implRecognizerStop(),t})))();i.catch((()=>{this.dispose(!0).catch((()=>{}))})),k(i.finally((()=>{this.isTurnComplete=!0})),e,t)}}sendActivityAsync(e,t,i){k(this.privReco.sendMessage(e),t,i)}close(e,t){te.throwIfDisposed(this.privIsDisposed),k(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Dn(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new On(e,t,i,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(Ze.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(Ze.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(Ze.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(Ze.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}}!function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(xn||(xn={}));var Nn=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class _n{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,void 0===e&&(e=Q.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,i){try{this.ensureInitializedContext();const i=this.formatAudioData(e),n=new Float32Array(this.samples.length+i.length);n.set(this.samples,0),n.set(i,this.samples.length),this.samples=n,t&&t()}catch(n){i&&i(n)}}stopAudio(e,t){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(null===this.audioContext){this.createAudioContext();const e=200;this.autoUpdateBufferTimer=setInterval((()=>{this.updateAudioBuffer()}),e)}}createAudioContext(){this.audioContext=$.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new R("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){const i=new Float32Array(e.length);for(let n=0;n<e.length;n++)i[n]=e[n]/t;return i}updateAudioBuffer(){if(0===this.samples.length)return;const e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),i=this.samples.length/e,n=this.audioContext.createBuffer(e,i,this.audioFormat.samplesPerSec);for(let r=0;r<e;r++){let t=r;const i=n.getChannelData(r);for(let n=0;n<this.samples.length;n++,t+=e)i[n]=this.samples[t]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}playAudio(e){return Nn(this,void 0,void 0,(function*(){null===this.audioContext&&this.createAudioContext();const t=this.audioContext.createBufferSource(),i=this.audioContext.destination;yield this.audioContext.decodeAudioData(e,(e=>{t.buffer=e,t.connect(i),t.start(0)}))}))}}class Mn{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}}class Ln{constructor(e,t,i){this.privReason=e,this.privProperties=new ot,this.privReason!==Pe.Canceled?t&&(this.privDetails=JSON.parse(t),"enrolling"===this.privDetails.enrollmentStatus.toLowerCase()&&(this.privReason=Pe.EnrollingVoiceProfile)):(this.privErrorDetails=i,this.privProperties.setProperty(Qe,nt[nt.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){const t=[];for(const i of e.value){const e="enrolling"===i.enrollmentStatus.toLowerCase()?Pe.EnrollingVoiceProfile:"enrolled"===i.enrollmentStatus.toLowerCase()?Pe.EnrolledVoiceProfile:Pe.Canceled,n=new Ln(e,null,null);n.privDetails=this.getIdentificationDetails(i),t.push(n)}return t}static FromVerificationProfileList(e){const t=[];for(const i of e.value){const e="enrolling"===i.enrollmentStatus.toLowerCase()?Pe.EnrollingVoiceProfile:"enrolled"===i.enrollmentStatus.toLowerCase()?Pe.EnrolledVoiceProfile:Pe.Canceled,n=new Ln(e,null,null);n.privDetails=this.getVerificationDetails(i),t.push(n)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}}class Bn extends dn{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=Re.Error;let i=nt.NoError;return e.properties&&(i=nt[e.properties.getProperty(Qe,nt[nt.NoError])]),new Bn(t,e.errorDetails,i)}}class qn{constructor(e,t){this.privReason=e,this.privProperties=new ot,e===Pe.Canceled&&(te.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(Qe,nt[nt.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}}class Un extends dn{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=Re.Error;let i=nt.NoError;return e.properties&&(i=nt[e.properties.getProperty(Qe,nt[nt.NoError])]),new Un(t,e.errorDetails,i)}}class Fn extends qn{constructor(e,t,i,n){super(e,t),this.privPhrases=[],te.throwIfNullOrUndefined(n,"phrase array"),this.privType=i,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}}class Wn extends oi{create(e,t,i,n){let r=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint);if(!r){const t=e.parameters.getProperty(Ze.SpeechServiceConnection_Region),n=oi.getHostSuffix(t),o=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://".concat(t,".spr-frontend.speech").concat(n)),s=e.parameters.getProperty(Ze.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");r="".concat(o,"/speaker/ws/").concat(this.scenarioToPath(s),"/").concat(i)}const o={format:"simple",language:e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,o,r);const s={};void 0!==t.token&&""!==t.token&&(s[t.headerName]=t.token),s[Lt.ConnectionId]=n,s[Lt.SpIDAuthKey]=e.parameters.getProperty(Ze.SpeechServiceConnection_Key),e.parameters.setProperty(Ze.SpeechServiceConnection_Url,r);const a="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(r,o,s,new si,ni.fromRecognizerConfig(e),a,n)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}class Hn extends Wn{create(e,t,i){return super.create(e,t,"recognition",i)}}class jn extends Wn{create(e,t,i){return super.create(e,t,"profile",i)}}class Vn{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(i){this.privMap[e].reject(i)}finally{this.privMap[e]=void 0}}}var Kn=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Jn extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privDeferralMap=new Vn,this.privSpeakerAudioSource=i,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1;const i=new ot;switch(e.messageType===tt.Text&&i.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":const i=JSON.parse(e.textBody);switch(i.operation.toLowerCase()){case"create":this.handleCreateResponse(i,e.requestId);break;case"delete":case"reset":this.handleResultResponse(i,e.requestId);break;case"fetch":const t=JSON.parse(e.textBody);this.handleFetchResponse(t,e.requestId)}t=!0;break;case"speaker.phrases":const n=JSON.parse(e.textBody);this.handlePhrasesResponse(n,e.requestId),t=!0;break;case"speaker.profile.enrollment":const r=JSON.parse(e.textBody),o=new Ln(this.enrollmentReasonFrom(r.enrollment?r.enrollment.enrollmentStatus:r.status.statusCode),r.enrollment?JSON.stringify(r.enrollment):void 0,r.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,o),this.privRequestSession.onSpeechEnded(),t=!0}const n=new T;return n.resolve(t),n.promise}cancelRecognition(e,t,i,n,r){(new ot).setProperty(Qe,nt[n]);const o=new Ln(Pe.Canceled,r,r);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,o)}createProfile(e,t){return Kn(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const i=this.connectImpl();try{const n=new T;return yield i,yield this.sendCreateProfile(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}}))}resetProfile(e){return Kn(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)}))}deleteProfile(e){return Kn(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)}))}retrieveEnrollmentResult(e){return Kn(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)}))}getAllProfiles(e){return Kn(this,void 0,void 0,(function*(){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)}))}getActivationPhrases(e,t){return Kn(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const i=this.connectImpl();try{const n=new T;return yield i,yield this.sendPhrasesRequest(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}}))}enrollProfile(e){return Kn(this,void 0,void 0,(function*(){this.voiceProfileType=e.profileType.toString();const t=new T;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Ze.Speech_SessionId,this.privRequestSession.sessionId);const i=this.connectImpl(),n=this.sendPreAudioMessages(e,t),r=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=yield this.privSpeakerAudioSource.format,s=yield this.privSpeakerAudioSource.deviceInfo,a=new ut(r,o.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(a,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:s};try{yield i,yield n}catch(l){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.ConnectionFailure,l)}const c=new xe(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,c),this.receiveMessage();return this.sendAudio(a).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.RuntimeError,e)})),t.promise}))}sendPreAudioMessages(e,t){return Kn(this,void 0,void 0,(function*(){const i=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),yield this.sendBaseRequest(i,"enroll",this.scenarioFrom(e.profileType),e)}))}sendPhrasesRequest(e,t,i){return Kn(this,void 0,void 0,(function*(){const n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const r=this.scenarioFrom(t),o={locale:i,scenario:r};return n.send(new Bt(tt.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCreateProfile(e,t,i){return Kn(this,void 0,void 0,(function*(){const n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const r=t===bi.TextIndependentIdentification?"TextIndependentIdentification":t===bi.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:i,number:"1",scenario:r};return n.send(new Bt(tt.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCommonRequest(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return Kn(this,void 0,void 0,(function*(){const n=this.connectImpl();try{const r=new T;this.privRequestSession.onSpeechContext(),yield n;const o=yield this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,r),yield this.sendBaseRequest(o,e,this.scenarioFrom(t),i),this.receiveMessage(),r.promise}catch(r){throw r}}))}sendBaseRequest(e,t,i,n){return Kn(this,void 0,void 0,(function*(){const r={scenario:i};return n?r.profileIds=[n.profileId]:r.maxPageSize=-1,e.send(new Bt(tt.Text,"speaker.profile.".concat(t),this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(r)))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error("Voice Profile get activation phrases request for requestID ".concat(t," not found"));if("success"!==e.status.statusCode.toLowerCase()){const i=Pe.Canceled,n=new Fn(i,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,n)}else{if(!(e.phrases&&e.phrases.length>0))throw new Error("Voice Profile get activation phrases failed, no phrases received");{const i=Pe.EnrollingVoiceProfile,n=new Fn(i,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,n)}}}handleCreateResponse(e,t){if(!(e.profiles&&e.profiles.length>0))throw new Error("Voice Profile create failed, no profile id received");if(!this.privDeferralMap.getId(t))throw new Error("Voice Profile create request for requestID ".concat(t," not found"));{const i=e.profiles.map((e=>e.profileId));this.privDeferralMap.complete(t,i)}}handleResultResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error("Voice Profile create request for requestID ".concat(t," not found"));{const i="delete"===e.operation.toLowerCase()?Pe.DeletedVoiceProfile:Pe.ResetVoiceProfile,n="success"===e.status.statusCode.toLowerCase()?i:Pe.Canceled,r=new qn(n,"statusCode: ".concat(e.status.statusCode,", errorDetails: ").concat(e.status.reason));this.privDeferralMap.complete(t,r)}}handleFetchResponse(e,t){if(!this.privDeferralMap.getId(t)||!e.profiles[0])throw new Error("Voice Profile fetch request for requestID ".concat(t," not found"));if(this.privExpectedProfileId&&1===e.profiles.length&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const i=e.profiles[0],n=new Ln(this.enrollmentReasonFrom(i.enrollmentStatus),JSON.stringify(i),e.status.reason);this.privDeferralMap.complete(t,n)}else if(e.profiles.length>0){const i=e.profiles,n=[];for(const t of i)n.push(new Ln(this.enrollmentReasonFrom(t.enrollmentStatus),JSON.stringify(t),e.status.reason));this.privDeferralMap.complete(t,n)}}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return Pe.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return Pe.Canceled;default:return Pe.EnrollingVoiceProfile}}scenarioFrom(e){return e===bi.TextIndependentIdentification?"TextIndependentIdentification":e===bi.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}}var Gn,Qn=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class $n extends Vt{constructor(e){te.throwIfNullOrUndefined(e,"speechConfig");const t=e;te.throwIfNull(t,"speechConfig"),super(Te.fromStreamInput(oe.createPushStream()),t.properties,new jn),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}createProfileAsync(e,t){return Qn(this,void 0,void 0,(function*(){const i=yield this.privVoiceAdapter.createProfile(e,t);return new Mn(i[0],e)}))}retrieveEnrollmentResultAsync(e){return Qn(this,void 0,void 0,(function*(){return this.privVoiceAdapter.retrieveEnrollmentResult(e)}))}getAllProfilesAsync(e){return Qn(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getAllProfiles(e)}))}getActivationPhrasesAsync(e,t){return Qn(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getActivationPhrases(e,t)}))}enrollProfileAsync(e,t){return Qn(this,void 0,void 0,(function*(){const i=t;return te.throwIfNullOrUndefined(i,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=i,this.privVoiceAdapter.enrollProfile(e)}))}deleteProfileAsync(e){return Qn(this,void 0,void 0,(function*(){return this.privVoiceAdapter.deleteProfile(e)}))}resetProfileAsync(e){return Qn(this,void 0,void 0,(function*(){return this.privVoiceAdapter.resetProfile(e)}))}close(){return Qn(this,void 0,void 0,(function*(){yield this.dispose(!0)}))}createServiceRecognizer(e,t,i,n){return new Jn(e,t,i,n,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Qn(this,void 0,void 0,(function*(){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&(yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new _t(e,this.properties)}getResult(e,t){return new qn(e.ok?t:Pe.Canceled,e.statusText)}}!function(e){e[e.Verify=0]="Verify",e[e.Identify=1]="Identify"}(Gn||(Gn={}));class Yn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.RecognizedSpeaker,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt.NoError,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.privProperties=new ot;const r="TextIndependentIdentification"===e.scenario?Gn.Identify:Gn.Verify;this.privReason=t,this.privReason!==Pe.Canceled?r===Gn.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=Pe.RecognizedSpeakers):(this.privScore=e.verificationResult.score,"accept"!==e.verificationResult.recognitionResult.toLowerCase()&&(this.privReason=Pe.NoMatch),void 0!==e.verificationResult.profileId&&""!==e.verificationResult.profileId&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=n,this.privProperties.setProperty(Qe,nt[i])),this.privProperties.setProperty(Ze.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}class Xn extends dn{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=Re.Error;let i=nt.NoError;return e.properties&&(i=nt[e.properties.getProperty(Qe,nt[nt.NoError])]),new Xn(t,e.errorDetails,i)}}var Zn=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class er extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privSpeakerRecognizer=r,this.privSpeakerAudioSource=i,this.recognizeSpeaker=e=>this.recognizeSpeakerOnce(e),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1;const i=new ot;if(e.messageType===tt.Text&&i.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody),"speaker.response"===e.path.toLowerCase()){const i=JSON.parse(e.textBody);let n;n="success"!==i.status.statusCode.toLowerCase()?new Yn(i,Pe.Canceled,nt.ServiceError,i.status.reason):new Yn(i,Pe.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(n),t=!0}const n=new T;return n.resolve(t),n.promise}cancelRecognition(e,t,i,n,r){if((new ot).setProperty(Qe,nt[n]),this.privResultDeferral){const e=new Yn({scenario:this.privSpeakerModel.scenario,status:{statusCode:r,reason:r}},Pe.Canceled,n,r);try{this.privResultDeferral.resolve(e)}catch(r){this.privResultDeferral.reject(r)}}}recognizeSpeakerOnce(e){return Zn(this,void 0,void 0,(function*(){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new T),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Ze.Speech_SessionId,this.privRequestSession.sessionId);const t=this.connectImpl(),i=this.sendPreAudioMessages(this.extractSpeakerContext(e)),n=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),r=yield this.privSpeakerAudioSource.format,o=yield this.privSpeakerAudioSource.deviceInfo,s=new ut(n,r.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{yield t,yield i}catch(c){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.ConnectionFailure,c)}const a=new xe(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,a),this.receiveMessage();return this.sendAudio(s).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Re.Error,nt.RuntimeError,e)})),this.privResultDeferral.promise}))}sendPreAudioMessages(e){return Zn(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield this.sendSpeakerRecognition(t,e)}))}sendSpeakerRecognition(e,t){return Zn(this,void 0,void 0,(function*(){const i=JSON.stringify(t);return e.send(new Bt(tt.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",i))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}}var tr,ir=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class nr extends Vt{constructor(e,t){te.throwIfNullOrUndefined(e,"speechConfig");const i=e;te.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new Hn),this.privAudioConfigImpl=t,te.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=i.properties}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e){return ir(this,void 0,void 0,(function*(){return te.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)}))}close(){return ir(this,void 0,void 0,(function*(){te.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.dispose(!0)}))}recognizeSpeakerOnceAsyncImpl(e){return ir(this,void 0,void 0,(function*(){te.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.implRecognizerStop();const t=yield this.privReco.recognizeSpeaker(e);return yield this.implRecognizerStop(),t}))}implRecognizerStop(){return ir(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new er(e,t,i,n,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return ir(this,void 0,void 0,(function*(){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,yield t.dispose.call(this,e))}))}}class rr{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],te.throwIfNullOrUndefined(e,"VoiceProfiles"),0===e.length)throw new Error("Empty Voice Profiles array");for(const t of e){if(t.profileType!==bi.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new rr(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}}class or{constructor(e){if(te.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===bi.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new or(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===bi.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}}!function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"}(tr||(tr={}));class sr{constructor(){this.privProperties=new ot,this.privProperties.setProperty(Ze.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=tr.AtStart}static fromOpenRange(){const e=new sr;return e.properties.setProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages,Xe),e}static fromLanguages(e){te.throwIfArrayEmptyOrWhitespace(e,"languages");const t=new sr;return t.properties.setProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const t=new sr,i=[];return e.forEach((e=>{if(i.push(e.language),void 0!==e.endpointId&&""!==e.endpointId){const i=e.language+Ze.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(i,e.endpointId)}})),t.properties.setProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages,i.join()),t}get properties(){return this.privProperties}set mode(e){e===tr.Continuous?(this.privProperties.setProperty(Ze.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(Ze.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(Ze.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(Ze.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}}class ar{constructor(e,t){te.throwIfNullOrUndefined(e,"language"),te.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new ar(e.language,e.languageDetectionConfidence)}static fromConversationTranscriptionResult(e){return new ar(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}class cr{constructor(e,t){te.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new cr(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}class lr{static get requestOptions(){return lr.privDefaultRequestOptions}static get configParams(){return lr.privDefaultParams}static get restErrors(){return lr.privRestErrors}}lr.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},lr.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},lr.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"};class ur extends lr{static get host(){return ur.privHost}static get apiVersion(){return ur.privApiVersion}static get clientAppId(){return ur.privClientAppId}static get defaultLanguageCode(){return ur.privDefaultLanguageCode}static get restPath(){return ur.privRestPath}static get webSocketPath(){return ur.privWebSocketPath}static get transcriptionEventKeys(){return ur.privTranscriptionEventKeys}}ur.privHost="dev.microsofttranslator.com",ur.privRestPath="/capito/room",ur.privApiVersion="2.0",ur.privDefaultLanguageCode="en-US",ur.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",ur.privWebSocketPath="/capito/translate",ur.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"];class pr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(void 0===e)return;const t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex((t=>t.id===e))}getParticipant(e){return this.participants.find((t=>t.id===e))}deleteParticipant(e){this.participants=this.participants.filter((t=>t.id!==e))}get host(){return this.participants.find((e=>!0===e.isHost))}get me(){return this.getParticipant(this.meId)}}const dr="final",hr="instant_message",vr="keep_alive",fr="partial",gr="participant_command",mr="ChangeNickname",yr="EjectParticipant",Sr="SetLockState",Cr="SetMute",wr="SetMuteAll",Rr="SetProfanityFiltering",br="SetTranslateToLanguages",Pr="SetUseTTS";var Ir,Er=i(213),Tr=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.Get="GET",e.Post="POST",e.Delete="DELETE",e.File="file"}(Ir||(Ir={}));class kr{constructor(e){if(!e)throw new w("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let i="";try{const n=t.trim().split(/[\r\n]+/),r={};n.forEach((e=>{const t=e.split(": "),i=t.shift().toLowerCase(),n=t.join(": ");r[i]=n})),i=r[e.toLowerCase()]}catch(n){}return i}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=new T,o=e===Ir.File?"POST":e,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=e;return{data:JSON.stringify(t),headers:JSON.stringify(e.headers),json:t,ok:e.statusCode>=200&&e.statusCode<300,status:e.statusCode,statusText:t.error?t.error.message:i.statusText?i.statusText:i.statusMessage}};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===Ir.Post&&n&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),(n=>{Er(t,o,this.privHeaders,200,201,202,204,400,401,402,403,404)(""===this.queryParams(i)?"":"?".concat(this.queryParams(i)),n).then((t=>Tr(this,void 0,void 0,(function*(){if(e===Ir.Delete||204===t.statusCode)r.resolve(s(t));else try{const e=yield t.json();r.resolve(s(t,e))}catch(i){r.resolve(s(t))}})))).catch((e=>{r.reject(e)}))})(n),r.promise}queryParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")}}class Ar{constructor(){this.privRequestParams=ur.configParams,this.privErrors=ur.restErrors,this.privHost=ur.host,this.privApiVersion=ur.apiVersion,this.privRestPath=ur.restPath,this.privRestAdapter=new kr({})}createOrJoin(e,t,i,n){try{te.throwIfNullOrUndefined(e,"args");const r=e.getProperty(Ze.SpeechServiceConnection_RecoLanguage,ur.defaultLanguageCode),o=e.getProperty(Ze.ConversationTranslator_Name,"conversation_host"),s=e.getProperty(Ze.ConversationTranslator_Host,this.privHost),a=e.getProperty(Ze.ConversationTranslator_CorrelationId),c=e.getProperty(Ze.SpeechServiceConnection_Key),l=e.getProperty(Ze.SpeechServiceConnection_Region),u=e.getProperty(Ze.SpeechServiceAuthorization_Token);te.throwIfNullOrWhitespace(r,"languageCode"),te.throwIfNullOrWhitespace(o,"nickname"),te.throwIfNullOrWhitespace(s,"endpointHost");const p={};p[this.privRequestParams.apiVersion]=this.privApiVersion,p[this.privRequestParams.languageCode]=r,p[this.privRequestParams.nickname]=o;const d={};a&&(d[this.privRequestParams.correlationId]=a),d[this.privRequestParams.clientAppId]=ur.clientAppId,void 0!==t?p[this.privRequestParams.roomId]=t:(te.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionRegion),d[this.privRequestParams.subscriptionRegion]=l,c?d[this.privRequestParams.subscriptionKey]=c:u?d[this.privRequestParams.authorization]="Bearer ".concat(u):te.throwIfNullOrUndefined(c,this.privErrors.authInvalidSubscriptionKey));const h={};h.headers=d,this.privRestAdapter.options=h;const v="https://".concat(s).concat(this.privRestPath);this.privRestAdapter.request(Ir.Post,v,p,null).then((e=>{const t=kr.extractHeaderValue(this.privRequestParams.requestId,e.headers);if(!e.ok){if(n){let i,r=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",e.status.toString());try{i=JSON.parse(e.data),r+=" [".concat(i.error.code,": ").concat(i.error.message,"]")}catch(o){r+=" [".concat(e.data,"]")}t&&(r+=" ".concat(t)),n(r)}return}const r=JSON.parse(e.data);if(r&&(r.requestId=t),i){try{i(r)}catch(o){n&&n(o)}i=void 0}})).catch((()=>{}))}catch(r){if(n)if(r instanceof Error){const e=r;n(e.name+": "+e.message)}else n(r)}}leave(e,t){return new Promise(((i,n)=>{try{te.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),te.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));const n=e.getProperty(Ze.ConversationTranslator_Host,this.privHost),r=e.getProperty(Ze.ConversationTranslator_CorrelationId),o={};o[this.privRequestParams.apiVersion]=this.privApiVersion,o[this.privRequestParams.sessionToken]=t;const s={};r&&(s[this.privRequestParams.correlationId]=r);const a={};a.headers=s,this.privRestAdapter.options=a;const c="https://".concat(n).concat(this.privRestPath);this.privRestAdapter.request(Ir.Delete,c,o,null).then((e=>{e.ok,i()})).catch((()=>{}))}catch(r){if(r instanceof Error){const e=r;n(e.name+": "+e.message)}else n(r)}}))}}class Or extends ht{constructor(e,t,i,n){super(e,t,i,n);const r=JSON.parse(this.textBody);void 0!==r.type&&(this.privConversationMessageType=r.type)}get conversationMessageType(){return this.privConversationMessageType}}class xr{toConnectionMessage(e){const t=new T;try{if(e.messageType===tt.Text){const i=new Or(e.messageType,e.textContent,{},e.id);t.resolve(i)}else e.messageType===tt.Binary&&t.resolve(new Or(e.messageType,e.binaryContent,void 0,e.id))}catch(i){t.reject("Error formatting the message. Error: ".concat(i))}return t.promise}fromConnectionMessage(e){const t=new T;try{if(e.messageType===tt.Text){const i="".concat(e.textBody?e.textBody:"");t.resolve(new Xt(tt.Text,i,e.id))}}catch(i){t.reject("Error formatting the message. ".concat(i))}return t.promise}}class Dr extends oi{create(e,t,i){const n=e.parameters.getProperty(Ze.ConversationTranslator_Host,ur.host),r=e.parameters.getProperty(Ze.ConversationTranslator_CorrelationId,S()),o="wss://".concat(n).concat(ur.webSocketPath),s=e.parameters.getProperty(Ze.ConversationTranslator_Token,void 0);te.throwIfNullOrUndefined(s,"token");const a={};a[ur.configParams.apiVersion]=ur.apiVersion,a[ur.configParams.token]=s,a[ur.configParams.correlationId]=r;const c="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(o,a,{},new xr,ni.fromRecognizerConfig(e),c,i)}}class zr extends We{}class Nr extends xe{constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}}class _r extends Ke{constructor(e,t,i,n,r,o,s,a,c,l,u){super(t,n,r,o,s,a,void 0,void 0,c,l,u),this.privId=e,this.privOrigLang=i}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}}var Mr=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Lr{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=C(),this.privRequestCompletionDeferral=new T}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){200!==e&&403===e&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=C():this.onComplete()}dispose(){return Mr(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach()}}))}onComplete(){}}class Br extends xe{constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}}class qr extends xe{constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}}class Ur extends xe{constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}}class Fr extends xe{constructor(e,t,i,n){super(n),this.privKey=t,this.privValue=i,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}class Wr extends xe{constructor(e,t,i,n,r,o,s,a,c){super(c),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=i,this.privProfanityFilter=n,this.privRoomProfanityFilter=r,this.privIsRoomLocked=o,this.privIsRoomLocked=s,this.privParticipants=a}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}class Hr{constructor(e,t,i){this.privPayload=t,this.privCommand=e,this.privSessionId=i}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}class jr{constructor(e){this.privCommandResponse=(e=>JSON.parse(e))(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new jr(e)}}class Vr{constructor(e){this.privParticipantsPayloadResponse=(e=>JSON.parse(e))(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new Vr(e)}}class Kr{constructor(e){this.privParticipantPayloadResponse=(e=>JSON.parse(e))(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new Kr(e)}}class Jr{constructor(e){this.privSpeechResponse=(e=>JSON.parse(e))(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return"final"===this.privSpeechResponse.type}static fromJSON(e){return new Jr(e)}}class Gr{constructor(e){this.privTextResponse=(e=>JSON.parse(e))(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new Gr(e)}}var Qr=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class $r extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=r,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=e=>this.conversationConnectImpl(e),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new Lr(C()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Qr(this,void 0,void 0,(function*(){if(this.privConversationIsDisposed=!0,void 0!==this.privConnectionConfigPromise){const t=yield this.privConnectionConfigPromise;yield t.dispose(e)}yield t.dispose.call(this,e)}))}sendMessage(e){return Qr(this,void 0,void 0,(function*(){return(yield this.fetchConnection()).send(new Or(tt.Text,e))}))}sendMessageAsync(e){return Qr(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield t.send(new Or(tt.Text,e))}))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,Re.Error,nt.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}processTypeSpecificMessages(){return Qr(this,void 0,void 0,(function*(){return!0}))}cancelRecognition(e,t,i,n,r){this.terminateMessageLoop=!0;const o=new zr(i,r,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch(s){}}conversationConnectImpl(e){return Qr(this,void 0,void 0,(function*(){return this.privConnectionLoop=this.startMessageLoop(),e}))}receiveConversationMessageOverride(){return Qr(this,void 0,void 0,(function*(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const e=new T;try{const i=yield this.fetchConnection(),n=yield i.read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!n)return this.receiveConversationMessageOverride();const r=this.privConversationRequestSession.sessionId,o=n.conversationMessageType.toLowerCase();let s=!1;try{switch(o){case"info":case"participant_command":case"command":const e=jr.fromJSON(n.textBody);switch(e.command.toLowerCase()){case"participantlist":const t=Vr.fromJSON(n.textBody),i=t.participants.map((e=>({avatar:e.avatar,displayName:e.nickname,id:e.participantId,isHost:e.ishost,isMuted:e.ismuted,isUsingTts:e.usetts,preferredLanguage:e.locale})));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new Wr(t.roomid,t.token,t.translateTo,t.profanityFilter,t.roomProfanityFilter,t.roomLocked,t.muteAll,i,r));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Fr(e.participantId,br,e.value,r));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Fr(e.participantId,Rr,e.value,r));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Fr(e.participantId,Cr,e.value,r));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new Br(e.value,r));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new Nr(e.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Fr(e.participantId,Pr,e.value,r));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new qr(e.value,r));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Fr(e.participantId,mr,e.value,r));break;case"joinsession":const o=Kr.fromJSON(n.textBody),s={avatar:o.avatar,displayName:o.nickname,id:o.participantId,isHost:o.ishost,isMuted:o.ismuted,isUsingTts:o.usetts,preferredLanguage:o.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new Ur(s,r));break;case"leavesession":const a={id:e.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new Ur(a,r));break;case"disconnectsession":e.participantId;break;case"token":const c=new Ht((()=>{const t=e.token;return Promise.resolve(t)}),(()=>{const t=e.token;return Promise.resolve(t)}));this.authentication=c,this.privConversationServiceConnector.onToken(c)}break;case"partial":case"final":const t=Jr.fromJSON(n.textBody),i="final"===o?Pe.TranslatedParticipantSpeech:Pe.TranslatingParticipantSpeech,a=new _r(t.participantId,this.getTranslations(t.translations),t.language,t.id,i,t.recognition,void 0,void 0,n.textBody,void 0);t.isFinal?((void 0!==a.text&&a.text.length>0||t.id===this.privLastPartialUtteranceId)&&(s=!0),s&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Hr(dr,a,r))):void 0!==a.text&&(this.privLastPartialUtteranceId=t.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Hr(fr,a,r)));break;case"translated_message":const c=Gr.fromJSON(n.textBody),l=new _r(c.participantId,this.getTranslations(c.translations),c.language,void 0,void 0,c.originalText,void 0,void 0,void 0,n.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Hr(hr,l,r))}}catch(t){}return this.receiveConversationMessageOverride()}catch(t){this.terminateMessageLoop=!0}return e.promise}))}startMessageLoop(){return Qr(this,void 0,void 0,(function*(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const e=this.receiveConversationMessageOverride();try{return yield e}catch(t){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",Re.Error,nt.RuntimeError,t),null}}))}configConnection(){return this.isDisposed()?Promise.resolve(void 0):void 0!==this.privConnectionConfigPromise?this.privConnectionConfigPromise.then((e=>e.state()===it.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()))):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then((e=>e)),this.privConnectionConfigPromise)}getTranslations(e){let t;if(void 0!==e){t=new Oi;for(const i of e)t.set(i.lang,i.translation)}return t}}var Yr,Xr=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Zr{static fromConfig(e,t,i){return new eo(e,t,i)}}class eo extends Vt{constructor(e,t,i){const n=t;te.throwIfNull(n,"speechConfig");const r=e;te.throwIfNull(r,"conversationImpl"),super(i,n.properties,new Dr),this.privConversation=r,this.privIsDisposed=!1,this.privProperties=n.properties.clone(),this.privConnection=sn.fromRecognizer(this);"on"===this.privProperties.getProperty(Ze.WebWorkerLoadType,"on").toLowerCase()&&"undefined"!==typeof Blob&&"undefined"!==typeof Worker?(this.privSetTimeout=dt.setTimeout,this.privClearTimeout=dt.clearTimeout):"undefined"!==typeof window?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,i)}catch(n){if(i)if(n instanceof Error){const e=n;i(e.name+": "+e.message)}else i(n)}}disconnect(e,t){try{te.throwIfDisposed(this.privIsDisposed),void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then((()=>{e&&e()}),(e=>{t&&t(e)}))}catch(i){if(t)if(i instanceof Error){const e=i;t(e.name+": "+e.message)}else t(i);this.dispose(!0).catch((e=>{G.instance.onEvent(new ue(e))}))}}sendRequest(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,i)}catch(n){if(i)if(n instanceof Error){const e=n;i(e.name+": "+e.message)}else i(n);this.dispose(!0).catch((e=>{G.instance.onEvent(new ue(e))}))}}onToken(e){this.privConversation.onToken(e)}close(){return Xr(this,void 0,void 0,(function*(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,yield this.dispose(!0))}))}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Xr(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){return new $r(e,t,i,n,this)}sendMessage(e,t,i){((e,t,i)=>{void 0!==e?e.then((()=>{try{t&&t()}catch(e){i&&i("'Unhandled error on promise callback: ".concat(e,"'"))}}),(e=>{try{i&&i(e)}catch(t){}})):i&&i("Null promise")})(this.privReco.sendMessageAsync(e),t,i),this.resetConversationTimeout()}resetConversationTimeout(){void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout((()=>{this.sendRequest(this.privConversation.getKeepAlive())}),6e4)}}class to extends xe{constructor(e,t,i){super(i),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}}!function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(Yr||(Yr={}));class io extends De{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class no{constructor(e){this.privUserId=e}get userId(){return this.privUserId}}class ro{constructor(e,t,i,n,r,o,s,a){this.privId=e,this.privAvatar=t,this.privDisplayName=i,this.privIsHost=n,this.privIsMuted=r,this.privIsUsingTts=o,this.privPreferredLanguage=s,this.privVoice=a,this.privProperties=new ot}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,i){return new ro(e,"",e,!1,!1,!1,t,i)}}var oo=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class so{constructor(){}static createConversationAsync(e,t,i,n){let r,o,s;return te.throwIfNullOrUndefined(e,ur.restErrors.invalidArgs.replace("{arg}","config")),te.throwIfNullOrUndefined(e.region,ur.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),e.subscriptionKey||e.getProperty(Ze[Ze.SpeechServiceAuthorization_Token])||te.throwIfNullOrUndefined(e.subscriptionKey,ur.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key")),"string"===typeof t?(r=new ao(e,t),k((()=>oo(this,void 0,void 0,(function*(){})))(),i,n)):(r=new ao(e),o=t,s=i,r.createConversationAsync((()=>{o&&o()}),(e=>{s&&s(e)}))),r}}class ao extends so{constructor(e,t){super(),this.privErrors=ur.restErrors,this.onConnected=e=>{var t;this.privIsConnected=!0;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStarted)&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,e)}catch(e){}},this.onDisconnected=e=>{var t;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStopped)&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,e)}catch(e){}finally{this.close(!1)}},this.onCanceled=(e,t)=>{var i;try{(null===(i=this.privConversationTranslator)||void 0===i?void 0:i.canceled)&&this.privConversationTranslator.canceled(this.privConversationTranslator,t)}catch(t){}},this.onParticipantUpdateCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.id);if(void 0!==e){switch(t.key){case mr:e.displayName=t.value;break;case Pr:e.isUsingTts=t.value;break;case Rr:e.profanity=t.value;break;case Cr:e.isMuted=t.value;break;case br:e.translateToLanguages=t.value}this.privParticipants.addOrUpdateParticipant(e),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.Updated,[this.toParticipant(e)],t.sessionId))}}catch(t){}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(e,t)=>{try{this.privParticipants.participants.forEach((e=>e.isMuted=!e.isHost&&t.isMuted)),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.Updated,this.toParticipants(!1),t.sessionId))}catch(t){}},this.onParticipantJoinCommandReceived=(e,t)=>{try{const e=this.privParticipants.addOrUpdateParticipant(t.participant);void 0!==e&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.JoinedConversation,[this.toParticipant(e)],t.sessionId))}catch(t){}},this.onParticipantLeaveCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.participant.id);void 0!==e&&(this.privParticipants.deleteParticipant(t.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.LeftConversation,[this.toParticipant(e)],t.sessionId)))}catch(t){}},this.onTranslationReceived=(e,t)=>{try{switch(t.command){case dr:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId));break;case fr:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId));break;case hr:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId))}}catch(t){}},this.onParticipantsListReceived=(e,t)=>{var i;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(this.privRoom.token=t.sessionToken),this.privParticipants.participants=[...t.participants],void 0!==this.privParticipants.me&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.JoinedConversation,this.toParticipants(!0),t.sessionId)),this.me.isHost){const e=null===(i=this.privConversationTranslator)||void 0===i?void 0:i.properties.getProperty(Ze.ConversationTranslator_Name);void 0!==e&&e.length>0&&e!==this.me.displayName&&this.changeNicknameAsync(e)}}catch(t){}},this.onConversationExpiration=(e,t)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,t)}catch(t){}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new ot,this.privManager=new Ar;if(e.getProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage])||e.setProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage],ur.defaultLanguageCode),this.privLanguage=e.getProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{0===e.targetLanguages.length&&e.addTargetLanguage(this.privLanguage);e.getProperty(Ze[Ze.SpeechServiceResponse_ProfanityOption])||e.setProfanity(et.Masked);let t=e.getProperty(Ze[Ze.ConversationTranslator_Name]);void 0!==t&&null!==t||(t="Host"),te.throwIfNullOrTooLong(t,"nickname",50),te.throwIfNullOrTooShort(t,"nickname",2),e.setProperty(Ze[Ze.ConversationTranslator_Name],t)}this.privConfig=e;const i=e;te.throwIfNull(i,"speechConfig"),this.privProperties=i.properties.clone(),this.privIsConnected=!1,this.privParticipants=new pr,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const e=this.conversationId,t=this.participants.map((e=>({id:e.id,preferredLanguage:e.preferredLanguage,voice:e.voice}))),i={};for(const n of ur.transcriptionEventKeys){const e=this.properties.getProperty(n,"");""!==e&&(i[n]=e)}return{id:e,participants:t,conversationProperties:i}}get canSend(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)}get canSendAsHost(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}onToken(e){this.privConversationTranslator.onToken(e)}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,(i=>{i||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=i,this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=Zr.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}addParticipantAsync(e,t,i){te.throwIfNullOrUndefined(e,"Participant"),k(this.addParticipantImplAsync(e),t,i)}joinConversationAsync(e,t,i,n,r){try{te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),te.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),te.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,(e=>{te.throwIfNullOrUndefined(e,this.privErrors.permissionDeniedConnect),this.privRoom=e,this.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,n&&n(e.cognitiveSpeechAuthToken)}),(e=>{this.handleError(e,r)}))}catch(o){this.handleError(o,r)}}deleteConversationAsync(e,t){k(this.deleteConversationImplAsync(),e,t)}deleteConversationImplAsync(){return oo(this,void 0,void 0,(function*(){te.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),te.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}))}endConversationAsync(e,t){k(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}muteAllParticipantsAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}muteParticipantAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}removeParticipantAsync(e,t,i){try{if(te.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))k(this.removeParticipantImplAsync(e),t,i);else{te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),i);let n="";if("string"===typeof e)n=e;else if(e.hasOwnProperty("id")){n=e.id}else if(e.hasOwnProperty("userId")){n=e.userId}te.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId"));-1===this.participants.findIndex((e=>e.id===n))&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}}catch(n){this.handleError(n,i)}}unlockConversationAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}unmuteAllParticipantsAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}unmuteParticipantAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}sendTextMessageAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}setTranslatedLanguagesAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}changeNicknameAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return oo(this,void 0,void 0,(function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this}))}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:vr})}addParticipantImplAsync(e){if(void 0!==this.privParticipants.addOrUpdateParticipant(e)&&this.privTranscriberRecognizer){const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}close(e){var t;return oo(this,void 0,void 0,(function*(){try{this.privIsConnected=!1,yield null===(t=this.privConversationRecognizer)||void 0===t?void 0:t.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(i){throw i}e&&this.dispose()}))}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e)}toParticipants(e){const t=this.privParticipants.participants.map((e=>this.toParticipant(e)));return e?t:t.filter((e=>!1===e.isHost))}toParticipant(e){return new ro(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:wr,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getMuteCommand(e,t){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:Cr,participantId:e,roomid:this.privRoom.roomId,type:gr,value:t})}getLockCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:Sr,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getEjectCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:yr,participantId:e,roomid:this.privRoom.roomId,type:gr})}getSetTranslateToLanguagesCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:br,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getChangeNicknameCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(e,"nickname"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:mr,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getMessageCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),te.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:hr})}}class co extends oi{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,i){let n=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);const r=e.parameters.getProperty(Ze.SpeechServiceConnection_Region,"centralus"),o="wss://transcribe."+r+".cts.speech"+oi.getHostSuffix(r)+this.multiaudioRelativeUri,s=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,o),a={};this.setQueryParams(a,e,n),n||(n=s);const c={};void 0!==t.token&&""!==t.token&&(c[t.headerName]=t.token),c[Lt.ConnectionId]=i,e.parameters.setProperty(Ze.SpeechServiceConnection_Url,n);const l="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(n,a,c,new si,ni.fromRecognizerConfig(e),l,i)}setQueryParams(e,t,i){const n=t.parameters.getProperty(Ze.SpeechServiceConnection_EndpointId,void 0),r=t.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,void 0);n&&!(ri.CustomSpeechDeploymentId in e)&&(e[ri.CustomSpeechDeploymentId]=n),r&&!(ri.Language in e)&&(e[ri.Language]=r);const o="true"===t.parameters.getProperty(Ze.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase(),s=t.parameters.getProperty(Ge,be[be.Simple])!==be[be.Simple];(o||s)&&(e[ri.Format]=be[be.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,i)}}class lo extends oi{constructor(e){super(),te.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,i){const n="TRUE"===e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase(),r=this.privConvGetter().room,o=r.cognitiveSpeechRegion||e.parameters.getProperty(Ze.SpeechServiceConnection_Region,""),s={hostSuffix:oi.getHostSuffix(o),path:lo.CTS_VIRT_MIC_PATH,region:encodeURIComponent(o)};s[ri.Language]=encodeURIComponent(e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,"")),s[ri.CtsMeetingId]=encodeURIComponent(r.roomId),s[ri.CtsDeviceId]=encodeURIComponent(r.participantId),s[ri.CtsIsParticipant]=r.isHost?"":"&"+ri.CtsIsParticipant;let a="";const c={},l={};if(n){if(a=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint),!a){a="wss://"+e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"}a=Ti.formatString(a,s);const t=new URL(a);t.searchParams.forEach(((e,t)=>{c[t]=e}));(new co).setQueryParams(c,e,a),c[ri.CtsMeetingId]=s[ri.CtsMeetingId],c[ri.CtsDeviceId]=s[ri.CtsDeviceId],r.isHost||(c[ri.CtsIsParticipant]=""),ri.Format in c||(c[ri.Format]="simple"),t.searchParams.forEach(((e,i)=>{t.searchParams.set(i,c[i]),delete c[i]})),a=t.toString()}else{const t=new ki;a=t.getEndpointUrl(e,!0),a=Ti.formatString(a,s),t.setQueryParams(c,e,a)}l[Lt.ConnectionId]=i,l[lr.configParams.token]=r.token,t.token&&(l[t.headerName]=t.token);const u="TRUE"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase();return new ii(a,c,l,new si,ni.fromRecognizerConfig(e),u,i)}}lo.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio";class uo{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e)}}var po,ho=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.Inactive=0]="Inactive",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(po||(po={}));class vo extends un{constructor(e,t,i,n){super(e,t,new lo(n)),this.privSpeechState=po.Inactive,i&&(this.privTranslator=i,this.sessionStarted=()=>{this.privSpeechState=po.Connected},this.sessionStopped=()=>{this.privSpeechState=po.Inactive},this.recognizing=(e,t)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,t)},this.recognized=(e,t)=>ho(this,void 0,void 0,(function*(){var e;(null===(e=t.result)||void 0===e?void 0:e.errorDetails)?(yield this.cancelSpeech(),this.fireCancelEvent(t.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,t)})),this.canceled=()=>ho(this,void 0,void 0,(function*(){if(this.privSpeechState!==po.Inactive)try{yield this.cancelSpeech()}catch(e){this.privSpeechState=po.Inactive}})))}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}set authentication(e){this.privReco.authentication=e}onConnection(){this.privSpeechState=po.Connected}onCancelSpeech(){return ho(this,void 0,void 0,(function*(){this.privSpeechState=po.Inactive,yield this.cancelSpeech()}))}fireCancelEvent(e){try{if(this.privTranslator.canceled){const t=new zr(Re.Error,e,nt.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch(t){}}cancelSpeech(){var e;return ho(this,void 0,void 0,(function*(){try{this.stopContinuousRecognitionAsync(),yield null===(e=this.privReco)||void 0===e?void 0:e.disconnect(),this.privSpeechState=po.Inactive}catch(t){}}))}}class fo extends uo{constructor(e){super(e),this.privErrors=ur.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new ot}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var e;return null===(e=this.privConversation)||void 0===e?void 0:e.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer)&&(!this.privIsSpeaking&&this.privCTRecognizer.state!==po.Connected&&this.privCTRecognizer.state!==po.Connecting&&!this.privConversation.isMutedByHost)}onToken(e){this.privCTRecognizer.authentication=e}setServiceProperty(e,t){const i=JSON.parse(this.privProperties.getProperty($e,"{}"));i[e]=t,this.privProperties.setProperty($e,JSON.stringify(i))}joinConversationAsync(e,t,i,n,r){try{if("string"===typeof e){te.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),te.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),r);let o=i;void 0!==o&&null!==o&&""!==o||(o=ur.defaultLanguageCode),this.privSpeechTranslationConfig=ct.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(et.Masked),this.privSpeechTranslationConfig.addTargetLanguage(o),this.privSpeechTranslationConfig.setProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage],o),this.privSpeechTranslationConfig.setProperty(Ze[Ze.ConversationTranslator_Name],t);const s=[Ze.SpeechServiceConnection_Host,Ze.ConversationTranslator_Host,Ze.SpeechServiceConnection_Endpoint,Ze.SpeechServiceConnection_ProxyHostName,Ze.SpeechServiceConnection_ProxyPassword,Ze.SpeechServiceConnection_ProxyPort,Ze.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const e of s){const t=this.privProperties.getProperty(e);if(t){const i="string"===typeof e?e:Ze[e];this.privSpeechTranslationConfig.setProperty(i,t)}}const a=JSON.parse(this.privProperties.getProperty($e,"{}"));for(const e of Object.keys(a))this.privSpeechTranslationConfig.setServiceProperty(e,a[e],xn.UriQueryParameter);this.privConversation=new ao(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,o,(e=>{e||this.handleError(new Error(this.privErrors.permissionDeniedConnect),r),this.privSpeechTranslationConfig.authorizationToken=e,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(n,r)}),(e=>{this.handleError(e,r)}))}),(e=>{this.handleError(e,r)}))}else"object"===typeof e?(te.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),te.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(Ze.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,te.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),te.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(i,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(o){this.handleError(o,"string"===typeof i?r:n)}}leaveConversationAsync(e,t){k((()=>ho(this,void 0,void 0,(function*(){yield this.cancelSpeech(),yield this.privConversation.endConversationImplAsync(),yield this.privConversation.deleteConversationImplAsync(),this.dispose()})))(),e,t)}sendTextMessageAsync(e,t,i){try{te.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,i)}catch(n){this.handleError(n,i)}}startTranscribingAsync(e,t){k((()=>ho(this,void 0,void 0,(function*(){try{te.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),te.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),void 0===this.privCTRecognizer&&(yield this.connectTranslatorRecognizer()),te.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),yield this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(e){throw this.privIsSpeaking=!1,yield this.cancelSpeech(),e}})))(),e,t)}stopTranscribingAsync(e,t){k((()=>ho(this,void 0,void 0,(function*(){try{if(!this.privIsSpeaking)return void(yield this.cancelSpeech());this.privIsSpeaking=!1,yield new Promise(((e,t)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(e,t)}))}catch(e){yield this.cancelSpeech()}})))(),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,i){k((()=>ho(this,void 0,void 0,(function*(){this.isDisposed&&!this.privIsSpeaking||(yield this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})))(),t,i)}cancelSpeech(){var e;return ho(this,void 0,void 0,(function*(){try{this.privIsSpeaking=!1,yield null===(e=this.privCTRecognizer)||void 0===e?void 0:e.onCancelSpeech(),this.privCTRecognizer=void 0}catch(t){}}))}connectTranslatorRecognizer(){return ho(this,void 0,void 0,(function*(){try{void 0===this.privAudioConfig&&(this.privAudioConfig=Te.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(Ze[Ze.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(Ze[Ze.SpeechServiceConnection_Key],"");const e=()=>this.privConversation;this.privCTRecognizer=new vo(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw yield this.cancelSpeech(),e}}))}startContinuousRecognition(){return new Promise(((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)}))}}class go extends oi{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(e,t,i){let n=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);const r=e.parameters.getProperty(Ze.SpeechServiceConnection_Region,void 0),o=oi.getHostSuffix(r),s=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://"+r+".stt.speech"+o),a={},c=e.parameters.getProperty(Ze.SpeechServiceConnection_EndpointId,void 0),l=e.parameters.getProperty(Ze.SpeechServiceConnection_RecoLanguage,void 0);c?n&&-1!==n.search(ri.CustomSpeechDeploymentId)||(a[ri.CustomSpeechDeploymentId]=c):l&&(n&&-1!==n.search(ri.Language)||(a[ri.Language]=l)),void 0!==e.autoDetectSourceLanguages&&(a[ri.EnableLanguageId]="true"),this.setV2UrlParams(e,a,n),n||(n="".concat(s).concat(this.universalUri));const u={};void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u[Lt.ConnectionId]=i;const p="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),d=new ii(n,a,u,new si,ni.fromRecognizerConfig(e),p,i),h=d.uri;return e.parameters.setProperty(Ze.SpeechServiceConnection_Url,h),d}setV2UrlParams(e,t,i){new Map([[Ze.Speech_SegmentationSilenceTimeoutMs,ri.SegmentationSilenceTimeoutMs],[Ze.SpeechServiceConnection_EnableAudioLogging,ri.EnableAudioLogging],[Ze.SpeechServiceConnection_EndSilenceTimeoutMs,ri.EndSilenceTimeoutMs],[Ze.SpeechServiceConnection_InitialSilenceTimeoutMs,ri.InitialSilenceTimeoutMs],[Ze.SpeechServiceResponse_PostProcessingOption,ri.Postprocessing],[Ze.SpeechServiceResponse_ProfanityOption,ri.Profanity],[Ze.SpeechServiceResponse_StablePartialResultThreshold,ri.StableIntermediateThreshold]]).forEach(((n,r)=>{this.setUrlParameter(r,n,e,t,i)}));const n=JSON.parse(e.parameters.getProperty($e,"{}"));Object.keys(n).forEach((e=>{t[e]=n[e]}))}}class mo extends Ne{constructor(e,t,i,n,r,o,s,a,c,l,u){super(e,t,i,n,r,o,s,c,l,u),this.privSpeakerId=a}get speakerId(){return this.privSpeakerId}}class yo extends We{}var So=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Co extends Ut{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privConversationTranscriber=r,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const e=this.privSpeechContext.getSection("phraseDetection");e.mode="Conversation";const t={mode:"Anonymous"};t.audioSessionId=this.privDiarizationSessionId,t.audioOffsetMs=0,e.speakerDiarization=t,this.privSpeechContext.setSection("phraseDetection",e)}}processTypeSpecificMessages(e){return So(this,void 0,void 0,(function*(){let t;const i=new ot;i.setProperty(Ze.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const o=ci.fromJSON(e.textBody),s=o.Offset+this.privRequestSession.currentTurnAudioOffset;t=new mo(this.privRequestSession.requestId,Pe.RecognizingSpeech,o.Text,o.Duration,s,o.Language,o.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(s);const a=new Ue(t,o.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,a)}catch(r){}n=!0;break;case"speech.phrase":const c=pi.fromJSON(e.textBody),l=di.implTranslateRecognitionResult(c.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),Pe.Canceled===l){const e=di.implTranslateCancelResult(c.RecognitionStatus),t=di.implTranslateCancelErrorCode(c.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,di.implTranslateErrorDetails(t))}else if(!this.privRequestSession.isSpeechEnded||l!==Pe.NoMatch||c.RecognitionStatus===ui.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(Ge)===be[be.Simple])t=new mo(this.privRequestSession.requestId,l,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,e.textBody,i);else{const n=hi.fromJSON(e.textBody),r=n.Offset+this.privRequestSession.currentTurnAudioOffset,o=n.getJsonWithCorrectedOffsets(r);t=new mo(this.privRequestSession.requestId,l,n.RecognitionStatus===ui.Success?n.NBest[0].Display:void 0,n.Duration,r,n.Language,n.LanguageDetectionConfidence,c.SpeakerId,void 0,o,i)}const n=new Ue(t,t.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,n)}catch(r){}}n=!0}return n}))}cancelRecognition(e,t,i,n,r){if((new ot).setProperty(Qe,nt[n]),this.privConversationTranscriber.canceled){const t=new yo(i,r,n,void 0,e);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,t)}catch(o){}}}}var wo=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Ro extends Vt{constructor(e,t){const i=e;te.throwIfNull(i,"speechConfig"),te.throwIfNullOrWhitespace(i.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage),Ze[Ze.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new go),this.privProperties.setProperty(Ze.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){const n=e;t.properties.mergeTo(n.properties);return new Ro(e,i)}get endpointId(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ge,be[be.Simple])===be[be.Simple]?be.Simple:be.Detailed}get properties(){return this.privProperties}startTranscribingAsync(e,t){k(this.startContinuousRecognitionAsyncImpl(At.Conversation),e,t)}stopTranscribingAsync(e,t){k(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(e,t){te.throwIfDisposed(this.privDisposedRecognizer),k(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return wo(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new _t(e,this.privProperties)}createServiceRecognizer(e,t,i,n){const r=i;return n.isSpeakerDiarizationEnabled=!0,new Co(e,t,r,n,this)}}var bo=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Po{constructor(){}static createMeetingAsync(e,t,i,n){if(te.throwIfNullOrUndefined(e,ur.restErrors.invalidArgs.replace("{arg}","config")),te.throwIfNullOrUndefined(e.region,ur.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),te.throwIfNull(t,"meetingId"),0===t.length)throw new Error("meetingId cannot be empty");e.subscriptionKey||e.getProperty(Ze[Ze.SpeechServiceAuthorization_Token])||te.throwIfNullOrUndefined(e.subscriptionKey,ur.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const r=new Io(e,t);return k((()=>bo(this,void 0,void 0,(function*(){})))(),i,n),r}}class Io extends Po{constructor(e,t){super(),this.privErrors=ur.restErrors,this.onConnected=e=>{var t;this.privIsConnected=!0;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStarted)&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,e)}catch(e){}},this.onDisconnected=e=>{var t;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStopped)&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,e)}catch(e){}finally{this.close(!1)}},this.onCanceled=(e,t)=>{var i;try{(null===(i=this.privConversationTranslator)||void 0===i?void 0:i.canceled)&&this.privConversationTranslator.canceled(this.privConversationTranslator,t)}catch(t){}},this.onParticipantUpdateCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.id);if(void 0!==e){switch(t.key){case mr:e.displayName=t.value;break;case Pr:e.isUsingTts=t.value;break;case Rr:e.profanity=t.value;break;case Cr:e.isMuted=t.value;break;case br:e.translateToLanguages=t.value}this.privParticipants.addOrUpdateParticipant(e),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.Updated,[this.toParticipant(e)],t.sessionId))}}catch(t){}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(e,t)=>{try{this.privParticipants.participants.forEach((e=>e.isMuted=!e.isHost&&t.isMuted)),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.Updated,this.toParticipants(!1),t.sessionId))}catch(t){}},this.onParticipantJoinCommandReceived=(e,t)=>{try{const e=this.privParticipants.addOrUpdateParticipant(t.participant);void 0!==e&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.JoinedConversation,[this.toParticipant(e)],t.sessionId))}catch(t){}},this.onParticipantLeaveCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.participant.id);void 0!==e&&(this.privParticipants.deleteParticipant(t.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.LeftConversation,[this.toParticipant(e)],t.sessionId)))}catch(t){}},this.onTranslationReceived=(e,t)=>{try{switch(t.command){case dr:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId));break;case fr:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId));break;case hr:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new io(t.payload,void 0,t.sessionId))}}catch(t){}},this.onParticipantsListReceived=(e,t)=>{var i;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(this.privRoom.token=t.sessionToken),this.privParticipants.participants=[...t.participants],void 0!==this.privParticipants.me&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new to(Yr.JoinedConversation,this.toParticipants(!0),t.sessionId)),this.me.isHost){const e=null===(i=this.privConversationTranslator)||void 0===i?void 0:i.properties.getProperty(Ze.ConversationTranslator_Name);void 0!==e&&e.length>0&&e!==this.me.displayName&&this.changeNicknameAsync(e)}}catch(t){}},this.onConversationExpiration=(e,t)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,t)}catch(t){}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new ot,this.privManager=new Ar;e.getProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage])||e.setProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage],ur.defaultLanguageCode),this.privLanguage=e.getProperty(Ze[Ze.SpeechServiceConnection_RecoLanguage]),this.privConversationId=t,this.privConfig=e;const i=e;te.throwIfNull(i,"speechConfig"),this.privProperties=i.properties.clone(),this.privIsConnected=!1,this.privParticipants=new pr,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const e=this.meetingId,t=this.participants.map((e=>({id:e.id,preferredLanguage:e.preferredLanguage,voice:e.voice}))),i={};for(const n of ur.transcriptionEventKeys){const e=this.properties.getProperty(n,"");""!==e&&(i[n]=e)}return{id:e,participants:t,meetingProperties:i}}get canSend(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)}get canSendAsHost(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}createMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,(i=>{i||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=i,this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}startMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}addParticipantAsync(e,t,i){te.throwIfNullOrUndefined(e,"Participant"),k(this.addParticipantImplAsync(e),t,i)}joinMeetingAsync(e,t,i,n,r){try{te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),te.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),te.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,(e=>{te.throwIfNullOrUndefined(e,this.privErrors.permissionDeniedConnect),this.privRoom=e,this.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,n&&n(e.cognitiveSpeechAuthToken)}),(e=>{this.handleError(e,r)}))}catch(o){this.handleError(o,r)}}deleteMeetingAsync(e,t){k(this.deleteMeetingImplAsync(),e,t)}deleteMeetingImplAsync(){return bo(this,void 0,void 0,(function*(){te.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),te.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}))}endMeetingAsync(e,t){k(this.endMeetingImplAsync(),e,t)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}muteAllParticipantsAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}muteParticipantAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}removeParticipantAsync(e,t,i){try{if(te.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))k(this.removeParticipantImplAsync(e),t,i);else{te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),i);let n="";if("string"===typeof e)n=e;else if(e.hasOwnProperty("id")){n=e.id}else if(e.hasOwnProperty("userId")){n=e.userId}te.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId"));-1===this.participants.findIndex((e=>e.id===n))&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}}catch(n){this.handleError(n,i)}}unlockMeetingAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}unmuteAllParticipantsAsync(e,t){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(i){this.handleError(i,t)}}unmuteParticipantAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i);-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}sendTextMessageAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}setTranslatedLanguagesAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}changeNicknameAsync(e,t,i){try{te.throwIfDisposed(this.privIsDisposed),te.throwIfDisposed(this.privConversationRecognizer.isDisposed()),te.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),te.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(n){this.handleError(n,i)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return bo(this,void 0,void 0,(function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.meeting=this}))}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:vr})}addParticipantImplAsync(e){if(void 0!==this.privParticipants.addOrUpdateParticipant(e)&&this.privTranscriberRecognizer){const t=this.meetingInfo;return t.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(t,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const t=this.meetingInfo;return t.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(t,"leave")}close(e){var t;return bo(this,void 0,void 0,(function*(){try{this.privIsConnected=!1,yield null===(t=this.privConversationRecognizer)||void 0===t?void 0:t.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(i){throw i}e&&this.dispose()}))}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e)}toParticipants(e){const t=this.privParticipants.participants.map((e=>this.toParticipant(e)));return e?t:t.filter((e=>!1===e.isHost))}toParticipant(e){return new ro(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:wr,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getMuteCommand(e,t){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),te.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:Cr,participantId:e,roomid:this.privRoom.roomId,type:gr,value:t})}getLockCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:Sr,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getEjectCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),te.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:yr,participantId:e,roomid:this.privRoom.roomId,type:gr})}getSetTranslateToLanguagesCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:br,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getChangeNicknameCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),te.throwIfNullOrWhitespace(e,"nickname"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:mr,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:gr,value:e})}getMessageCommand(e){return te.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),te.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),te.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:hr})}}class Eo extends We{}var To=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class ko extends Di{constructor(e,t,i,n,r){super(e,t,i,n,r),this.privTranscriberRecognizer=r,this.sendPrePayloadJSONOverride=e=>this.sendTranscriptionStartJSON(e),"true"===this.privRecognizerConfig.parameters.getProperty(Ze.SpeechServiceResponse_RequestWordLevelTimestamps)&&this.privSpeechContext.setWordLevelTimings()}sendSpeechEventAsync(e,t){return To(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing){const i=yield this.fetchConnection();yield this.sendSpeechEvent(i,this.createSpeechEventPayload(e,t))}}))}sendMeetingSpeechEventAsync(e,t){return To(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing){const i=yield this.fetchConnection();yield this.sendSpeechEvent(i,this.createMeetingSpeechEventPayload(e,t))}}))}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,i){try{const r=new qe(e,t,i);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,r),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(n){this.privErrorCallback&&this.privErrorCallback(n)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch(r){}}handleRecognizingCallback(e,t,i){try{const n=new qe(e,t,i);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,n)}catch(n){}}cancelRecognition(e,t,i,n,r){const o=new ot;if(o.setProperty(Qe,nt[n]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const t=new Eo(i,r,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,t)}catch(s){}}}else if(this.privTranscriberRecognizer.canceled){const t=new yo(i,r,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,t)}catch(a){}}if(this.privSuccessCallback){const e=new _e(t,Pe.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,r,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(c){}}}sendTranscriptionStartJSON(e){return To(this,void 0,void 0,(function*(){if(yield this.sendSpeechContext(e,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const t=this.privTranscriberRecognizer.getMeetingInfo(),i=this.createMeetingSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,i)}else{const t=this.privTranscriberRecognizer.getConversationInfo(),i=this.createSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,i)}yield this.sendWaveHeader(e)}))}sendSpeechEvent(e,t){const i=JSON.stringify(t);if(i)return e.send(new Bt(tt.Text,"speech.event",this.privRequestSession.requestId,"application/json",i))}createSpeechEventPayload(e,t){const i={id:"meeting",name:t,meeting:e.conversationProperties};return i.meeting.id=e.id,i.meeting.attendees=e.participants,i}createMeetingSpeechEventPayload(e,t){const i={id:"meeting",name:t,meeting:e.meetingProperties};return i.meeting.id=e.id,i.meeting.attendees=e.participants,i}}var Ao=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Oo extends Vt{constructor(e,t){const i=e;te.throwIfNull(i,"speechTranslationConfig");const n=t;te.throwIfNull(n,"audioConfigImpl"),te.throwIfNullOrWhitespace(i.speechRecognitionLanguage,Ze[Ze.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new co),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}set conversation(e){te.throwIfNullOrUndefined(e,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=e}getConversationInfo(){return te.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(e){te.throwIfNullOrUndefined(e,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=e}getMeetingInfo(){return te.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(e,t){k(this.startContinuousRecognitionAsyncImpl(At.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){k(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(){return Ao(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(yield this.dispose(!0))}))}pushConversationEvent(e,t){return Ao(this,void 0,void 0,(function*(){const i=this.privReco;te.throwIfNullOrUndefined(i,"serviceRecognizer"),yield i.sendSpeechEventAsync(e,t)}))}pushMeetingEvent(e,t){return Ao(this,void 0,void 0,(function*(){const i=this.privReco;te.throwIfNullOrUndefined(i,"serviceRecognizer"),yield i.sendMeetingSpeechEventAsync(e,t)}))}enforceAudioGating(){return Ao(this,void 0,void 0,(function*(){const e=this.audioConfig,t=(yield e.format).channels;if(1===t){if("true"!==this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase())throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(8!==t)throw new Error("Unsupported audio configuration: Detected ".concat(t,"-channel audio"))}))}connectMeetingCallbacks(e){this.isMeetingRecognizer=!0,this.canceled=(t,i)=>{e.canceled&&e.canceled(e,i)},this.recognizing=(t,i)=>{e.transcribing&&e.transcribing(e,i)},this.recognized=(t,i)=>{e.transcribed&&e.transcribed(e,i)},this.sessionStarted=(t,i)=>{e.sessionStarted&&e.sessionStarted(e,i)},this.sessionStopped=(t,i)=>{e.sessionStopped&&e.sessionStopped(e,i)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Ao(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new _t(e,this.properties)}createServiceRecognizer(e,t,i,n){return new ko(e,t,i,n,this)}}var xo,Do=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class zo{constructor(e){this.privAudioConfig=e,this.privProperties=new ot,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return te.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ze.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return sn.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}joinMeetingAsync(e,t,i){const n=e;te.throwIfNullOrUndefined(Io,"Meeting"),this.privRecognizer=new Oo(e.config,this.privAudioConfig),te.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),k(n.connectTranscriberRecognizer(this.privRecognizer),t,i)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveMeetingAsync(e,t){this.privRecognizer.disconnectCallbacks(),k((()=>Do(this,void 0,void 0,(function*(){})))(),e,t)}close(e,t){te.throwIfDisposed(this.privDisposedRecognizer),k(this.dispose(!0),e,t)}dispose(e){return Do(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(this.privRecognizer&&(yield this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))}))}}!function(e){e[e.Standard=0]="Standard",e[e.Custom=1]="Custom"}(xo||(xo={}));class No{constructor(e,t){this.privSynthesisServiceType=xo.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=e||new s(new a(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}set synthesisVideoSection(e){this.privSpeechServiceConfig.Context.synthesis={video:e}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}var _o,Mo,Lo=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Bo{constructor(e){const t=e;te.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new H}get authorizationToken(){return this.properties.getProperty(Ze.SpeechServiceAuthorization_Token)}set authorizationToken(e){te.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ze.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(Ze.SpeechServiceConnection_AutoDetectSourceLanguages)===Xe}buildSsml(e){const t={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-JennyNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let i=this.properties.getProperty(Ze.SpeechServiceConnection_SynthLanguage,"en-US"),n=this.properties.getProperty(Ze.SpeechServiceConnection_SynthVoice,""),r=Bo.XMLEncode(e);return this.autoDetectSourceLanguage?i="en-US":n=n||t[i],n&&(r="<voice name='".concat(n,"'>").concat(r,"</voice>")),r="<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='".concat(i,"'>").concat(r,"</speak>"),r}dispose(e){return Lo(this,void 0,void 0,(function*(){this.privDisposed||(e&&this.privAdapter&&(yield this.privAdapter.dispose()),this.privDisposed=!0)}))}adapterSpeak(){return Lo(this,void 0,void 0,(function*(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const e=yield this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}}))}createSynthesizerConfig(e){return new No(e,this.privProperties)}implCommonSynthesizeSetup(){let e="undefined"!==typeof window?"Browser":"Node",t="unknown",i="unknown";"undefined"!==typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);const n=this.createSynthesizerConfig(new s(new a(new l(e,t,i)))),r=this.privProperties.getProperty(Ze.SpeechServiceConnection_Key,void 0),o=r&&""!==r?new Wt(r):new Ht((()=>{const e=this.privProperties.getProperty(Ze.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}),(()=>{const e=this.privProperties.getProperty(Ze.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}));this.privAdapter=this.createSynthesisAdapter(o,this.privConnectionFactory,n),this.privRestAdapter=this.createRestSynthesisAdapter(o,n)}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}class qo{constructor(e,t,i,n,r,o){this.requestId=e,this.text=t,this.isSSML=i,this.cb=n,this.err=r,this.dataStream=o}}class Uo{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,i){let n=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);const r=e.parameters.getProperty(Ze.SpeechServiceConnection_Region,void 0),o=oi.getHostSuffix(r),s=e.parameters.getProperty(Ze.SpeechServiceConnection_EndpointId,void 0),a=void 0===s?"tts":"voice",c=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"wss://"+r+"."+a+".speech"+o),l={},u={};void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u[Lt.ConnectionId]=i,void 0!==s&&""!==s&&(n&&-1!==n.search(ri.CustomVoiceDeploymentId)||(l[ri.CustomVoiceDeploymentId]=s)),e.avatarEnabled&&(n&&-1!==n.search(ri.EnableAvatar)||(l[ri.EnableAvatar]="true")),n||(n=c+this.synthesisUri),e.parameters.setProperty(Ze.SpeechServiceConnection_Url,n);const p="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new ii(n,l,u,new si,ni.fromParameters(e.parameters),p,i)}}class Fo{constructor(e){this.privResult=e}get result(){return this.privResult}}class Wo extends Zi{constructor(e,t,i,n,r){super(e,t,i,r),this.privSpeechSynthesizer=n,this.privSynthesizer=n}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(e){const t=new Fo(new Ui(e,Pe.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t)}onSynthesizing(e){if(this.privSpeechSynthesizer.synthesizing)try{const t=this.privSynthesisTurn.audioOutputFormat.addHeader(e),i=new Fo(new Ui(this.privSynthesisTurn.requestId,Pe.SynthesizingAudio,t));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,i)}catch(t){}}onSynthesisCancelled(e){if(this.privSpeechSynthesizer.SynthesisCanceled){const i=new Fo(e);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,i)}catch(t){}}}onSynthesisCompleted(e){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new Fo(e))}catch(t){}}onWordBoundary(e){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch(t){}}onVisemeReceived(e){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch(t){}}onBookmarkReached(e){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,e)}catch(t){}}}class Ho{constructor(e,t){let i=e.parameters.getProperty(Ze.SpeechServiceConnection_Endpoint,void 0);if(!i){const t=e.parameters.getProperty(Ze.SpeechServiceConnection_Region,"westus"),n=oi.getHostSuffix(t);i=e.parameters.getProperty(Ze.SpeechServiceConnection_Host,"https://".concat(t,".tts.speech").concat(n))}this.privUri="".concat(i,"/cognitiveservices/voices/list");const n=lr.requestOptions;this.privRestAdapter=new kr(n),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(Lt.ConnectionId,e),this.privAuthentication.fetch(e).then((e=>(this.privRestAdapter.setHeaders(e.headerName,e.token),this.privRestAdapter.request(Ir.Get,this.privUri))))}}!function(e){e[e.Unknown=0]="Unknown",e[e.Female=1]="Female",e[e.Male=2]="Male"}(_o||(_o={})),function(e){e[e.OnlineNeural=1]="OnlineNeural",e[e.OnlineStandard=2]="OnlineStandard",e[e.OfflineNeural=3]="OfflineNeural",e[e.OfflineStandard=4]="OfflineStandard"}(Mo||(Mo={}));class jo{constructor(e){if(this.privStyleList=[],this.privVoicePath="",e&&(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privDisplayName=e.DisplayName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?Mo.OnlineStandard:Mo.OnlineNeural,this.privGender="Male"===e.Gender?_o.Male:"Female"===e.Gender?_o.Female:_o.Unknown,e.StyleList&&Array.isArray(e.StyleList)))for(const t of e.StyleList)this.privStyleList.push(t)}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get voicePath(){return this.privVoicePath}}class Vo extends qi{constructor(e,t,i){if(Array.isArray(t)){super(e,Pe.VoicesListRetrieved,void 0,new ot),this.privVoices=[];for(const e of t)this.privVoices.push(new jo(e))}else super(e,Pe.Canceled,i||"Error information unavailable",new ot)}get voices(){return this.privVoices}}var Ko,Jo,Go,Qo,$o=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Yo extends Bo{constructor(e,t){super(e),null!==t&&(this.audioConfig=void 0===t?"undefined"===typeof window?void 0:Te.fromDefaultSpeakerOutput():t),this.privConnectionFactory=new Uo,this.implCommonSynthesizeSetup()}static FromConfig(e,t,i){const n=e;return t.properties.mergeTo(n.properties),new Yo(e,i)}speakTextAsync(e,t,i,n){this.speakImpl(e,!1,t,i,n)}speakSsmlAsync(e,t,i,n){this.speakImpl(e,!0,t,i,n)}getVoicesAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $o(this,void 0,void 0,(function*(){return this.getVoices(e)}))}close(e,t){te.throwIfDisposed(this.privDisposed),k(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}createSynthesisAdapter(e,t,i){return new Wo(e,t,i,this,this.audioConfig)}createRestSynthesisAdapter(e,t){return new Ho(t,e)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=pe.fromSpeechSynthesisOutputFormat(ne[this.properties.getProperty(Ze.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(e,t,i,n,r){try{te.throwIfDisposed(this.privDisposed);const o=C();let s;s=r instanceof we?new me(r):r instanceof ve?r:void 0!==r?new Ee(r):void 0,this.synthesisRequestQueue.enqueue(new qo(o,e,t,(e=>{if(this.privSynthesizing=!1,i)try{i(e)}catch(e){n&&n(e)}i=void 0,this.adapterSpeak().catch((()=>{}))}),(e=>{n&&n(e)}),s)),this.adapterSpeak().catch((()=>{}))}catch(o){if(n)if(o instanceof Error){const e=o;n(e.name+": "+e.message)}else n(o);this.dispose(!0).catch((()=>{}))}}getVoices(e){return $o(this,void 0,void 0,(function*(){const t=C(),i=yield this.privRestAdapter.getVoicesList(t);if(i.ok&&Array.isArray(i.json)){let n=i.json;return e&&e.length>0&&(n=n.filter((t=>!!t.Locale&&t.Locale.toLowerCase()===e.toLowerCase()))),new Vo(t,n,void 0)}return new Vo(t,void 0,"Error: ".concat(i.status,": ").concat(i.statusText))}))}}!function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"}(Ko||(Ko={})),function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"}(Jo||(Jo={})),function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"}(Go||(Go={}));class Xo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jo.FivePoint,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Go.Phoneme,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];te.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new ot,this.privProperties.setProperty(Ze.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(Ze.PronunciationAssessment_GradingSystem,Jo[t]),this.privProperties.setProperty(Ze.PronunciationAssessment_Granularity,Go[i]),this.privProperties.setProperty(Ze.PronunciationAssessment_EnableMiscue,String(n))}static fromJSON(e){te.throwIfNullOrUndefined(e,"json");const t=new Xo("");return t.privProperties=new ot,t.properties.setProperty(Ze.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(Ze.PronunciationAssessment_Params)}applyTo(e){this.updateJson();const t=e.internalData;t.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(Ze.PronunciationAssessment_Params),this.privContentAssessmentTopic,t.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(Ze.PronunciationAssessment_ReferenceText)}set referenceText(e){te.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(Ze.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){te.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){const t=e?"true":"false";this.properties.setProperty(Ze.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return"true"===this.properties.getProperty(Ze.PronunciationAssessment_EnableMiscue,"false").toLowerCase()}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}set enableProsodyAssessment(e){this.privEnableProsodyAssessment=e}enableContentAssessmentWithTopic(e){this.privContentAssessmentTopic=e}get properties(){return this.privProperties}updateJson(){const e=this.privProperties.getProperty(Ze.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),i=this.privProperties.getProperty(Ze.PronunciationAssessment_ReferenceText);i&&(t.referenceText=i);const n=this.privProperties.getProperty(Ze.PronunciationAssessment_GradingSystem);n&&(t.gradingSystem=n);const r=this.privProperties.getProperty(Ze.PronunciationAssessment_Granularity);r&&(t.granularity=r),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.enableProsodyAssessment=this.privEnableProsodyAssessment,t.dimension="Comprehensive";this.privProperties.getProperty(Ze.PronunciationAssessment_EnableMiscue)&&(t.enableMiscue=this.enableMiscue),this.privProperties.setProperty(Ze.PronunciationAssessment_Params,JSON.stringify(t))}}class Zo{constructor(e){this.privPronJson=e}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}class es{constructor(e){const t=JSON.parse(e);te.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){te.throwIfNullOrUndefined(e,"result");const t=e.properties.getProperty(Ze.SpeechServiceResponse_JsonResult);return te.throwIfNullOrUndefined(t,"json"),new es(t)}get detailResult(){return this.privPronJson}get accuracyScore(){var e;return null===(e=this.detailResult.PronunciationAssessment)||void 0===e?void 0:e.AccuracyScore}get pronunciationScore(){var e;return null===(e=this.detailResult.PronunciationAssessment)||void 0===e?void 0:e.PronScore}get completenessScore(){var e;return null===(e=this.detailResult.PronunciationAssessment)||void 0===e?void 0:e.CompletenessScore}get fluencyScore(){var e;return null===(e=this.detailResult.PronunciationAssessment)||void 0===e?void 0:e.FluencyScore}get prosodyScore(){var e;return null===(e=this.detailResult.PronunciationAssessment)||void 0===e?void 0:e.ProsodyScore}get contentAssessmentResult(){if(void 0!==this.detailResult.ContentAssessment)return new Zo(this.detailResult)}}class ts{constructor(e,t){this.x=e,this.y=t}}class is{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"H264",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e6,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1080;this.codec=e,this.bitrate=t,this.width=i,this.height=n}setCropRange(e,t){this.cropRange={bottomRight:t,topLeft:e}}}class ns{constructor(e,t,i){this.privCustomized=!1,te.throwIfNullOrWhitespace(e,"character"),this.character=e,this.style=t,void 0===i&&(i=new is),this.videoFormat=i}get customized(){return this.privCustomized}set customized(e){this.privCustomized=e}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(e){this.privBackgroundColor=e}}!function(e){e.SwitchedToSpeaking="SwitchedToSpeaking",e.SwitchedToIdle="SwitchedToIdle",e.SessionClosed="SessionClosed"}(Qo||(Qo={}));class rs{constructor(e,t){this.privOffset=e,this.privDescription=t}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}class os extends Zi{constructor(e,t,i,n,r){super(e,t,i,void 0),this.privAvatarSynthesizer=n,this.privSynthesizer=n,this.privAvatarConfig=r}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var e,t,i,n,r,o,s,a,c,l,u,p,d,h,v,f;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:null===(e=this.privAvatarConfig.videoFormat)||void 0===e?void 0:e.bitrate,codec:null===(t=this.privAvatarConfig.videoFormat)||void 0===t?void 0:t.codec,crop:{bottomRight:{x:null===(r=null===(n=null===(i=this.privAvatarConfig.videoFormat)||void 0===i?void 0:i.cropRange)||void 0===n?void 0:n.bottomRight)||void 0===r?void 0:r.x,y:null===(a=null===(s=null===(o=this.privAvatarConfig.videoFormat)||void 0===o?void 0:o.cropRange)||void 0===s?void 0:s.bottomRight)||void 0===a?void 0:a.y},topLeft:{x:null===(u=null===(l=null===(c=this.privAvatarConfig.videoFormat)||void 0===c?void 0:c.cropRange)||void 0===l?void 0:l.topLeft)||void 0===u?void 0:u.x,y:null===(h=null===(d=null===(p=this.privAvatarConfig.videoFormat)||void 0===p?void 0:p.cropRange)||void 0===d?void 0:d.topLeft)||void 0===h?void 0:h.y}},resolution:{height:null===(v=this.privAvatarConfig.videoFormat)||void 0===v?void 0:v.height,width:null===(f=this.privAvatarConfig.videoFormat)||void 0===f?void 0:f.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(Ze.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style}}}onAvatarEvent(e){if(this.privAvatarSynthesizer.avatarEventReceived){const i=new rs(e.Data.Offset,e.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,i)}catch(t){}}}}var ss=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class as extends Bo{constructor(e,t){super(e),te.throwIfNullOrUndefined(t,"avatarConfig"),this.privConnectionFactory=new Uo,this.privAvatarConfig=t,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=pe.fromSpeechSynthesisOutputFormat(ne.Riff24Khz16BitMonoPcm)}startAvatarAsync(e){return ss(this,void 0,void 0,(function*(){te.throwIfNullOrUndefined(e,"peerConnection"),this.privIceServers=e.getConfiguration().iceServers,te.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const t=new T;e.onicegatheringstatechange=()=>{G.instance.onEvent(new A("peer connection: ice gathering state: "+e.iceGatheringState,E.Debug)),"complete"===e.iceGatheringState&&(G.instance.onEvent(new A("peer connection: ice gathering complete.",E.Info)),t.resolve())};const i=yield e.createOffer();yield e.setLocalDescription(i),yield t.promise,G.instance.onEvent(new A("peer connection: got local SDP.",E.Info)),this.privProperties.setProperty(Ze.TalkingAvatarService_WebRTC_SDP,JSON.stringify(e.localDescription));const n=yield this.speak("",!1),r=atob(n.properties.getProperty(Ze.TalkingAvatarService_WebRTC_SDP)),o=new RTCSessionDescription(JSON.parse(r));return yield e.setRemoteDescription(o),new qi(n.resultId,n.reason,void 0,n.properties)}))}speakTextAsync(e){return ss(this,void 0,void 0,(function*(){const t=yield this.speak(e,!1);return new qi(t.resultId,t.reason,t.errorDetails,t.properties)}))}speakSsmlAsync(e){return ss(this,void 0,void 0,(function*(){const t=yield this.speak(e,!0);return new qi(t.resultId,t.reason,t.errorDetails,t.properties)}))}stopSpeakingAsync(){return ss(this,void 0,void 0,(function*(){return this.privAdapter.stopSpeaking()}))}stopAvatarAsync(){return ss(this,void 0,void 0,(function*(){return te.throwIfDisposed(this.privDisposed),this.dispose(!0)}))}close(){return ss(this,void 0,void 0,(function*(){if(!this.privDisposed)return this.dispose(!0)}))}get iceServers(){return this.privIceServers}createSynthesisAdapter(e,t,i){return new os(e,t,i,this,this.privAvatarConfig)}createRestSynthesisAdapter(e,t){}createSynthesizerConfig(e){const t=super.createSynthesizerConfig(e);return t.avatarEnabled=!0,t}speak(e,t){return ss(this,void 0,void 0,(function*(){const i=C(),n=new T;return this.synthesisRequestQueue.enqueue(new qo(i,e,t,(e=>{n.resolve(e),this.privSynthesizing=!1,this.adapterSpeak()}),(e=>{n.reject(e),this.privSynthesizing=!1}))),this.adapterSpeak(),n.promise}))}}class cs extends qi{constructor(e,t,i,n,r){super(t,i,n,r),this.privSDPAnswer=e}get SDPAnswer(){return this.privSDPAnswer}}var ls=i(271);class us{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.None;this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){te.throwIfNullOrUndefined(ls.openSync,"\nFile System access not available"),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){const t=this.toString(e);if(this.privLogPath&&ls.writeFileSync(this.privLogPath,t+"\n",{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case E.Debug:console.debug(t);break;case E.Info:console.info(t);break;case E.Warning:console.warn(t);break;case E.Error:console.error(t);break;default:console.log(t)}}}toString(e){const t=["".concat(e.eventTime),"".concat(e.name)],i=e;for(const n in i)if(n&&e.hasOwnProperty(n)&&"eventTime"!==n&&"eventType"!==n&&"eventId"!==n&&"name"!==n&&"constructor"!==n){const e=i[n];let r="<NULL>";void 0!==e&&null!==e&&(r="number"===typeof e||"string"===typeof e?e.toString():JSON.stringify(e)),t.push("".concat(n,": ").concat(r))}return t.join(" | ")}}class ps{static SetLoggingLevel(e){this.privListener=new us(e),G.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if("undefined"!==typeof window)throw new Error("File system logging not available in browser.");this.privListener&&(this.privListener.logPath=e)}}ps.privListener=void 0,new n}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.m=e,i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>"static/js/"+e+".1c860e1a.chunk.js",i.miniCssF=e=>{},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="prototype_chatgpt_voice_assistant:";i.l=(n,r,o,s)=>{if(e[n])e[n].push(r);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var p=l[u];if(p.getAttribute("src")==n||p.getAttribute("data-webpack")==t+o){a=p;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+o),a.src=n),e[n]=[r];var d=(t,i)=>{a.onerror=a.onload=null,clearTimeout(h);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),t)return t(i)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/ChatGPT-voice-assistant/",(()=>{i.b=document.baseURI||self.location.href;var e={179:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((i,n)=>r=e[t]=[i,n]));n.push(r[2]=o);var s=i.p+i.u(t),a=new Error;i.l(s,(n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,s=n[0],a=n[1],c=n[2],l=0;if(s.some((t=>0!==e[t]))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(c)c(i)}for(t&&t(n);l<s.length;l++)o=s[l],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkprototype_chatgpt_voice_assistant=self.webpackChunkprototype_chatgpt_voice_assistant||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=i(791),t=i(250);function n(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}Object.create;function r(e){var t="function"===typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e){return this instanceof o?(this.v=e,this):new o(e)}function s(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){r[e]&&(n[e]=function(t){return new Promise((function(i,n){s.push([e,t,i,n])>1||c(e,t)}))})}function c(e,t){try{(i=r[e](t)).value instanceof o?Promise.resolve(i.value.v).then(l,u):p(s[0][2],i)}catch(n){p(s[0][3],n)}var i}function l(e){c("next",e)}function u(e){c("throw",e)}function p(e,t){e(t),s.shift(),s.length&&c(s[0][0],s[0][1])}}function a(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=r(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,r,(t=e[i](t)).done,t.value)}))}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;function c(e){const t=e;return t&&"function"===typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}const l=new WeakMap,u=new WeakMap;class p{constructor(){this.onabort=null,l.set(this,[]),u.set(this,!1)}get aborted(){if(!u.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return u.get(this)}static get none(){return new p}addEventListener(e,t){if(!l.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");l.get(this).push(t)}removeEventListener(e,t){if(!l.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");const i=l.get(this),n=i.indexOf(t);n>-1&&i.splice(n,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}function d(e){if(e.aborted)return;e.onabort&&e.onabort.call(e);const t=l.get(e);t&&t.slice().forEach((t=>{t.call(e,{type:"abort"})})),u.set(e,!0)}class h extends Error{constructor(e){super(e),this.name="AbortError"}}class v{constructor(e){if(this._signal=new p,e){Array.isArray(e)||(e=arguments);for(const t of e)t.aborted?this.abort():t.addEventListener("abort",(()=>{this.abort()}))}}get signal(){return this._signal}abort(){d(this._signal)}static timeout(e){const t=new p,i=setTimeout(d,e,t);return"function"===typeof i.unref&&i.unref(),t}}const f="The operation was aborted.";function g(e,t,i){return new Promise(((n,r)=>{let o,s;const a=()=>r(new h((null===i||void 0===i?void 0:i.abortErrorMsg)?null===i||void 0===i?void 0:i.abortErrorMsg:f)),c=()=>{(null===i||void 0===i?void 0:i.abortSignal)&&s&&i.abortSignal.removeEventListener("abort",s)};if(s=()=>(o&&clearTimeout(o),c(),a()),(null===i||void 0===i?void 0:i.abortSignal)&&i.abortSignal.aborted)return a();o=setTimeout((()=>{c(),n(t)}),e),(null===i||void 0===i?void 0:i.abortSignal)&&i.abortSignal.addEventListener("abort",s)}))}function m(e,t){const i=e.headers.get(t);if(!i)return;const n=Number(i);return Number.isNaN(n)?void 0:n}const y={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function S(e,t){let i,n=null,r=null;const o=Object.assign(Object.assign({},y),t),s={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!s.isRefreshing&&(null!==(e=null===r||void 0===r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function a(t,a){var c;if(!s.isRefreshing){n=async function(e,t,i){async function n(){if(!(Date.now()<i)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(c){return null}}let r=await n();for(;null===r;)await g(t),r=await n();return r}((()=>e.getToken(t,a)),o.retryIntervalInMs,null!==(c=null===r||void 0===r?void 0:r.expiresOnTimestamp)&&void 0!==c?c:Date.now()).then((e=>(n=null,r=e,i=a.tenantId,r))).catch((e=>{throw n=null,r=null,i=void 0,e}))}return n}return async(e,t)=>i!==t.tenantId||Boolean(t.claims)||s.mustRefresh?a(e,t):(s.shouldRefresh&&a(e,t),r)}const C="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/ChatGPT-voice-assistant",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AZURE_OPENAI_KEY:"c0e8d1c95a55474495f27c9ab0a35694",REACT_APP_AZURE_OPENAI_ENDPOINT:"https://ba-accessible-gpt.openai.azure.com/",REACT_APP_SPEECH_KEY:"e42991f6a18840af955012c5924708b2",REACT_APP_SPEECH_REGION:"switzerlandnorth"}&&{NODE_ENV:"production",PUBLIC_URL:"/ChatGPT-voice-assistant",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AZURE_OPENAI_KEY:"c0e8d1c95a55474495f27c9ab0a35694",REACT_APP_AZURE_OPENAI_ENDPOINT:"https://ba-accessible-gpt.openai.azure.com/",REACT_APP_SPEECH_KEY:"e42991f6a18840af955012c5924708b2",REACT_APP_SPEECH_REGION:"switzerlandnorth"}.DEBUG||void 0;let w,R=[],b=[];const P=[];C&&E(C);const I=Object.assign((e=>k(e)),{enable:E,enabled:T,disable:function(){const e=w||"";return E(""),e},log:function(){if(arguments.length>0){const e=String(arguments.length<=0?void 0:arguments[0]);e.includes(":error")?console.error(...arguments):e.includes(":warning")?console.warn(...arguments):e.includes(":info")?console.info(...arguments):(e.includes(":verbose"),console.debug(...arguments))}}});function E(e){w=e,R=[],b=[];const t=/\*/g,i=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const n of i)n.startsWith("-")?b.push(new RegExp("^".concat(n.substr(1),"$"))):R.push(new RegExp("^".concat(n,"$")));for(const n of P)n.enabled=T(n.namespace)}function T(e){if(e.endsWith("*"))return!0;for(const t of b)if(t.test(e))return!1;for(const t of R)if(t.test(e))return!0;return!1}function k(e){const t=Object.assign((function(){if(!t.enabled)return;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];n.length>0&&(n[0]="".concat(e," ").concat(n[0]));t.log(...n)}),{enabled:T(e),destroy:A,log:I.log,namespace:e,extend:O});return P.push(t),t}function A(){const e=P.indexOf(this);return e>=0&&(P.splice(e,1),!0)}function O(e){const t=k("".concat(this.namespace,":").concat(e));return t.log=this.log,t}const x=I,D=new Set,z="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/ChatGPT-voice-assistant",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AZURE_OPENAI_KEY:"c0e8d1c95a55474495f27c9ab0a35694",REACT_APP_AZURE_OPENAI_ENDPOINT:"https://ba-accessible-gpt.openai.azure.com/",REACT_APP_SPEECH_KEY:"e42991f6a18840af955012c5924708b2",REACT_APP_SPEECH_REGION:"switzerlandnorth"}&&{NODE_ENV:"production",PUBLIC_URL:"/ChatGPT-voice-assistant",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AZURE_OPENAI_KEY:"c0e8d1c95a55474495f27c9ab0a35694",REACT_APP_AZURE_OPENAI_ENDPOINT:"https://ba-accessible-gpt.openai.azure.com/",REACT_APP_SPEECH_KEY:"e42991f6a18840af955012c5924708b2",REACT_APP_SPEECH_REGION:"switzerlandnorth"}.AZURE_LOG_LEVEL||void 0;let N;const _=x("azure");_.log=function(){x.log(...arguments)};const M=["verbose","info","warning","error"];z&&(W(z)?function(e){if(e&&!W(e))throw new Error("Unknown log level '".concat(e,"'. Acceptable values: ").concat(M.join(",")));N=e;const t=[];for(const i of D)F(i)&&t.push(i.namespace);x.enable(t.join(","))}(z):console.error("AZURE_LOG_LEVEL set to unknown log level '".concat(z,"'; logging is not enabled. Acceptable values: ").concat(M.join(", "),".")));const L={verbose:400,info:300,warning:200,error:100};function B(e){const t=_.extend(e);return q(_,t),{error:U(t,"error"),warning:U(t,"warning"),info:U(t,"info"),verbose:U(t,"verbose")}}function q(e,t){t.log=function(){e.log(...arguments)}}function U(e,t){const i=Object.assign(e.extend(t),{level:t});if(q(e,i),F(i)){const e=x.disable();x.enable(e+","+i.namespace)}return D.add(i),i}function F(e){return Boolean(N&&L[e.level]<=L[N])}function W(e){return M.includes(e)}const H=B("core-rest-pipeline"),j="bearerTokenAuthenticationPolicy";async function V(e){const{scopes:t,getAccessToken:i,request:n}=e,r={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions},o=await i(t,r);o&&e.request.headers.set("Authorization","Bearer ".concat(o.token))}function K(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}const J="REDACTED",G=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Q=["api-version"];class ${constructor(){let{additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=G.concat(e),t=Q.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if("headers"===e)return this.sanitizeHeaders(i);if("url"===e)return this.sanitizeUrl(i);if("query"===e)return this.sanitizeQuery(i);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(i)||K(i)){if(t.has(i))return"[Circular]";t.add(i)}return i}}),2)}sanitizeHeaders(e){const t={};for(const i of Object.keys(e))this.allowedHeaderNames.has(i.toLowerCase())?t[i]=e[i]:t[i]=J;return t}sanitizeQuery(e){if("object"!==typeof e||null===e)return e;const t={};for(const i of Object.keys(e))this.allowedQueryParameters.has(i.toLowerCase())?t[i]=e[i]:t[i]=J;return t}sanitizeUrl(e){if("string"!==typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[i]of t.searchParams)this.allowedQueryParameters.has(i.toLowerCase())||t.searchParams.set(i,J);return t.toString()}}const Y="logPolicy";const X=new Set(["Deserialize","Serialize","Retry","Sign"]);class Z{constructor(e){var t;this._policies=[],this._policies=null!==(t=null===e||void 0===e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!X.has(t.phase))throw new Error("Invalid phase name: ".concat(t.phase));if(t.afterPhase&&!X.has(t.afterPhase))throw new Error("Invalid afterPhase name: ".concat(t.afterPhase));this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((i=>!(e.name&&i.policy.name===e.name||e.phase&&i.options.phase===e.phase)||(t.push(i.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>i=>t.sendRequest(i,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new Z(this._policies)}static create(){return new Z}orderPolicies(){const e=[],t=new Map;function i(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const n=i("Serialize"),r=i("None"),o=i("Deserialize"),s=i("Retry"),a=i("Sign"),c=[n,r,o,s,a];function l(e){return"Retry"===e?s:"Serialize"===e?n:"Deserialize"===e?o:"Sign"===e?a:r}for(const h of this._policies){const e=h.policy,i=h.options,n=e.name;if(t.has(n))throw new Error("Duplicate policy names not allowed in pipeline");const r={policy:e,dependsOn:new Set,dependants:new Set};i.afterPhase&&(r.afterPhase=l(i.afterPhase),r.afterPhase.hasAfterPolicies=!0),t.set(n,r);l(i.phase).policies.add(r)}for(const h of this._policies){const{policy:e,options:i}=h,n=e.name,r=t.get(n);if(!r)throw new Error("Missing node for policy ".concat(n));if(i.afterPolicies)for(const o of i.afterPolicies){const e=t.get(o);e&&(r.dependsOn.add(e),e.dependants.add(r))}if(i.beforePolicies)for(const o of i.beforePolicies){const e=t.get(o);e&&(e.dependsOn.add(r),r.dependants.add(e))}}function u(i){i.hasRun=!0;for(const n of i.policies)if((!n.afterPhase||n.afterPhase.hasRun&&!n.afterPhase.policies.size)&&0===n.dependsOn.size){e.push(n.policy);for(const e of n.dependants)e.dependsOn.delete(n);t.delete(n.policy.name),i.policies.delete(n)}}function p(){for(const e of c){if(u(e),e.policies.size>0&&e!==r)return void(r.hasRun||u(r));e.hasAfterPolicies&&u(r)}}let d=0;for(;t.size>0;){d++;const t=e.length;if(p(),e.length<=t&&d>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}const ee="redirectPolicy",te=["GET","HEAD"];function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{maxRetries:t=20}=e;return{name:ee,async sendRequest(e,i){const n=await i(e);return ne(i,n,t)}}}async function ne(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const{request:r,status:o,headers:s}=t,a=s.get("location");if(a&&(300===o||301===o&&te.includes(r.method)||302===o&&te.includes(r.method)||303===o&&"POST"===r.method||307===o)&&n<i){const t=new URL(a,r.url);r.url=t.toString(),303===o&&(r.method="GET",r.headers.delete("Content-Length"),delete r.body),r.headers.delete("Authorization");const s=await e(r);return ne(e,s,i,n+1)}return t}const re="1.12.2",oe=3;function se(e){const t=new Map;t.set("core-rest-pipeline",re),function(e){var t,i,n;const r=globalThis.navigator;e.set("OS",(null!==(n=null!==(i=null===(t=null===r||void 0===r?void 0:r.userAgentData)||void 0===t?void 0:t.platform)&&void 0!==i?i:null===r||void 0===r?void 0:r.platform)&&void 0!==n?n:"unknown").replace(" ",""))}(t);const i=function(e){const t=[];for(const[i,n]of e){const e=n?"".concat(i,"/").concat(n):i;t.push(e)}return t.join(" ")}(t);return e?"".concat(e," ").concat(i):i}const ae="x-ms-useragent",ce="userAgentPolicy";const le="Retry-After",ue=["retry-after-ms","x-ms-retry-after-ms",le];function pe(e){if(e&&[429,503].includes(e.status))try{for(const n of ue){const t=m(e,n);if(0===t||t){return t*(n===le?1e3:1)}}const t=e.headers.get(le);if(!t)return;const i=Date.parse(t)-Date.now();return Number.isFinite(i)?Math.max(0,i):void 0}catch(t){return}}const de=1e3,he=64e3;function ve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,i;const n=null!==(t=e.retryDelayInMs)&&void 0!==t?t:de,r=null!==(i=e.maxRetryDelayInMs)&&void 0!==i?i:he;let o=n;return{name:"exponentialRetryStrategy",retry(t){let{retryCount:i,response:n,responseError:s}=t;const a=function(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code||"ENOTFOUND"===e.code}(s),c=a&&e.ignoreSystemErrors,l=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),u=l&&e.ignoreHttpStatusCodes,p=n&&(function(e){return Number.isFinite(pe(e))}(n)||!l);if(p||u||c)return{skipStrategy:!0};if(s&&!a&&!l)return{errorToThrow:s};const d=o*Math.pow(2,i),h=Math.min(r,d);var v,f;return o=h/2+(v=0,f=h/2,v=Math.ceil(v),f=Math.floor(f),Math.floor(Math.random()*(f-v+1))+v),{retryAfterInMs:o}}}}const fe=B("core-rest-pipeline retryPolicy"),ge="retryPolicy";function me(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxRetries:oe};const i=t.logger||fe;return{name:ge,async sendRequest(n,r){var o,s;let a,c,l=-1;e:for(;;){l+=1,a=void 0,c=void 0;try{i.info("Retry ".concat(l,": Attempting to send request"),n.requestId),a=await r(n),i.info("Retry ".concat(l,": Received a response from request"),n.requestId)}catch(u){if(i.error("Retry ".concat(l,": Received an error from request"),n.requestId),c=u,!u||"RestError"!==c.name)throw u;a=c.response}if(null===(o=n.abortSignal)||void 0===o?void 0:o.aborted){i.error("Retry ".concat(l,": Request aborted."));throw new h}if(l>=(null!==(s=t.maxRetries)&&void 0!==s?s:oe)){if(i.info("Retry ".concat(l,": Maximum retries reached. Returning the last received response, or throwing the last received error.")),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}i.info("Retry ".concat(l,": Processing ").concat(e.length," retry strategies."));t:for(const t of e){const e=t.logger||fe;e.info("Retry ".concat(l,": Processing retry strategy ").concat(t.name,"."));const i=t.retry({retryCount:l,response:a,responseError:c});if(i.skipStrategy){e.info("Retry ".concat(l,": Skipped."));continue t}const{errorToThrow:r,retryAfterInMs:o,redirectTo:s}=i;if(r)throw e.error("Retry ".concat(l,": Retry strategy ").concat(t.name," throws error:"),r),r;if(o||0===o){e.info("Retry ".concat(l,": Retry strategy ").concat(t.name," retries after ").concat(o)),await g(o,void 0,{abortSignal:n.abortSignal});continue e}if(s){e.info("Retry ".concat(l,": Retry strategy ").concat(t.name," redirects to ").concat(s)),n.url=s;continue e}}if(c)throw i.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return i.info("None of the retry strategies could work with the received response. Returning it."),a}}}}const ye="defaultRetryPolicy";const Se="formDataPolicy";var Ce,we,Re,be;"undefined"!==typeof window&&window.document,"object"===typeof self&&"function"===typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(Ce=self.constructor)||void 0===Ce?void 0:Ce.name)||"ServiceWorkerGlobalScope"===(null===(we=self.constructor)||void 0===we?void 0:we.name)||null===(Re=self.constructor)||void 0===Re||Re.name);const Pe="undefined"!==typeof Deno&&"undefined"!==typeof Deno.version&&"undefined"!==typeof Deno.version.deno,Ie="undefined"!==typeof process&&Boolean(process.version)&&Boolean(null===(be=process.versions)||void 0===be?void 0:be.node)&&!Pe,Ee=("undefined"!==typeof Bun&&Bun.version,"undefined"!==typeof navigator&&(null===navigator||void 0===navigator||navigator.product),"proxyPolicy is not supported in browser environment");const Te="setClientRequestIdPolicy";const ke="tlsPolicy";const Ae={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Oe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new xe(e.parentContext);return e.span&&(t=t.setValue(Ae.span,e.span)),e.namespace&&(t=t.setValue(Ae.namespace,e.namespace)),t}class xe{constructor(e){this._contextMap=e instanceof xe?new Map(e._contextMap):new Map}setValue(e,t){const i=new xe(this);return i._contextMap.set(e,t),i}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new xe(this);return t._contextMap.delete(e),t}}let De;function ze(){return De||(De={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Oe({parentContext:t.tracingContext})}),withContext(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return t(...n)}}),De}function Ne(e){if(K(e)){const t="string"===typeof e.name,i="string"===typeof e.message;return t&&i}return!1}function _e(e){if(Ne(e))return e.message;{let i;try{i="object"===typeof e&&e?JSON.stringify(e):String(e)}catch(t){i="[unable to stringify input]"}return"Unknown error ".concat(i)}}const Me={},Le=new $;class Be extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,Be.prototype)}[Me](){return"RestError: ".concat(this.message," \n ").concat(Le.sanitize(this))}}Be.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",Be.PARSE_ERROR="PARSE_ERROR";const qe="tracingPolicy";function Ue(){const e=se((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgentPrefix),t=function(){try{return function(e){const{namespace:t,packageName:i,packageVersion:n}=e;function r(e,r,o){var s;const a=ze().startSpan(e,Object.assign(Object.assign({},o),{packageName:i,packageVersion:n,tracingContext:null===(s=null===r||void 0===r?void 0:r.tracingOptions)||void 0===s?void 0:s.tracingContext}));let c=a.tracingContext;const l=a.span;return c.getValue(Ae.namespace)||(c=c.setValue(Ae.namespace,t)),l.setAttribute("az.namespace",c.getValue(Ae.namespace)),{span:l,updatedOptions:Object.assign({},r,{tracingOptions:Object.assign(Object.assign({},null===r||void 0===r?void 0:r.tracingOptions),{tracingContext:c})})}}function o(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return ze().withContext(e,t,...n)}return{startSpan:r,withSpan:async function(e,t,i,n){const{span:s,updatedOptions:a}=r(e,t,n);try{const e=await o(a.tracingOptions.tracingContext,(()=>Promise.resolve(i(a,s))));return s.setStatus({status:"success"}),e}catch(c){throw s.setStatus({status:"error",error:c}),c}finally{s.end()}},withContext:o,parseTraceparentHeader:function(e){return ze().parseTraceparentHeader(e)},createRequestHeaders:function(e){return ze().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:re})}catch(e){return void H.warning("Error when creating the TracingClient: ".concat(_e(e)))}}();return{name:qe,async sendRequest(i,n){var r,o;if(!t||!(null===(r=i.tracingOptions)||void 0===r?void 0:r.tracingContext))return n(i);const{span:s,tracingContext:a}=null!==(o=function(e,t,i){try{const{span:n,updatedOptions:r}=e.startSpan("HTTP ".concat(t.method),{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!n.isRecording())return void n.end();i&&n.setAttribute("http.user_agent",i);const o=e.createRequestHeaders(r.tracingOptions.tracingContext);for(const[e,i]of Object.entries(o))t.headers.set(e,i);return{span:n,tracingContext:r.tracingOptions.tracingContext}}catch(n){return void H.warning("Skipping creating a tracing span due to an error: ".concat(_e(n)))}}(t,i,e))&&void 0!==o?o:{};if(!s||!a)return n(i);try{const e=await t.withContext(a,n,i);return function(e,t){try{e.setAttribute("http.status_code",t.status);const i=t.headers.get("x-ms-request-id");i&&e.setAttribute("serviceRequestId",i),e.setStatus({status:"success"}),e.end()}catch(i){H.warning("Skipping tracing span processing due to an error: ".concat(_e(i)))}}(s,e),e}catch(c){throw function(e,t){try{e.setStatus({status:"error",error:Ne(t)?t:void 0}),((i=t)instanceof Be||Ne(i)&&"RestError"===i.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(i){H.warning("Skipping tracing span processing due to an error: ".concat(_e(i)))}var i}(s,c),c}}}}function Fe(e){var t;const i=Z.create();var n;return Ie&&(e.tlsOptions&&i.addPolicy((n=e.tlsOptions,{name:ke,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=n),t(e))})),i.addPolicy(function(){throw new Error(Ee)}(e.proxyOptions)),i.addPolicy(function(){throw new Error("decompressResponsePolicy is not supported in browser environment")}())),i.addPolicy({name:Se,async sendRequest(e,t){if(e.formData){const t=e.formData,i=new FormData;for(const e of Object.keys(t)){const n=t[e];if(Array.isArray(n))for(const t of n)i.append(e,t);else i.append(e,n)}e.body=i,e.formData=void 0;const n=e.headers.get("Content-Type");n&&-1!==n.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(i).toString():n&&-1!==n.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}}),i.addPolicy(function(){const e=se((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgentPrefix);return{name:ce,sendRequest:async(t,i)=>(t.headers.has(ae)||t.headers.set(ae,e),i(t))}}(e.userAgentOptions)),i.addPolicy(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x-ms-client-request-id";return{name:Te,sendRequest:async(t,i)=>(t.headers.has(e)||t.headers.set(e,t.requestId),i(t))}}(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),i.addPolicy(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return{name:ye,sendRequest:me([{name:"throttlingRetryStrategy",retry(e){let{response:t}=e;const i=pe(t);return Number.isFinite(i)?{retryAfterInMs:i}:{skipStrategy:!0}}},ve(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:oe}).sendRequest}}(e.retryOptions),{phase:"Retry"}),i.addPolicy(Ue(e.userAgentOptions),{afterPhase:"Retry"}),Ie&&i.addPolicy(ie(e.redirectOptions),{afterPhase:"Retry"}),i.addPolicy(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const i=null!==(t=e.logger)&&void 0!==t?t:H.info,n=new $({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:Y,async sendRequest(e,t){if(!i.enabled)return t(e);i("Request: ".concat(n.sanitize(e)));const r=await t(e);return i("Response status code: ".concat(r.status)),i("Headers: ".concat(n.sanitize(r.headers))),r}}}(e.loggingOptions),{afterPhase:"Sign"}),i}function We(e){return e.toLowerCase()}class He{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(We(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(We(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(We(e))}delete(e){this._headersMap.delete(We(e))}toJSON(){const e={};if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preserveCase)for(const t of this._headersMap.values())e[t.name]=t.value;else for(const[t,i]of this._headersMap)e[t]=i.value;return e}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function je(e){return new He(e)}function Ve(e){return Boolean(e&&"function"===typeof e.getReader&&"function"===typeof e.tee)}class Ke{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error("Cannot connect to ".concat(e.url," while allowInsecureConnection is false."));if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:i}=function(e){const t=new AbortController;let i,n;if(e.abortSignal){if(e.abortSignal.aborted)throw new h("The operation was aborted.");n=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",n),i=()=>{var t;n&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",n))}}e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout);return{abortController:t,abortControllerCleanup:i}}(e);try{const r=function(e){const t=new Headers;for(const[i,n]of e)t.append(i,n);return t}(e.headers),{streaming:o,body:s}=function(e){const t="function"===typeof e.body?e.body():e.body;if(function(e){return e&&"function"===typeof e.pipe}(t))throw new Error("Node streams are not supported in browser environment.");return Ve(t)?{streaming:!0,body:Je(t,{onProgress:e.onUploadProgress})}:{streaming:!1,body:t}}(e),a=Object.assign(Object.assign({body:s,method:e.method,headers:r,signal:t.signal},"credentials"in Request.prototype?{credentials:e.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});o&&(a.duplex="half");const c=await fetch(e.url,a);return n=e.body,("function"===typeof Blob||"object"===typeof Blob)&&n instanceof Blob&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t,i){var n,r;const o=function(e){const t=je();for(const[i,n]of e.headers)t.set(i,n);return t}(e),s={request:t,headers:o,status:e.status},a=Ve(e.body)?Je(e.body,{onProgress:t.onDownloadProgress,onEnd:i}):e.body;if((null===(n=t.streamResponseStatusCodes)||void 0===n?void 0:n.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(s.status)))if(t.enableBrowserStreams)s.browserStreamBody=null!==a&&void 0!==a?a:void 0;else{const e=new Response(a);s.blobBody=e.blob(),null===i||void 0===i||i()}else{const e=new Response(a);s.bodyAsText=await e.text(),null===i||void 0===i||i()}return s}(c,e,i)}catch(r){throw null===i||void 0===i||i(),r}var n}(e)}catch(t){throw function(e,t){var i;return e&&"AbortError"===(null===e||void 0===e?void 0:e.name)?e:new Be("Error sending request: ".concat(e.message),{code:null!==(i=null===e||void 0===e?void 0:e.code)&&void 0!==i?i:Be.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function Je(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=0;const{onProgress:n,onEnd:r}=t;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,t){null!==e?(t.enqueue(e),i+=e.length,n&&n({loadedBytes:i})):t.terminate()},flush(){null===r||void 0===r||r()}}));{const t=e.getReader();return new ReadableStream({async pull(e){var o;const{done:s,value:a}=await t.read();if(s||!a)return null===r||void 0===r||r(),e.close(),void t.releaseLock();i+=null!==(o=null===a||void 0===a?void 0:a.length)&&void 0!==o?o:0,e.enqueue(a),n&&n({loadedBytes:i})},cancel:e=>(null===r||void 0===r||r(),t.cancel(e))})}}function Ge(){return new Ke}const Qe="ApiVersionPolicy";const $e="keyCredentialAuthenticationPolicy";let Ye;function Xe(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n,r,o,s;const{credential:a,clientOptions:l}=i;if(a)if(c(a)){const i=function(e){var t;const{credential:i,scopes:n,challengeCallbacks:r}=e,o=e.logger||H,s=Object.assign({authorizeRequest:null!==(t=null===r||void 0===r?void 0:r.authorizeRequest)&&void 0!==t?t:V,authorizeRequestOnChallenge:null===r||void 0===r?void 0:r.authorizeRequestOnChallenge},r),a=i?S(i):()=>Promise.resolve(null);return{name:j,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let i,r;await s.authorizeRequest({scopes:Array.isArray(n)?n:[n],request:e,getAccessToken:a,logger:o});try{i=await t(e)}catch(c){r=c,i=c.response}if(s.authorizeRequestOnChallenge&&401===(null===i||void 0===i?void 0:i.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(i)&&await s.authorizeRequestOnChallenge({scopes:Array.isArray(n)?n:[n],request:e,response:i,getAccessToken:a,logger:o}))return t(e);if(r)throw r;return i}}}({credential:a,scopes:null!==(r=null===(n=null===l||void 0===l?void 0:l.credentials)||void 0===n?void 0:n.scopes)&&void 0!==r?r:"".concat(t,"/.default")});e.addPolicy(i)}else if(function(e){return void 0!==e.key}(a)){if(!(null===(o=null===l||void 0===l?void 0:l.credentials)||void 0===o?void 0:o.apiKeyHeaderName))throw new Error("Missing API Key Header Name");const t=function(e,t){return{name:$e,sendRequest:async(i,n)=>(i.headers.set(t,e.key),n(i))}}(a,null===(s=null===l||void 0===l?void 0:l.credentials)||void 0===s?void 0:s.apiKeyHeaderName);e.addPolicy(t)}}function Ze(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Fe(i);return n.addPolicy(function(e){return{name:Qe,sendRequest:(t,i)=>{const n=new URL(t.url);return!n.searchParams.get("api-version")&&e.apiVersion&&(t.url="".concat(t.url).concat(Array.from(n.searchParams.keys()).length>0?"&":"?","api-version=").concat(e.apiVersion)),i(t)}}}(i)),Xe(n,e,{credential:t,clientOptions:i}),n}function et(){return Ye||(Ye=Ge()),Ye}function tt(){let e="";for(let t=0;t<32;t++){const i=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&i|8:i.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e}var it;const nt="function"===typeof(null===(it=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===it?void 0:it.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):tt;class rt{constructor(e){var t,i,n,r,o,s,a;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:je(),this.method=null!==(i=e.method)&&void 0!==i?i:"GET",this.timeout=null!==(n=e.timeout)&&void 0!==n?n:0,this.formData=e.formData,this.disableKeepAlive=null!==(r=e.disableKeepAlive)&&void 0!==r&&r,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||nt(),this.allowInsecureConnection=null!==(s=e.allowInsecureConnection)&&void 0!==s&&s,this.enableBrowserStreams=null!==(a=e.enableBrowserStreams)&&void 0!==a&&a}}function ot(e){let t="";for(const i of e)t+=String.fromCharCode(i);return t}async function st(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;const o=null!==r&&void 0!==r?r:et(),s=lt(e,t,n),a=await i.sendRequest(o,s),c=a.headers.toJSON(),l=function(e){var t,i;const n=null!==(t=e.headers.get("content-type"))&&void 0!==t?t:"",r=n.split(";")[0],o=null!==(i=e.bodyAsText)&&void 0!==i?i:"";if("text/plain"===r)return String(o);try{return o?JSON.parse(o):void 0}catch(s){if("application/json"===r)throw function(e,t){var i;const n='Error "'.concat(t,'" occurred while parsing the response body - ').concat(e.bodyAsText,"."),r=null!==(i=t.code)&&void 0!==i?i:Be.PARSE_ERROR;return new Be(n,{code:r,statusCode:e.status,request:e.request,response:e})}(e,s);return String(o)}}(a);return(null===n||void 0===n?void 0:n.onResponse)&&n.onResponse(Object.assign(Object.assign({},a),{request:s,rawHeaders:c,parsedBody:l})),{request:s,headers:c,status:"".concat(a.status),body:l}}async function at(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;var o;const s=null!==r&&void 0!==r?r:et(),a=lt(e,t,Object.assign(Object.assign({},n),{responseAsStream:!0})),c=await i.sendRequest(s,a),l=c.headers.toJSON(),u=null!==(o=c.browserStreamBody)&&void 0!==o?o:c.readableStreamBody;return{request:a,headers:l,status:"".concat(c.status),body:u}}function ct(e){return ArrayBuffer.isView(e)?"application/octet-stream":"application/json; charset=UTF-8"}function lt(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n,r;const{body:o,formData:s}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(void 0===e)return{body:void 0};if(function(e){return Boolean(e&&"function"===typeof e.getReader&&"function"===typeof e.tee)}(e))return{body:e};if(!t&&"string"===typeof e)return{body:e};const i=t.split(";")[0];if("application/json"===i)return{body:JSON.stringify(e)};if(ArrayBuffer.isView(e))return e instanceof Uint8Array?{body:ot(e)}:{body:JSON.stringify(e)};switch(i){case"multipart/form-data":return function(e){return e instanceof Object&&Object.keys(e).length>0}(e)?{formData:ut(e)}:{body:JSON.stringify(e)};case"text/plain":return{body:String(e)};default:return"string"===typeof e?{body:e}:{body:JSON.stringify(e)}}}(i.body,i.contentType),a=void 0!==o||void 0!==s;return function(e){return new rt(e)}({url:t,method:e,body:o,formData:s,headers:je(Object.assign(Object.assign(Object.assign({},i.headers?i.headers:{}),{accept:null!==(n=i.accept)&&void 0!==n?n:"application/json"}),a&&{"content-type":null!==(r=i.contentType)&&void 0!==r?r:ct(i.body)})),allowInsecureConnection:i.allowInsecureConnection,tracingOptions:i.tracingOptions,abortSignal:i.abortSignal,onUploadProgress:i.onUploadProgress,onDownloadProgress:i.onDownloadProgress,timeout:i.timeout,enableBrowserStreams:!0,streamResponseStatusCodes:i.responseAsStream?new Set([Number.POSITIVE_INFINITY]):void 0})}function ut(e){if(!e)return e;const t={};for(const i in e){const n=e[i];n instanceof Uint8Array?t[i]=ot(n):t[i]=n}return t}function pt(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.startsWith("https://")||t.startsWith("http://"))return t;e=function(e,t){var i;if(!t.pathParameters)return e;const n=t.pathParameters;for(const[r,o]of Object.entries(n)){if(void 0===o||null===o)throw new Error("Path parameters ".concat(r," must not be undefined or null"));if(!o.toString||"function"!==typeof o.toString)throw new Error("Path parameters must be able to be represented as string, ".concat(r," can't"));let n=void 0!==o.toISOString?o.toISOString():String(o);t.skipUrlEncoding||(n=encodeURIComponent(o)),e=null!==(i=dt(e,"{".concat(r,"}"),n))&&void 0!==i?i:""}return e}(e,n),t=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(const n of t){let t=n;i.skipUrlEncoding||(t=encodeURIComponent(n)),e=e.replace(/\{\w+\}/,t)}return e}(t,i,n);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.queryParameters)return e;let i=new URL(e);const n=t.queryParameters;for(const r of Object.keys(n)){const e=n[r];if(void 0===e||null===e)continue;if(!e.toString||"function"!==typeof e.toString)throw new Error("Query parameters must be able to be represented as string, ".concat(r," can't"));const t=void 0!==e.toISOString?e.toISOString():e.toString();i.searchParams.append(r,t)}t.skipUrlEncoding&&(i=function(e){if(!e)return e;const t=[];for(const[i,n]of e.searchParams)t.push("".concat(i,"=").concat(n));return e.search=t.length?"?".concat(t.join("&")):"",e}(i));return i.toString()}("".concat(e,"/").concat(t),n);return new URL(r).toString().replace(/([^:]\/)\/+/g,"$1")}function dt(e,t,i){return e&&t?e.split(t).join(i||""):e}function ht(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;let r;t&&(!function(e){if(void 0!==e.key||c(e))return!0;return!1}(t)?i=null!==t&&void 0!==t?t:{}:r=t);const o=Ze(e,r,i);if(null===(n=i.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:c,position:u}of i.additionalPolicies){const e="perRetry"===u?"Sign":void 0;o.addPolicy(c,{afterPhase:e})}const{allowInsecureConnection:s,httpClient:a}=i,l=function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];const c=i=>pt(e,t,n,Object.assign({allowInsecureConnection:s},i));return{get:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("GET",c(e),o,e,s,a)},post:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("POST",c(e),o,e,s,a)},put:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("PUT",c(e),o,e,s,a)},patch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("PATCH",c(e),o,e,s,a)},delete:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("DELETE",c(e),o,e,s,a)},head:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("HEAD",c(e),o,e,s,a)},options:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("OPTIONS",c(e),o,e,s,a)},trace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vt("TRACE",c(e),o,e,s,a)}}};return{path:l,pathUnchecked:l,pipeline:o}}function vt(e,t,i,n,r,o){var s;return r=null!==(s=n.allowInsecureConnection)&&void 0!==s?s:r,{then:function(s,a){return st(e,t,i,Object.assign(Object.assign({},n),{allowInsecureConnection:r}),o).then(s,a)},asBrowserStream:async()=>at(e,t,i,Object.assign(Object.assign({},n),{allowInsecureConnection:r}),o),asNodeStream:async()=>at(e,t,i,Object.assign(Object.assign({},n),{allowInsecureConnection:r}),o)}}const ft=B("openai");const gt=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n,r,o,s,a,c,l,u;const p=null!==(n=i.baseUrl)&&void 0!==n?n:"".concat(e,"/openai");i.apiVersion=null!==(r=i.apiVersion)&&void 0!==r?r:"2023-09-01-preview",i=Object.assign(Object.assign({},i),{credentials:{scopes:null!==(s=null===(o=i.credentials)||void 0===o?void 0:o.scopes)&&void 0!==s?s:["https://cognitiveservices.azure.com/.default"],apiKeyHeaderName:null!==(c=null===(a=i.credentials)||void 0===a?void 0:a.apiKeyHeaderName)&&void 0!==c?c:"api-key"}});const d="azsdk-js-openai-rest/1.0.0-beta.7",h=i.userAgentOptions&&i.userAgentOptions.userAgentPrefix?"".concat(i.userAgentOptions.userAgentPrefix," ").concat(d):"".concat(d);return i=Object.assign(Object.assign({},i),{userAgentOptions:{userAgentPrefix:h},loggingOptions:{logger:null!==(u=null===(l=i.loggingOptions)||void 0===l?void 0:l.logger)&&void 0!==u?u:ft.info}}),ht(p,t,i)};function mt(e){var t,i,n,r,o,s;return{allowInsecureConnection:null===(t=e.requestOptions)||void 0===t?void 0:t.allowInsecureConnection,timeout:null===(i=e.requestOptions)||void 0===i?void 0:i.timeout,skipUrlEncoding:null===(n=e.requestOptions)||void 0===n?void 0:n.skipUrlEncoding,abortSignal:e.abortSignal,onUploadProgress:null===(r=e.requestOptions)||void 0===r?void 0:r.onUploadProgress,onDownloadProgress:null===(o=e.requestOptions)||void 0===o?void 0:o.onDownloadProgress,tracingOptions:e.tracingOptions,headers:Object.assign({},null===(s=e.requestOptions)||void 0===s?void 0:s.headers),onResponse:e.onResponse}}const yt={"POST /deployments/{deploymentId}/embeddings":["200"],"POST /deployments/{deploymentId}/completions":["200"],"POST /deployments/{deploymentId}/chat/completions":["200"],"POST /deployments/{deploymentId}/extensions/chat/completions":["200"],"GET /operations/images/{operationId}":["200"],"POST /images/generations:submit":["202"],"GET /images/generations:submit":["200","202"]};function St(e){const t=e.headers["x-ms-original-url"],i=new URL(null!==t&&void 0!==t?t:e.request.url),n=e.request.method;let r=yt["".concat(n," ").concat(i.pathname)];return r||(r=function(e,t){var i,n,r,o;const s=t.split("/");let a=-1,c=[];for(const[l,u]of Object.entries(yt)){if(!l.startsWith(e))continue;const t=Ct(l),p=t.split("/");let d=!0;for(let e=p.length-1,a=s.length-1;e>=1&&a>=1;e--,a--)if((null===(i=p[e])||void 0===i?void 0:i.startsWith("{"))&&-1!==(null===(n=p[e])||void 0===n?void 0:n.indexOf("}"))){const t=p[e].indexOf("}")+1,i=null===(r=p[e])||void 0===r?void 0:r.length;if(!new RegExp("".concat(null===(o=p[e])||void 0===o?void 0:o.slice(t,i))).test(s[a]||"")){d=!1;break}}else if(p[e]!==s[a]){d=!1;break}d&&t.length>a&&(a=t.length,c=u)}return c}(n,i.pathname)),!r.includes(e.status)}function Ct(e){const t=e.indexOf("/");return e.slice(t)}const wt=B("core-lro");function Rt(e){const{azureAsyncOperation:t,operationLocation:i}=e;return null!==i&&void 0!==i?i:t}function bt(e){return e.headers.location}function Pt(e){return e.headers["operation-location"]}function It(e){return e.headers["azure-asyncoperation"]}function Et(e){var t;const{location:i,requestMethod:n,requestPath:r,resourceLocationConfig:o}=e;switch(n){case"PUT":return r;case"DELETE":return;case"PATCH":return null!==(t=s())&&void 0!==t?t:r;default:return s()}function s(){switch(o){case"azure-async-operation":return;case"original-uri":return r;default:return i}}}function Tt(e){const{rawResponse:t,requestMethod:i,requestPath:n,resourceLocationConfig:r}=e,o=Rt({operationLocation:Pt(t),azureAsyncOperation:It(t)}),s=bt(t),a=null===i||void 0===i?void 0:i.toLocaleUpperCase();return void 0!==o?{mode:"OperationLocation",operationLocation:o,resourceLocation:Et({requestMethod:a,location:s,requestPath:n,resourceLocationConfig:r})}:void 0!==s?{mode:"ResourceLocation",operationLocation:s}:"PUT"===a&&n?{mode:"Body",operationLocation:n}:void 0}function kt(e){const{status:t,statusCode:i}=e;if("string"!==typeof t&&void 0!==t)throw new Error("Polling was unsuccessful. Expected status to have a string value or no value but it has instead: ".concat(t,". This doesn't necessarily indicate the operation has failed. Check your Azure subscription or resource status for more information."));switch(null===t||void 0===t?void 0:t.toLocaleLowerCase()){case void 0:return At(i);case"succeeded":return"succeeded";case"failed":return"failed";case"running":case"accepted":case"started":case"canceling":case"cancelling":return"running";case"canceled":case"cancelled":return"canceled";default:return wt.verbose("LRO: unrecognized operation status: ".concat(t)),t}}function At(e){return 202===e?"running":e<300?"succeeded":"failed"}function Ot(e){let{rawResponse:t}=e;const i=t.headers["retry-after"];if(void 0!==i){const e=parseInt(i);return isNaN(e)?function(e){const t=Math.floor((new Date).getTime()),i=e.getTime();if(t<i)return i-t;return}(new Date(i)):1e3*e}}function xt(e){const t=e.flatResponse.error;if(t){if(t.code&&t.message)return t;wt.warning("The long-running operation failed but the error property in the response's body doesn't contain code or message")}else wt.warning("The long-running operation failed but there is no error property in the response's body")}function Dt(e){const{response:t,state:i,operationLocation:n}=e;const r=function(){var e;switch(null===(e=i.config.metadata)||void 0===e?void 0:e.mode){case void 0:return At(t.rawResponse.statusCode);case"Body":return Nt(t,i);default:return"running"}}();return"running"===r&&void 0===n?"succeeded":r}function zt(e,t){let{rawResponse:i}=e;var n;switch(null===(n=t.config.metadata)||void 0===n?void 0:n.mode){case"OperationLocation":return Rt({operationLocation:Pt(i),azureAsyncOperation:It(i)});case"ResourceLocation":return bt(i);default:return}}function Nt(e,t){let{rawResponse:i}=e;var n;const r=null===(n=t.config.metadata)||void 0===n?void 0:n.mode;switch(r){case"OperationLocation":return function(e){var t;const{status:i}=null!==(t=e.body)&&void 0!==t?t:{};return kt({status:i,statusCode:e.statusCode})}(i);case"ResourceLocation":return At(i.statusCode);case"Body":return function(e){var t,i;const{properties:n,provisioningState:r}=null!==(t=e.body)&&void 0!==t?t:{};return kt({status:null!==(i=null===n||void 0===n?void 0:n.provisioningState)&&void 0!==i?i:r,statusCode:e.statusCode})}(i);default:throw new Error("Internal error: Unexpected operation mode: ".concat(r))}}function _t(e,t){let{flatResponse:i}=e;if("object"===typeof i){const e=i.resourceLocation;void 0!==e&&(t.config.resourceLocation=e)}return t.config.resourceLocation}function Mt(e){return"RestError"===e.name}const Lt=2e3,Bt=["succeeded","canceled","failed"];function qt(e){const{state:t,stateProxy:i,isOperationError:n}=e;return e=>{throw n(e)&&(i.setError(t,e),i.setFailed(t)),e}}function Ut(e,t){let i=e;return"."!==i.slice(-1)&&(i+="."),i+" "+t}function Ft(e){const{state:t,stateProxy:i,status:n,isDone:r,processResult:o,getError:s,response:a,setErrorAsResult:c}=e;switch(n){case"succeeded":i.setSucceeded(t);break;case"failed":{const e=null===s||void 0===s?void 0:s(a);let n="";if(e){const{code:t,message:i}=function(e){let t=e.message,i=e.code,n=e;for(;n.innererror;)n=n.innererror,i=n.code,t=Ut(t,n.message);return{code:i,message:t}}(e);n=". ".concat(t,". ").concat(i)}const r="The long-running operation has failed".concat(n);i.setError(t,new Error(r)),i.setFailed(t),wt.warning(r);break}case"canceled":i.setCanceled(t)}((null===r||void 0===r?void 0:r(a,t))||void 0===r&&["succeeded","canceled"].concat(c?[]:["failed"]).includes(n))&&i.setResult(t,function(e){const{processResult:t,response:i,state:n}=e;return t?t(i,n):i}({response:a,state:t,processResult:o}))}async function Wt(e){const{poll:t,state:i,stateProxy:n,options:r,getOperationStatus:o,getResourceLocation:s,getOperationLocation:a,isOperationError:c,withOperationLocation:l,getPollingInterval:u,processResult:p,getError:d,updateState:h,setDelay:v,isDone:f,setErrorAsResult:g}=e,{operationLocation:m}=i.config;if(void 0!==m){const{response:e,status:y}=await async function(e){const{poll:t,state:i,stateProxy:n,operationLocation:r,getOperationStatus:o,getResourceLocation:s,isOperationError:a,options:c}=e,l=await t(r,c).catch(qt({state:i,stateProxy:n,isOperationError:a})),u=o(l,i);if(wt.verbose("LRO: Status:\n\tPolling from: ".concat(i.config.operationLocation,"\n\tOperation status: ").concat(u,"\n\tPolling status: ").concat(Bt.includes(u)?"Stopped":"Running")),"succeeded"===u){const e=s(l,i);if(void 0!==e)return{response:await t(e).catch(qt({state:i,stateProxy:n,isOperationError:a})),status:u}}return{response:l,status:u}}({poll:t,getOperationStatus:o,state:i,stateProxy:n,operationLocation:m,getResourceLocation:s,isOperationError:c,options:r});if(Ft({status:y,response:e,state:i,stateProxy:n,isDone:f,processResult:p,getError:d,setErrorAsResult:g}),!Bt.includes(y)){const t=null===u||void 0===u?void 0:u(e);t&&v(t);const n=null===a||void 0===a?void 0:a(e,i);if(void 0!==n){const e=m!==n;i.config.operationLocation=n,null===l||void 0===l||l(n,e)}else null===l||void 0===l||l(m,!1)}null===h||void 0===h||h(i,e)}}const Ht="The delay was aborted.";function jt(e,t){let i;const{abortSignal:n,abortErrorMsg:r}=null!==t&&void 0!==t?t:{};return function(e,t){const{cleanupBeforeAbort:i,abortSignal:n,abortErrorMsg:r}=null!==t&&void 0!==t?t:{};return new Promise(((t,o)=>{function s(){o(new h(null!==r&&void 0!==r?r:"The operation was aborted."))}function a(){null===n||void 0===n||n.removeEventListener("abort",c)}function c(){null===i||void 0===i||i(),a(),s()}if(null===n||void 0===n?void 0:n.aborted)return s();try{e((e=>{a(),t(e)}),(e=>{a(),o(e)}))}catch(l){o(l)}null===n||void 0===n||n.addEventListener("abort",c)}))}((t=>{i=setTimeout(t,e)}),{cleanupBeforeAbort:()=>clearTimeout(i),abortSignal:n,abortErrorMsg:null!==r&&void 0!==r?r:Ht})}const Vt=()=>({initState:e=>({status:"running",config:e}),setCanceled:e=>e.status="canceled",setError:(e,t)=>e.error=t,setResult:(e,t)=>e.result=t,setRunning:e=>e.status="running",setSucceeded:e=>e.status="succeeded",setFailed:e=>e.status="failed",getError:e=>e.error,getResult:e=>e.result,isCanceled:e=>"canceled"===e.status,isFailed:e=>"failed"===e.status,isRunning:e=>"running"===e.status,isSucceeded:e=>"succeeded"===e.status});function Kt(e){const{getOperationLocation:t,getStatusFromInitialResponse:i,getStatusFromPollResponse:n,isOperationError:r,getResourceLocation:o,getPollingInterval:s,getError:a,resolveOnUnsuccessful:c}=e;return async(e,l)=>{let{init:u,poll:p}=e;const{processResult:d,updateState:h,withOperationLocation:f,intervalInMs:g=Lt,restoreFrom:m}=l||{},y=Vt(),S=f?(()=>{let e=!1;return(t,i)=>{i?f(t):e||f(t),e=!0}})():void 0,C=m?function(e){try{return JSON.parse(e).state}catch(t){throw new Error("Unable to deserialize input state: ".concat(e))}}(m):await async function(e){const{init:t,stateProxy:i,processResult:n,getOperationStatus:r,withOperationLocation:o,setErrorAsResult:s}=e,{operationLocation:a,resourceLocation:c,metadata:l,response:u}=await t();a&&(null===o||void 0===o||o(a,!1));const p={metadata:l,operationLocation:a,resourceLocation:c};wt.verbose("LRO: Operation description:",p);const d=i.initState(p);return Ft({state:d,status:r({response:u,state:d,operationLocation:a}),stateProxy:i,response:u,setErrorAsResult:s,processResult:n}),d}({init:u,stateProxy:y,processResult:d,getOperationStatus:i,withOperationLocation:S,setErrorAsResult:!c});let w;const R=new v,b=new Map,P="Operation was canceled";let I=g;const E={getOperationState:()=>C,getResult:()=>C.result,isDone:()=>["succeeded","failed","canceled"].includes(C.status),isStopped:()=>void 0===w,stopPolling:()=>{R.abort()},toString:()=>JSON.stringify({state:C}),onProgress:e=>{const t=Symbol();return b.set(t,e),()=>b.delete(t)},pollUntilDone:e=>null!==w&&void 0!==w?w:w=(async()=>{const{abortSignal:t}=e||{},{signal:i}=t?new v([t,R.signal]):R;if(!E.isDone())for(await E.poll({abortSignal:i});!E.isDone();)await jt(I,{abortSignal:i}),await E.poll({abortSignal:i});if(c)return E.getResult();switch(C.status){case"succeeded":return E.getResult();case"canceled":throw new Error(P);case"failed":throw C.error;case"notStarted":case"running":throw new Error("Polling completed without succeeding or failing")}})().finally((()=>{w=void 0})),async poll(e){if(c){if(E.isDone())return}else switch(C.status){case"succeeded":return;case"canceled":throw new Error(P);case"failed":throw C.error}if(await Wt({poll:p,state:C,stateProxy:y,getOperationLocation:t,isOperationError:r,withOperationLocation:S,getPollingInterval:s,getOperationStatus:n,getResourceLocation:o,processResult:d,getError:a,updateState:h,options:e,setDelay:e=>{I=e},setErrorAsResult:!c}),await(async()=>b.forEach((e=>e(C))))(),!c)switch(C.status){case"canceled":throw new Error(P);case"failed":throw C.error}}};return E}}async function Jt(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;const r={requestMethod:t.request.method,requestPath:t.request.url,sendInitialRequest:async()=>Gt(t),sendPollRequest:async i=>{const n=Gt(await e.pathUnchecked(null!==i&&void 0!==i?i:t.request.url).get());return n.rawResponse.headers["x-ms-original-url"]=t.request.url,n}};return i.resolveOnUnsuccessful=null===(n=i.resolveOnUnsuccessful)||void 0===n||n,async function(e,t){const{resourceLocationConfig:i,intervalInMs:n,processResult:r,restoreFrom:o,updateState:s,withOperationLocation:a,resolveOnUnsuccessful:c=!1}=t||{};return Kt({getStatusFromInitialResponse:Dt,getStatusFromPollResponse:Nt,isOperationError:Mt,getOperationLocation:zt,getResourceLocation:_t,getPollingInterval:Ot,getError:xt,resolveOnUnsuccessful:c})({init:async()=>{const t=await e.sendInitialRequest(),n=Tt({rawResponse:t.rawResponse,requestPath:e.requestPath,requestMethod:e.requestMethod,resourceLocationConfig:i});return Object.assign({response:t,operationLocation:null===n||void 0===n?void 0:n.operationLocation,resourceLocation:null===n||void 0===n?void 0:n.resourceLocation},(null===n||void 0===n?void 0:n.mode)?{metadata:{mode:n.mode}}:{})},poll:e.sendPollRequest},{intervalInMs:n,withOperationLocation:a,restoreFrom:o,updateState:s,processResult:r?(e,t)=>{let{flatResponse:i}=e;return r(i,t)}:e=>{let{flatResponse:t}=e;return t}})}(r,i)}function Gt(e){if(Number.isNaN(e.status))throw new TypeError("Status code of the response is not a number. Value: ".concat(e.status));return{flatResponse:e,rawResponse:Object.assign(Object.assign({},e),{statusCode:Number.parseInt(e.status),body:e.body})}}function Qt(e){var t;const i=null!==(t=e.prompt_annotations)&&void 0!==t?t:e.prompt_filter_results;return i?{promptFilterResults:i.map((e=>Object.assign({promptIndex:e.prompt_index},e.content_filter_results?{contentFilterResults:Zt(e.content_filter_results)}:{})))}:{}}function $t(e){var t;return Object.assign(Object.assign({id:e.id,created:new Date(e.created)},Qt(e)),{choices:(null!==(t=e.choices)&&void 0!==t?t:[]).map((e=>Object.assign(Object.assign({text:e.text,index:e.index},e.content_filter_results?{contentFilterResults:Zt(e.content_filter_results)}:{}),{logprobs:null===e.logprobs?null:{tokens:e.logprobs.tokens,tokenLogprobs:e.logprobs.token_logprobs,topLogprobs:e.logprobs.top_logprobs,textOffset:e.logprobs.text_offset},finishReason:e.finish_reason})))})}function Yt(e){var t;return Object.assign(Object.assign({id:e.id,created:new Date(e.created),choices:(null!==(t=e.choices)&&void 0!==t?t:[]).map((e=>Object.assign(Object.assign(Object.assign(Object.assign({},e.message?{message:Xt(e.message)}:{}),{index:e.index,finishReason:e.finish_reason}),e.delta?{delta:Xt(e.delta)}:{}),e.content_filter_results?{contentFilterResults:Zt(e.content_filter_results)}:{})))},Qt(e)),e.usage?{usage:{completionTokens:e.usage.completion_tokens,promptTokens:e.usage.prompt_tokens,totalTokens:e.usage.total_tokens}}:{})}function Xt(e){var t,i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e.role?{role:e.role}:{}),e.content?{content:e.content}:{}),e.name?{name:e.name}:{}),e.function_call?{functionCall:{name:null===(t=e.function_call)||void 0===t?void 0:t.name,arguments:null===(i=e.function_call)||void 0===i?void 0:i.arguments}}:{}),e.context?{context:Object.assign({},e.context.messages?{messages:e.context.messages.map((e=>Xt(e)))}:{})}:{})}function Zt(e){var t,i,n,r,o,s,a,c,l;return e.error?{error:{code:e.error.code,message:e.error.message,details:null!==(t=e.error.details)&&void 0!==t?t:[]}}:Object.assign(Object.assign(Object.assign(Object.assign({},e.sexual?{sexual:{severity:null===(i=e.sexual)||void 0===i?void 0:i.severity,filtered:null===(n=e.sexual)||void 0===n?void 0:n.filtered}}:{}),e.violence?{violence:{severity:null===(r=e.violence)||void 0===r?void 0:r.severity,filtered:null===(o=e.violence)||void 0===o?void 0:o.filtered}}:{}),e.hate?{hate:{severity:null===(s=e.hate)||void 0===s?void 0:s.severity,filtered:null===(a=e.hate)||void 0===a?void 0:a.filtered}}:{}),e.self_harm?{selfHarm:{severity:null===(c=e.self_harm)||void 0===c?void 0:c.severity,filtered:null===(l=e.self_harm)||void 0===l?void 0:l.filtered}}:{})}function ei(e){return function(e){return s(this,arguments,(function*(){var t,i,n,r;let s=ii();const c=new TextDecoder;try{for(var l,u=!0,p=a(e);!(t=(l=yield o(p.next())).done);){r=l.value,u=!1;try{const{line:e,fieldLen:t}=r;if(0===e.length&&void 0!==s.data)yield yield o(s),s=ii();else if(t>0){const i=c.decode(e.subarray(0,t)),n=t+(32===e[t+1]?2:1),r=c.decode(e.subarray(n));switch(i){case"data":s.data=s.data?s.data+"\n"+r:r;break;case"event":s.event=r;break;case"id":s.id=r;break;case"retry":{const e=parseInt(r,10);isNaN(e)||(s.retry=e);break}}}}finally{u=!0}}}catch(d){i={error:d}}finally{try{u||t||!(n=p.return)||(yield o(n.call(p)))}finally{if(i)throw i.error}}}))}(function(e){return s(this,arguments,(function*(){var t,i,n,r;let s,c=0,l=-1,u=!1;try{for(var p,d=!0,h=a(e);!(t=(p=yield o(h.next())).done);){r=p.value,d=!1;try{void 0===s?(s=r,c=0,l=-1):s=ti(s,r);const e=s.length;let t=0;for(;c<e;){u&&(10===s[c]&&(t=++c),u=!1);let i=-1;for(;c<e&&-1===i;++c)switch(s[c]){case 58:-1===l&&(l=c-t);break;case 13:u=!0,i=c;break;case 10:i=c}if(-1===i)break;yield yield o({line:s.subarray(t,i),fieldLen:l}),t=c,l=-1}t===e?s=void 0:0!==t&&(s=s.subarray(t),c-=t)}finally{d=!0}}}catch(v){i={error:v}}finally{try{d||t||!(n=h.return)||(yield o(n.call(h)))}finally{if(i)throw i.error}}}))}(function(e){return t=e,Boolean(t&&"function"===typeof t.getReader&&"function"===typeof t.tee)&&void 0===e[Symbol.asyncIterator]?function(e){return s(this,arguments,(function*(){const t=e.getReader();try{for(;;){const{value:e,done:i}=yield o(t.read());if(i)return yield o(void 0);yield yield o(e)}}finally{t.releaseLock()}}))}(e):e;var t}(e)))}function ti(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function ii(){return{data:void 0,event:"",id:"",retry:void 0}}function ni(e,t){try{return e()}catch(i){throw new Error("".concat(t,": ").concat(i),{cause:i})}}function ri(e){for(const t of Object.keys(e)){const i=e[t],n=t.replace(/([_][a-z])/g,(e=>e.toUpperCase().replace("_","")));n!==t&&delete e[t],e[n]="object"===typeof i?Array.isArray(i)?i.map((e=>ri(e))):ri(i):i}return e}async function oi(e){const t=await async function(e){const{body:t,status:i}=await e.asBrowserStream();if("200"!==i&&void 0!==t){const e=await async function(e){const t=e.getReader(),i=[];let n=0;try{for(;;){const{value:e,done:r}=await t.read();if(r)return(new TextDecoder).decode(si(i,n));n+=e.length,i.push(e)}}finally{t.releaseLock()}}(t);throw ni((()=>JSON.parse(e).error),"Error parsing response body")}if(!t)throw new Error("No stream found in response. Did you enable the stream option?");return t}(e);return ei(t)}function si(e,t){const i=null!==t&&void 0!==t?t:function(e){return e.reduce(((e,t)=>e+t.length),0)}(e),n=new Uint8Array(i);for(let r=0,o=0;r<e.length;r++){const t=e[r];n.set(t,o),o+=t.length}return n}function ai(e,t){return s(this,arguments,(function*(){var i,n,r,s;const c=yield o(oi(e));let l=!1;try{for(var u,p=!0,d=a(c);!(i=(u=yield o(d.next())).done);p=!0){s=u.value,p=!1;const e=s;l||("[DONE]"===e.data?l=!0:yield yield o(t(ni((()=>JSON.parse(e.data)),"Error parsing an event. See 'cause' for more details"))))}}catch(h){n={error:h}}finally{try{p||i||!(r=d.return)||(yield o(r.call(d)))}finally{if(n)throw n.error}}}))}function ci(e){return new File([e],"placeholder.wav")}async function li(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};const r=await function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return e.path("/deployments/{deploymentId}/embeddings",i).post(Object.assign(Object.assign({},mt(n)),{body:{user:null===n||void 0===n?void 0:n.user,model:null===n||void 0===n?void 0:n.model,input:t}}))}(e,t,i,n);return async function(e){var t;if(St(e))throw e.body.error;return{data:(null!==(t=e.body.data)&&void 0!==t?t:[]).map((e=>({embedding:e.embedding,index:e.index}))),usage:{promptTokens:e.body.usage.prompt_tokens,totalTokens:e.body.usage.total_tokens}}}(r)}function ui(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return e.path("/deployments/{deploymentId}/completions",i).post(Object.assign(Object.assign({},mt(n)),{body:{prompt:t,max_tokens:null===n||void 0===n?void 0:n.maxTokens,temperature:null===n||void 0===n?void 0:n.temperature,top_p:null===n||void 0===n?void 0:n.topP,logit_bias:null===n||void 0===n?void 0:n.logitBias,user:null===n||void 0===n?void 0:n.user,n:null===n||void 0===n?void 0:n.n,logprobs:null===n||void 0===n?void 0:n.logprobs,echo:null===n||void 0===n?void 0:n.echo,stop:null===n||void 0===n?void 0:n.stop,presence_penalty:null===n||void 0===n?void 0:n.presencePenalty,frequency_penalty:null===n||void 0===n?void 0:n.frequencyPenalty,best_of:null===n||void 0===n?void 0:n.bestOf,stream:null===n||void 0===n?void 0:n.stream,model:null===n||void 0===n?void 0:n.model}}))}async function pi(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return async function(e){var t,i;if(St(e))throw e.body.error;return{id:e.body.id,created:new Date(e.body.created),promptFilterResults:(null!==(t=e.body.prompt_annotations)&&void 0!==t?t:[]).map((e=>{var t,i,n,r,o,s,a,c,l,u,p,d,h,v,f,g,m,y,S,C;return{promptIndex:e.prompt_index,contentFilterResults:e.content_filter_results?{sexual:(null===(t=e.content_filter_results)||void 0===t?void 0:t.sexual)?{severity:null===(n=null===(i=e.content_filter_results)||void 0===i?void 0:i.sexual)||void 0===n?void 0:n.severity,filtered:null===(o=null===(r=e.content_filter_results)||void 0===r?void 0:r.sexual)||void 0===o?void 0:o.filtered}:void 0,violence:(null===(s=e.content_filter_results)||void 0===s?void 0:s.violence)?{severity:null===(c=null===(a=e.content_filter_results)||void 0===a?void 0:a.violence)||void 0===c?void 0:c.severity,filtered:null===(u=null===(l=e.content_filter_results)||void 0===l?void 0:l.violence)||void 0===u?void 0:u.filtered}:void 0,hate:(null===(p=e.content_filter_results)||void 0===p?void 0:p.hate)?{severity:null===(h=null===(d=e.content_filter_results)||void 0===d?void 0:d.hate)||void 0===h?void 0:h.severity,filtered:null===(f=null===(v=e.content_filter_results)||void 0===v?void 0:v.hate)||void 0===f?void 0:f.filtered}:void 0,selfHarm:(null===(g=e.content_filter_results)||void 0===g?void 0:g.self_harm)?{severity:null===(y=null===(m=e.content_filter_results)||void 0===m?void 0:m.self_harm)||void 0===y?void 0:y.severity,filtered:null===(C=null===(S=e.content_filter_results)||void 0===S?void 0:S.self_harm)||void 0===C?void 0:C.filtered}:void 0}:void 0}})),choices:(null!==(i=e.body.choices)&&void 0!==i?i:[]).map((e=>{var t,i,n,r,o,s,a,c,l,u,p,d,h,v,f,g,m,y,S,C;return{text:e.text,index:e.index,contentFilterResults:e.content_filter_results?{sexual:(null===(t=e.content_filter_results)||void 0===t?void 0:t.sexual)?{severity:null===(n=null===(i=e.content_filter_results)||void 0===i?void 0:i.sexual)||void 0===n?void 0:n.severity,filtered:null===(o=null===(r=e.content_filter_results)||void 0===r?void 0:r.sexual)||void 0===o?void 0:o.filtered}:void 0,violence:(null===(s=e.content_filter_results)||void 0===s?void 0:s.violence)?{severity:null===(c=null===(a=e.content_filter_results)||void 0===a?void 0:a.violence)||void 0===c?void 0:c.severity,filtered:null===(u=null===(l=e.content_filter_results)||void 0===l?void 0:l.violence)||void 0===u?void 0:u.filtered}:void 0,hate:(null===(p=e.content_filter_results)||void 0===p?void 0:p.hate)?{severity:null===(h=null===(d=e.content_filter_results)||void 0===d?void 0:d.hate)||void 0===h?void 0:h.severity,filtered:null===(f=null===(v=e.content_filter_results)||void 0===v?void 0:v.hate)||void 0===f?void 0:f.filtered}:void 0,selfHarm:(null===(g=e.content_filter_results)||void 0===g?void 0:g.self_harm)?{severity:null===(y=null===(m=e.content_filter_results)||void 0===m?void 0:m.self_harm)||void 0===y?void 0:y.severity,filtered:null===(C=null===(S=e.content_filter_results)||void 0===S?void 0:S.self_harm)||void 0===C?void 0:C.filtered}:void 0}:void 0,logprobs:null===e.logprobs?null:{tokens:e.logprobs.tokens,tokenLogprobs:e.logprobs.token_logprobs,topLogprobs:e.logprobs.top_logprobs,textOffset:e.logprobs.text_offset},finishReason:e.finish_reason}})),usage:{completionTokens:e.body.usage.completion_tokens,promptTokens:e.body.usage.prompt_tokens,totalTokens:e.body.usage.total_tokens}}}(await ui(e,t,i,n))}function di(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return e.path("/deployments/{deploymentId}/extensions/chat/completions",i).post(Object.assign(Object.assign({},mt(n)),{body:{messages:yi(t),functions:null===n||void 0===n?void 0:n.functions,function_call:null===n||void 0===n?void 0:n.functionCall,max_tokens:null===n||void 0===n?void 0:n.maxTokens,temperature:null===n||void 0===n?void 0:n.temperature,top_p:null===n||void 0===n?void 0:n.topP,logit_bias:null===n||void 0===n?void 0:n.logitBias,user:null===n||void 0===n?void 0:n.user,n:null===n||void 0===n?void 0:n.n,stop:null===n||void 0===n?void 0:n.stop,presence_penalty:null===n||void 0===n?void 0:n.presencePenalty,frequency_penalty:null===n||void 0===n?void 0:n.frequencyPenalty,stream:null===n||void 0===n?void 0:n.stream,model:null===n||void 0===n?void 0:n.model,dataSources:null===n||void 0===n?void 0:n.dataSources}}))}async function hi(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};const n=await function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};return e.path("/images/generations:submit").post(Object.assign(Object.assign({},mt(i)),{body:{prompt:t,n:null===i||void 0===i?void 0:i.n,size:null===i||void 0===i?void 0:i.size,response_format:null===i||void 0===i?void 0:i.responseFormat,user:null===i||void 0===i?void 0:i.user}}))}(e,t,i);if(St(n)){const e=n.body;if(e.created&&e.data)return e;throw n.body.error}if("202"===n.status){const t=await Jt(e,n);return vi(await t.pollUntilDone())}return vi(n)}function vi(e){if(St(e)||!e.body.result)throw e.body.error;return function(e){let{created:t,data:i}=e;return"string"===typeof i[0].url?{created:new Date(t),data:i}:{created:new Date(t),data:i.map((e=>({base64Data:e.b64_json})))}}(e.body.result)}function fi(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};var r,o;return(null===(r=n.azureExtensionOptions)||void 0===r?void 0:r.extensions)?di(e,t,i,Object.assign(Object.assign({},n),{dataSources:null===(o=n.azureExtensionOptions)||void 0===o?void 0:o.extensions})):function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return e.path("/deployments/{deploymentId}/chat/completions",i).post(Object.assign(Object.assign({},mt(n)),{body:{messages:yi(t),functions:null===n||void 0===n?void 0:n.functions,function_call:null===n||void 0===n?void 0:n.functionCall,max_tokens:null===n||void 0===n?void 0:n.maxTokens,temperature:null===n||void 0===n?void 0:n.temperature,top_p:null===n||void 0===n?void 0:n.topP,logit_bias:null===n||void 0===n?void 0:n.logitBias,user:null===n||void 0===n?void 0:n.user,n:null===n||void 0===n?void 0:n.n,stop:null===n||void 0===n?void 0:n.stop,presence_penalty:null===n||void 0===n?void 0:n.presencePenalty,frequency_penalty:null===n||void 0===n?void 0:n.frequencyPenalty,stream:null===n||void 0===n?void 0:n.stream,model:null===n||void 0===n?void 0:n.model,dataSources:null===n||void 0===n?void 0:n.dataSources}}))}(e,t,i,n)}async function gi(e,t,i,r,o){const s=null!==o&&void 0!==o?o:"string"===typeof r?{}:null!==r&&void 0!==r?r:{},a="string"===typeof r?r:void 0,{temperature:c,prompt:l,model:u}=s,p=n(s,["temperature","prompt","model"]),{body:d,status:h}=await e.pathUnchecked("deployments/{deploymentId}/audio/translations",t).post(Object.assign(Object.assign({body:Object.assign(Object.assign(Object.assign(Object.assign({file:await ci(i)},a&&{response_format:a}),void 0!==c?{temperature:c}:{}),l&&{prompt:l}),u&&{model:u})},p),{contentType:"multipart/form-data"}));if("200"!==h)throw d.error;return"verbose_json"!==a?d:ri(d)}async function mi(e,t,i,r,o){const s=null!==o&&void 0!==o?o:"string"===typeof r?{}:null!==r&&void 0!==r?r:{},a="string"===typeof r?r:void 0,{temperature:c,language:l,prompt:u,model:p}=s,d=n(s,["temperature","language","prompt","model"]),{body:h,status:v}=await e.pathUnchecked("deployments/{deploymentId}/audio/transcriptions",t).post(Object.assign(Object.assign({body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({file:await ci(i)},a&&{response_format:a}),l&&{language:l}),void 0!==c?{temperature:c}:{}),u&&{prompt:u}),p&&{model:p})},d),{contentType:"multipart/form-data"}));if("200"!==v)throw h.error;return"verbose_json"!==a?h:ri(h)}function yi(e){return e.map((e=>{var t;return{role:e.role,content:null!==(t=e.content)&&void 0!==t?t:null,name:e.name,function_call:e.functionCall,context:e.context}}))}class Si{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r,o;let s,a,l;if(this._isAzure=!1,function(e){return c(e)||void 0!==e.key}(t))a=e,l=t,s=i,this._isAzure=!0;else{a="https://api.openai.com/v".concat(1),l=e;const{credentials:i}=t,o=n(t,["credentials"]);s=Object.assign({credentials:{apiKeyHeaderName:null!==(r=null===i||void 0===i?void 0:i.apiKeyHeaderName)&&void 0!==r?r:"Authorization",scopes:null===i||void 0===i?void 0:i.scopes}},o)}this._client=function(e,t){return gt(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(a,l,Object.assign(Object.assign({},s),this._isAzure?{}:{additionalPolicies:[...null!==(o=s.additionalPolicies)&&void 0!==o?o:[],{position:"perCall",policy:{name:"openAiEndpoint",sendRequest:(e,t)=>{const i=new URL(e.url),n=i.pathname.split("/");switch(n[n.length-1]){case"completions":"chat"===n[n.length-2]?i.pathname="".concat(n[1],"/chat/completions"):i.pathname="".concat(n[1],"/completions");break;case"embeddings":i.pathname="".concat(n[1],"/embeddings");break;case"generations:submit":i.pathname="".concat(n[1],"/images/generations");break;case"transcriptions":i.pathname="".concat(n[1],"/audio/transcriptions");break;case"translations":i.pathname="".concat(n[1],"/audio/translations")}return i.searchParams.delete("api-version"),e.url=i.toString(),t(e)}}}]})),this._client.pipeline.removePolicy({name:Se}),this._client.pipeline.addPolicy({name:"formDataWithFileUploadPolicy",async sendRequest(e,t){if(e.formData){const t=e.formData,i=new FormData;for(const e of Object.keys(t)){const n=t[e];if(Array.isArray(n))for(const t of n)i.append(e,t);else i.append(e,n)}e.body=i,e.formData=void 0;const n=e.headers.get("Content-Type");n&&-1!==n.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(i).toString():n&&-1!==n.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}})}getCompletions(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};return this.setModel(e,i),pi(this._client,t,e,i)}listCompletions(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setModel(e,i),function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return ai(ui(e,t,i,Object.assign(Object.assign({},n),{stream:!0})),$t)}(this._client,t,e,i)}getEmbeddings(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};return this.setModel(e,i),li(this._client,t,e,i)}getChatCompletions(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};return this.setModel(e,i),async function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};const r=await fi(e,t,i,n);if(St(r))throw r.body.error;return Yt(r.body)}(this._client,t,e,i)}listChatCompletions(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{requestOptions:{}};return this.setModel(e,i),function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{requestOptions:{}};return ai(fi(e,t,i,Object.assign(Object.assign({},n),{stream:!0})),Yt)}(this._client,t,e,i)}getImages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{requestOptions:{}};return hi(this._client,e,t)}async getAudioTranscription(e,t,i,n){const r=null!==n&&void 0!==n?n:"string"===typeof i?{}:null!==i&&void 0!==i?i:{},o="string"===typeof i?i:void 0;return this.setModel(e,r),void 0===o?mi(this._client,e,t,r):mi(this._client,e,t,o,r)}async getAudioTranslation(e,t,i,n){const r=null!==n&&void 0!==n?n:"string"===typeof i?{}:null!==i&&void 0!==i?i:{},o="string"===typeof i?i:void 0;return this.setModel(e,r),void 0===o?gi(this._client,e,t,r):gi(this._client,e,t,o,r)}setModel(e,t){this._isAzure||(t.model=e)}}class Ci{get key(){return this._key}constructor(e){if(!e)throw new Error("key must be a non-empty string");this._key=e}update(e){this._key=e}}const wi="4.2.9";var Ri={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},bi=e.createContext&&e.createContext(Ri),Pi=function(){return Pi=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Pi.apply(this,arguments)},Ii=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function Ei(t){return t&&t.map((function(t,i){return e.createElement(t.tag,Pi({key:i},t.attr),Ei(t.child))}))}function Ti(t){return function(i){return e.createElement(ki,Pi({attr:Pi({},t.attr)},i),Ei(t.child))}}function ki(t){var i=function(i){var n,r=t.attr,o=t.size,s=t.title,a=Ii(t,["attr","size","title"]),c=o||i.size||"1em";return i.className&&(n=i.className),t.className&&(n=(n?n+" ":"")+t.className),e.createElement("svg",Pi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,r,a,{className:n,style:Pi(Pi({color:t.color||i.color},i.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),s&&e.createElement("title",null,s),t.children)};return void 0!==bi?e.createElement(bi.Consumer,null,(function(e){return i(e)})):i(Ri)}function Ai(e){return Ti({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M8 5v14l11-7z"}}]})(e)}function Oi(e){return Ti({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}}]})(e)}function xi(e){return Ti({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 13H5v-2h14v2z"}}]})(e)}function Di(e){return Ti({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M9 16h2V8H9v8zm3-14C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm1-4h2V8h-2v8z"}}]})(e)}function zi(e){return Ti({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}}]})(e)}var Ni=i(184);const _i=function(){const[t,n]=(0,e.useState)(""),[r,o]=(0,e.useState)(null),[s,a]=(0,e.useState)([{role:"system",content:"You are a helpful assistant. You get prompts which get generated by speech input through a microphone."}]),[c,l]=(0,e.useState)(!1);async function u(e){const t=new Si("https://ba-accessible-gpt.openai.azure.com/",new Ci("c0e8d1c95a55474495f27c9ab0a35694")),i=(await t.getChatCompletions("gpt35",e)).choices[0].message.content;return console.log("This is the response!"),console.log(i),o(i),i}const[p,d]=(0,e.useState)(!1),h=(0,e.useRef)(new Audio),[v,f]=(0,e.useState)(!1),[g,m]=(0,e.useState)(!1),y=e.useRef(null),S=i(602),C=S.SpeechConfig.fromSubscription("e42991f6a18840af955012c5924708b2","switzerlandnorth"),w=new S.SpeakerAudioDestination,R=S.AudioConfig.fromSpeakerOutput(w);let b=new S.SpeechSynthesizer(C,R);function P(){y.current.pause(),f(!1),m(!0)}function I(){y.current.resume(),f(!0),m(!1)}function E(e){w.onAudioStart=()=>{m(!1),f(!0),console.log("Set started playing right now!")},w.onAudioEnd=()=>{f(!1),console.log("Set stopped playing right now!")},y.current=w,console.log("speaking text: ".concat(e,"...")),b.speakTextAsync(e,(t=>{let i;t.reason===S.ResultReason.SynthesizingAudioCompleted?i='synthesis finished for "'.concat(e,'".\n'):t.reason===S.ResultReason.Canceled&&(i="synthesis failed. Error detail: ".concat(t.errorDetails,".\n")),b.close(),b=void 0,console.log(i)}),(function(e){console.log("Error: ".concat(e,".\n")),b.close(),b=void 0}))}const T=(0,e.useRef)(null);function k(e){return new Promise((t=>{a((i=>{const n=[...i,e];return t(n),n}))}))}function A(e){let{role:t,content:i,index:n}=e;const r=Math.ceil(n/2);return"user"===t?(0,Ni.jsxs)("div",{className:"chat-user",children:[(0,Ni.jsxs)("h4",{children:["Prompt ",r]}),(0,Ni.jsx)("p",{children:i}),(0,Ni.jsxs)("div",{className:"audio-controls",children:[!v&&(0,Ni.jsx)(Oi,{style:{marginTop:"10px",fontSize:"40px"},onClick:()=>E(i)}),v&&(0,Ni.jsx)(Di,{style:{marginTop:"10px",fontSize:"40px"},onClick:()=>P()}),v||g&&(0,Ni.jsxs)("div",{role:"button",className:"resume-button",onClick:()=>I(),children:[(0,Ni.jsx)(zi,{className:"circle-icon"}),(0,Ni.jsx)(Ai,{className:"play-icon"}),(0,Ni.jsx)(xi,{className:"bar-icon"})]})]})]}):"assistant"===t?(0,Ni.jsxs)("div",{className:"chat-ai",children:[(0,Ni.jsxs)("h4",{children:["Answer ",r]}),(0,Ni.jsx)("p",{children:i}),(0,Ni.jsxs)("div",{className:"audio-controls",children:[!v&&(0,Ni.jsx)(Oi,{role:"button",style:{marginTop:"10px",fontSize:"40px"},onClick:()=>E(i)}),v&&(0,Ni.jsx)(Di,{role:"button",style:{marginTop:"10px",fontSize:"40px"},onClick:()=>P()}),v||g&&(0,Ni.jsxs)("div",{role:"button",className:"resume-button",onClick:()=>I(),children:[(0,Ni.jsx)(zi,{className:"circle-icon"}),(0,Ni.jsx)(Ai,{className:"play-icon"}),(0,Ni.jsx)(xi,{className:"bar-icon"})]})]})]}):void 0}(0,e.useEffect)((()=>{!v&&p&&T.current.focus()}),[v]);const O=e.useRef(new Audio("/ChatGPT-voice-assistant/Recording_Sound_Start.m4a")),x=e.useRef(new Audio("/ChatGPT-voice-assistant/Recording_Sound_End.m4a"));return(0,Ni.jsxs)("div",{className:"App",children:[(0,Ni.jsxs)("header",{className:"App-header",children:[(0,Ni.jsx)("h1",{children:"Welcome to the ChatGPT Voice Assistant"}),!p&&(0,Ni.jsx)("h2",{children:"Please press the button below and allow microphone access when prompted."}),p&&(0,Ni.jsx)("h2",{className:"instruction-header",children:"To create a prompt, press the first button below and start speaking. To hear the response, press the second button."}),!p&&(0,Ni.jsx)("button",{onClick:function(){p||(h.current.src="/ChatGPT-voice-assistant/one_minute_of_silence.mp3",h.current.play()),d(!p),async function(){try{await navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){}}()},children:p?"Disable Audio":"Enable Audio"})]}),p&&(0,Ni.jsxs)("div",{className:"App-body",children:[(0,Ni.jsx)("button",{style:{width:"20rem",height:"10rem",backgroundColor:"red"},onClick:async function(){let e=await k({role:"user",content:"This is a sample input, reply with a story. Use about one short sentence."});console.log("This is the updated chat after the prompt of the user:",e);const t=await u(e);let i=await k({role:"assistant",content:t});console.log("This is the updated chat after the reply of chatGPT:",i),E(t)}}),(0,Ni.jsx)("button",{style:{color:"white",width:"100%",maxWidth:"20rem",height:"5vh",backgroundColor:"#F05039",border:"2px solid white",boxShadow:"none",margin:"20px"},onClick:async function(){O.current.play(),l(!0);const e=await async function(){return new Promise(((e,t)=>{const r=i(602),s=r.SpeechConfig.fromSubscription("e42991f6a18840af955012c5924708b2","switzerlandnorth");s.speechRecognitionLanguage="en-US";const a=r.AudioConfig.fromDefaultMicrophoneInput(),c=new r.SpeechRecognizer(s,a);o("speak into your microphone..."),c.recognizeOnceAsync((t=>{if(t.reason===r.ResultReason.RecognizedSpeech)console.log("RECOGNIZED PROMPT: Text=".concat(t.text)),n(t.text),e(t.text);else{const t="ERROR: Speech was cancelled or could not be recognized. Ensure your microphone is working properly.";o(t),n(t),E(t),e(null)}}))}))}();if(l(!1),x.current.play(),e){let t=await k({role:"user",content:e});console.log("This is the updated chat after the prompt of the user:",t);const i=await u(t);let n=await k({role:"assistant",content:i});console.log("This is the updated chat after the reply of chatGPT:",n),E(i)}else console.log("No request got sent to ChatGPT")},disabled:v||c,ref:T,children:"Speak in your prompt"}),(0,Ni.jsx)("button",{style:{color:"white",width:"100%",maxWidth:"20rem",height:"5vh",backgroundColor:"#1F449C",border:"2px solid white",boxShadow:"none"},onClick:()=>E(r),disabled:v,children:"Play last ChatGPT response"}),(0,Ni.jsxs)("div",{className:"chat",children:[(0,Ni.jsxs)("div",{className:"header-chat",children:[(0,Ni.jsx)("h3",{children:"Prompt:"}),(0,Ni.jsx)("h3",{children:"Answer from ChatGPT:"})]}),(0,Ni.jsx)("div",{className:"content-chat",children:s.map(((e,t)=>(0,Ni.jsx)(A,{index:t,role:e.role,content:e.content},t)))})]})]}),(0,Ni.jsx)("footer",{className:"App-footer",children:(0,Ni.jsxs)("p",{children:["Current Version: ",wi]})})]})},Mi=e=>{e&&e instanceof Function&&i.e(787).then(i.bind(i,787)).then((t=>{let{getCLS:i,getFID:n,getFCP:r,getLCP:o,getTTFB:s}=t;i(e),n(e),r(e),o(e),s(e)}))};t.createRoot(document.getElementById("root")).render((0,Ni.jsx)(e.StrictMode,{children:(0,Ni.jsx)(_i,{})})),Mi()})()})();
//# sourceMappingURL=main.a4de9250.js.map